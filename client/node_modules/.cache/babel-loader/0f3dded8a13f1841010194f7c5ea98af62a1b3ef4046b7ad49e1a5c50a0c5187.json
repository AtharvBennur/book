{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dell\\\\Desktop\\\\pro\\\\book-exchange-app\\\\client\\\\src\\\\pages\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { io as ioClient } from 'socket.io-client';\nimport { Send, MessageSquare } from 'lucide-react';\nimport SectionHeading from '../components/common/SectionHeading';\nimport LoadingScreen from '../components/common/LoadingScreen';\nimport { useAuth } from '../context/AuthContext';\nimport { useAppData } from '../context/AppDataContext';\nimport { conversationsApi } from '../services/api';\nimport { useNotification } from '../context/NotificationContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = () => {\n  _s();\n  var _selectedConversation;\n  const {\n    token\n  } = useAuth();\n  const {\n    conversations,\n    refreshConversations,\n    activeConversationId,\n    setActiveConversationId\n  } = useAppData();\n  const {\n    state\n  } = useLocation();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [isSending, setIsSending] = useState(false);\n  const [loadingMessages, setLoadingMessages] = useState(false);\n  const socketRef = useRef(null);\n  const {\n    notify\n  } = useNotification();\n  useEffect(() => {\n    refreshConversations();\n  }, [refreshConversations]);\n\n  // auto-open conversation from navigation state\n  useEffect(() => {\n    if (state !== null && state !== void 0 && state.conversationId) {\n      setActiveConversationId(state.conversationId);\n    }\n  }, [state, setActiveConversationId]);\n  const loadMessages = useCallback(async conversationId => {\n    if (!conversationId || !token) return;\n    setLoadingMessages(true);\n    try {\n      const data = await conversationsApi.messages(conversationId, token);\n      setMessages(data);\n      await conversationsApi.markRead(conversationId, token);\n    } catch (err) {\n      notify(err.message || 'Unable to load messages', 'error');\n    } finally {\n      setLoadingMessages(false);\n    }\n  }, [token, notify]);\n  useEffect(() => {\n    loadMessages(activeConversationId);\n  }, [activeConversationId, loadMessages]);\n  useEffect(() => {\n    if (!token) return undefined;\n    const socket = ioClient(window.location.origin.replace(/:\\d+$/, '') + ':5000');\n    socketRef.current = socket;\n    socket.emit('identify', token);\n    socket.on('conversationMessage', message => {\n      if (message.conversationId === activeConversationId) {\n        setMessages(prev => [...prev, message]);\n      } else {\n        refreshConversations();\n      }\n    });\n    return () => {\n      socket.disconnect();\n    };\n  }, [token, activeConversationId, refreshConversations]);\n  useEffect(() => {\n    if (!socketRef.current) return undefined;\n    if (activeConversationId) {\n      socketRef.current.emit('joinConversation', activeConversationId);\n      return () => {\n        var _socketRef$current;\n        (_socketRef$current = socketRef.current) === null || _socketRef$current === void 0 ? void 0 : _socketRef$current.emit('leaveConversation', activeConversationId);\n      };\n    }\n    return undefined;\n  }, [activeConversationId]);\n  const sendMessage = async () => {\n    if (!input.trim() || !activeConversationId) return;\n    setIsSending(true);\n    try {\n      var _socketRef$current2;\n      if ((_socketRef$current2 = socketRef.current) !== null && _socketRef$current2 !== void 0 && _socketRef$current2.connected) {\n        socketRef.current.emit('sendConversationMessage', {\n          token,\n          text: input,\n          conversationId: activeConversationId\n        });\n      } else {\n        await conversationsApi.sendMessage(activeConversationId, {\n          text: input\n        }, token);\n      }\n      setInput('');\n    } catch (err) {\n      notify(err.message || 'Unable to send message', 'error');\n    } finally {\n      setIsSending(false);\n    }\n  };\n  const selectedConversation = useMemo(() => conversations.find(conversation => conversation.id === activeConversationId), [conversations, activeConversationId]);\n  if (!conversations.length) {\n    return /*#__PURE__*/_jsxDEV(LoadingScreen, {\n      label: \"Start an exchange to unlock chat.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"grid gap-6 lg:grid-cols-[0.9fr_1.1fr]\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"rounded-3xl border border-slate-200 bg-white p-4 shadow\",\n      children: [/*#__PURE__*/_jsxDEV(SectionHeading, {\n        eyebrow: \"Inbox\",\n        title: \"Conversations\",\n        description: \"Every exchange has its own secure thread.\",\n        align: \"left\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 space-y-3\",\n        children: conversations.map(conversation => {\n          var _conversation$bookId, _conversation$partici, _conversation$lastMes;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveConversationId(conversation.id),\n            className: `w-full rounded-2xl border px-4 py-3 text-left text-sm transition ${conversation.id === activeConversationId ? 'border-emerald-300 bg-emerald-50 text-emerald-900' : 'border-slate-200 bg-slate-50 text-slate-600 hover:border-slate-300'}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between text-xs uppercase tracking-[0.3em] text-slate-400\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"Book #\", (_conversation$bookId = conversation.bookId) !== null && _conversation$bookId !== void 0 ? _conversation$bookId : 'general']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 17\n              }, this), conversation.unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"rounded-full bg-emerald-500/90 px-2 py-0.5 text-[10px] font-bold text-white\",\n                children: conversation.unreadCount\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mt-2 text-base font-semibold text-slate-900\",\n              children: (_conversation$partici = conversation.participantsInfo) === null || _conversation$partici === void 0 ? void 0 : _conversation$partici.map(participant => participant.name || participant.id).join(', ')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mt-1 text-xs text-slate-500\",\n              children: ((_conversation$lastMes = conversation.lastMessage) === null || _conversation$lastMes === void 0 ? void 0 : _conversation$lastMes.text) || 'No messages yet'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this)]\n          }, conversation.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"flex flex-col rounded-3xl border border-slate-200 bg-white shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border-b border-slate-100 p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-slate-900\",\n          children: selectedConversation ? `Chat about ${(_selectedConversation = selectedConversation.bookId) !== null && _selectedConversation !== void 0 ? _selectedConversation : 'exchange'}` : 'Select a conversation'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-1 flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 space-y-3 overflow-y-auto px-4 py-4\",\n          children: loadingMessages ? /*#__PURE__*/_jsxDEV(LoadingScreen, {\n            label: \"Loading messages\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 15\n          }, this) : messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col gap-1 text-sm text-slate-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs uppercase tracking-[0.3em] text-slate-400\",\n              children: [message.fromName, \" \\u2014 \", new Date(message.createdAt).toLocaleTimeString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rounded-2xl bg-slate-50 px-4 py-2 shadow-sm\",\n              children: message.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 19\n            }, this)]\n          }, message.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border-t border-slate-100 p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-1 items-center gap-3 rounded-full border border-slate-200 bg-slate-50 px-4\",\n              children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n                className: \"h-4 w-4 text-slate-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: input,\n                onChange: event => setInput(event.target.value),\n                placeholder: \"Type a message\\u2026\",\n                className: \"flex-1 bg-transparent py-3 text-sm text-slate-700 outline-none\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: sendMessage,\n              disabled: !activeConversationId || isSending,\n              className: \"rounded-full bg-gradient-to-r from-emerald-500 to-teal-400 p-3 text-white disabled:cursor-not-allowed disabled:opacity-50\",\n              children: /*#__PURE__*/_jsxDEV(Send, {\n                className: \"h-4 w-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this);\n};\n_s(Chat, \"6pv5mUK2RddGxj+IVbfAgP94B5U=\", false, function () {\n  return [useAuth, useAppData, useLocation, useNotification];\n});\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","useLocation","io","ioClient","Send","MessageSquare","SectionHeading","LoadingScreen","useAuth","useAppData","conversationsApi","useNotification","jsxDEV","_jsxDEV","Chat","_s","_selectedConversation","token","conversations","refreshConversations","activeConversationId","setActiveConversationId","state","messages","setMessages","input","setInput","isSending","setIsSending","loadingMessages","setLoadingMessages","socketRef","notify","conversationId","loadMessages","data","markRead","err","message","undefined","socket","window","location","origin","replace","current","emit","on","prev","disconnect","_socketRef$current","sendMessage","trim","_socketRef$current2","connected","text","selectedConversation","find","conversation","id","length","label","fileName","_jsxFileName","lineNumber","columnNumber","className","children","eyebrow","title","description","align","map","_conversation$bookId","_conversation$partici","_conversation$lastMes","onClick","bookId","unreadCount","participantsInfo","participant","name","join","lastMessage","fromName","Date","createdAt","toLocaleTimeString","value","onChange","event","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["C:/Users/dell/Desktop/pro/book-exchange-app/client/src/pages/Chat.jsx"],"sourcesContent":["import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { io as ioClient } from 'socket.io-client';\r\nimport { Send, MessageSquare } from 'lucide-react';\r\nimport SectionHeading from '../components/common/SectionHeading';\r\nimport LoadingScreen from '../components/common/LoadingScreen';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useAppData } from '../context/AppDataContext';\r\nimport { conversationsApi } from '../services/api';\r\nimport { useNotification } from '../context/NotificationContext';\r\n\r\nconst Chat = () => {\r\n  const { token } = useAuth();\r\n  const {\r\n    conversations,\r\n    refreshConversations,\r\n    activeConversationId,\r\n    setActiveConversationId,\r\n  } = useAppData();\r\n  const { state } = useLocation();\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const [isSending, setIsSending] = useState(false);\r\n  const [loadingMessages, setLoadingMessages] = useState(false);\r\n  const socketRef = useRef(null);\r\n  const { notify } = useNotification();\r\n\r\n  useEffect(() => {\r\n    refreshConversations();\r\n  }, [refreshConversations]);\r\n\r\n  // auto-open conversation from navigation state\r\n  useEffect(() => {\r\n    if (state?.conversationId) {\r\n      setActiveConversationId(state.conversationId);\r\n    }\r\n  }, [state, setActiveConversationId]);\r\n\r\n  const loadMessages = useCallback(\r\n    async (conversationId) => {\r\n      if (!conversationId || !token) return;\r\n      setLoadingMessages(true);\r\n      try {\r\n        const data = await conversationsApi.messages(conversationId, token);\r\n        setMessages(data);\r\n        await conversationsApi.markRead(conversationId, token);\r\n      } catch (err) {\r\n        notify(err.message || 'Unable to load messages', 'error');\r\n      } finally {\r\n        setLoadingMessages(false);\r\n      }\r\n    },\r\n    [token, notify]\r\n  );\r\n\r\n  useEffect(() => {\r\n    loadMessages(activeConversationId);\r\n  }, [activeConversationId, loadMessages]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return undefined;\r\n    const socket = ioClient(window.location.origin.replace(/:\\d+$/, '') + ':5000');\r\n    socketRef.current = socket;\r\n    socket.emit('identify', token);\r\n    socket.on('conversationMessage', (message) => {\r\n      if (message.conversationId === activeConversationId) {\r\n        setMessages((prev) => [...prev, message]);\r\n      } else {\r\n        refreshConversations();\r\n      }\r\n    });\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [token, activeConversationId, refreshConversations]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return undefined;\r\n    if (activeConversationId) {\r\n      socketRef.current.emit('joinConversation', activeConversationId);\r\n      return () => {\r\n        socketRef.current?.emit('leaveConversation', activeConversationId);\r\n      };\r\n    }\r\n    return undefined;\r\n  }, [activeConversationId]);\r\n\r\n  const sendMessage = async () => {\r\n    if (!input.trim() || !activeConversationId) return;\r\n    setIsSending(true);\r\n    try {\r\n      if (socketRef.current?.connected) {\r\n        socketRef.current.emit('sendConversationMessage', {\r\n          token,\r\n          text: input,\r\n          conversationId: activeConversationId,\r\n        });\r\n      } else {\r\n        await conversationsApi.sendMessage(activeConversationId, { text: input }, token);\r\n      }\r\n      setInput('');\r\n    } catch (err) {\r\n      notify(err.message || 'Unable to send message', 'error');\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  const selectedConversation = useMemo(\r\n    () => conversations.find((conversation) => conversation.id === activeConversationId),\r\n    [conversations, activeConversationId]\r\n  );\r\n\r\n  if (!conversations.length) {\r\n    return <LoadingScreen label=\"Start an exchange to unlock chat.\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid gap-6 lg:grid-cols-[0.9fr_1.1fr]\">\r\n      <aside className=\"rounded-3xl border border-slate-200 bg-white p-4 shadow\">\r\n        <SectionHeading\r\n          eyebrow=\"Inbox\"\r\n          title=\"Conversations\"\r\n          description=\"Every exchange has its own secure thread.\"\r\n          align=\"left\"\r\n        />\r\n        <div className=\"mt-4 space-y-3\">\r\n          {conversations.map((conversation) => (\r\n            <button\r\n              key={conversation.id}\r\n              onClick={() => setActiveConversationId(conversation.id)}\r\n              className={`w-full rounded-2xl border px-4 py-3 text-left text-sm transition ${\r\n                conversation.id === activeConversationId\r\n                  ? 'border-emerald-300 bg-emerald-50 text-emerald-900'\r\n                  : 'border-slate-200 bg-slate-50 text-slate-600 hover:border-slate-300'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center justify-between text-xs uppercase tracking-[0.3em] text-slate-400\">\r\n                <span>Book #{conversation.bookId ?? 'general'}</span>\r\n                {conversation.unreadCount > 0 && (\r\n                  <span className=\"rounded-full bg-emerald-500/90 px-2 py-0.5 text-[10px] font-bold text-white\">\r\n                    {conversation.unreadCount}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <p className=\"mt-2 text-base font-semibold text-slate-900\">\r\n                {conversation.participantsInfo\r\n                  ?.map((participant) => participant.name || participant.id)\r\n                  .join(', ')}\r\n              </p>\r\n              <p className=\"mt-1 text-xs text-slate-500\">\r\n                {conversation.lastMessage?.text || 'No messages yet'}\r\n              </p>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </aside>\r\n      <section className=\"flex flex-col rounded-3xl border border-slate-200 bg-white shadow\">\r\n        <div className=\"border-b border-slate-100 p-4\">\r\n          <h3 className=\"text-lg font-semibold text-slate-900\">\r\n            {selectedConversation\r\n              ? `Chat about ${selectedConversation.bookId ?? 'exchange'}`\r\n              : 'Select a conversation'}\r\n          </h3>\r\n        </div>\r\n        <div className=\"flex flex-1 flex-col\">\r\n          <div className=\"flex-1 space-y-3 overflow-y-auto px-4 py-4\">\r\n            {loadingMessages ? (\r\n              <LoadingScreen label=\"Loading messages…\" />\r\n            ) : (\r\n              messages.map((message) => (\r\n                <div key={message.id} className=\"flex flex-col gap-1 text-sm text-slate-600\">\r\n                  <div className=\"text-xs uppercase tracking-[0.3em] text-slate-400\">\r\n                    {message.fromName} — {new Date(message.createdAt).toLocaleTimeString()}\r\n                  </div>\r\n                  <div className=\"rounded-2xl bg-slate-50 px-4 py-2 shadow-sm\">{message.text}</div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n          <div className=\"border-t border-slate-100 p-4\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"flex flex-1 items-center gap-3 rounded-full border border-slate-200 bg-slate-50 px-4\">\r\n                <MessageSquare className=\"h-4 w-4 text-slate-400\" />\r\n                <input\r\n                  value={input}\r\n                  onChange={(event) => setInput(event.target.value)}\r\n                  placeholder=\"Type a message…\"\r\n                  className=\"flex-1 bg-transparent py-3 text-sm text-slate-700 outline-none\"\r\n                />\r\n              </div>\r\n              <button\r\n                onClick={sendMessage}\r\n                disabled={!activeConversationId || isSending}\r\n                className=\"rounded-full bg-gradient-to-r from-emerald-500 to-teal-400 p-3 text-white disabled:cursor-not-allowed disabled:opacity-50\"\r\n              >\r\n                <Send className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}