{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dell\\\\Desktop\\\\pro\\\\book-exchange-app\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$(),\n  _s5 = $RefreshSig$(),\n  _s6 = $RefreshSig$(),\n  _s7 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Book, Search, PlusCircle, Library, User, LogOut, RefreshCw, MapPin, Heart, MessageSquare, ArrowRight } from 'lucide-react';\n\n// Use the server API (file-based) instead of Firebase.\nconst API_BASE = '';\nconst BOOKS_API = `${API_BASE}/api/books`;\n\n// --- Components ---\n\nconst Navbar = ({\n  user,\n  setView,\n  currentView,\n  handleLogin,\n  handleLogout\n}) => /*#__PURE__*/_jsxDEV(\"nav\", {\n  className: \"site-header sticky top-0 z-50 px-4 py-3\",\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-6xl mx-auto flex justify-between items-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2 cursor-pointer site-logo\",\n      onClick: () => setView('home'),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"logo-badge\",\n        children: /*#__PURE__*/_jsxDEV(Book, {\n          className: \"w-6 h-6 text-white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"logo-text\",\n        children: \"BookLoop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setView('browse'),\n        className: `text-sm font-medium transition ${currentView === 'browse' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`,\n        children: \"Browse Books\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setView('chat'),\n        className: `text-sm font-medium transition ${currentView === 'chat' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`,\n        children: \"Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setView('exchanges'),\n        className: `text-sm font-medium transition ${currentView === 'exchanges' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`,\n        children: \"Requests\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), user ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setView('favorites'),\n          className: `text-sm font-medium transition flex items-center gap-1 ${currentView === 'favorites' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`,\n          children: [/*#__PURE__*/_jsxDEV(Heart, {\n            className: \"w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 15\n          }, this), \"Favorites\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setView('add'),\n          className: `text-sm font-medium transition flex items-center gap-1 ${currentView === 'add' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`,\n          children: [/*#__PURE__*/_jsxDEV(PlusCircle, {\n            className: \"w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 15\n          }, this), \"Add Book\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3 pl-4 border-l\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setView('profile'),\n            className: `text-sm font-medium transition flex items-center justify-center ${currentView === 'profile' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`,\n            title: \"Profile\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-700 font-bold text-xs\",\n              children: ((user === null || user === void 0 ? void 0 : user.id) || '').slice(0, 2).toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"nav-unread-badge\",\n            className: \"absolute -top-2 -right-2 bg-rose-500 text-white text-[10px] px-1 rounded-full hidden\",\n            children: \"0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleLogout,\n            className: \"text-gray-400 hover:text-red-500 transition\",\n            title: \"Logout\",\n            children: /*#__PURE__*/_jsxDEV(LogOut, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setView('signin'),\n          className: \"text-sm text-gray-700 hover:text-gray-900\",\n          children: \"Sign In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setView('signup'),\n          className: \"bg-emerald-600 text-white px-3 py-1 rounded-md text-sm\",\n          children: \"Sign Up\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 23,\n  columnNumber: 3\n}, this);\n_c = Navbar;\nconst Hero = ({\n  setView,\n  handleLogin,\n  user\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"bg-gradient-to-b from-emerald-50 to-white pt-20 pb-24 px-4\",\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-4xl mx-auto text-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inline-flex items-center gap-2 bg-white/6 text-emerald-300 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider mb-6 backdrop-blur\",\n      children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n        className: \"w-3 h-3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), \"The #1 Book Exchange Platform\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-5xl md:text-6xl font-extrabold text-gray-900 mb-6 leading-tight\",\n      children: [\"Give a Book. \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 22\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-teal-500\",\n        children: \"Get a Book.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-xl text-gray-600 mb-10 max-w-2xl mx-auto leading-relaxed\",\n      children: \"Join a community of readers. Upload the books gathering dust on your shelf and swap them for your next great adventure.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col sm:flex-row items-center justify-center gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setView('browse'),\n        className: \"neon-btn w-full sm:w-auto\",\n        children: \"Start Browsing\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this), !user && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLogin,\n        className: \"outline-btn w-full sm:w-auto px-8 py-4 font-bold text-lg transition\",\n        children: \"Join Now\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-16 grid grid-cols-3 gap-8 max-w-2xl mx-auto border-t pt-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-3xl font-bold text-gray-900\",\n          children: \"2k+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 mt-1\",\n          children: \"Active Readers\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-3xl font-bold text-gray-900\",\n          children: \"5k+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 mt-1\",\n          children: \"Books Swapped\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-3xl font-bold text-gray-900\",\n          children: \"100%\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 mt-1\",\n          children: \"Free to Join\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 99,\n  columnNumber: 3\n}, this);\n_c2 = Hero;\nconst BookCard = ({\n  book,\n  user,\n  handleExchange,\n  handleChat,\n  isFavorited,\n  onToggleFavorite\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"group fancy-card animate-tilt flex flex-col overflow-hidden h-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"h-48 overflow-hidden relative bg-gray-100\",\n      children: [book.imageUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n        src: book.imageUrl,\n        alt: book.title,\n        className: \"w-full h-full object-cover transition duration-500 group-hover:scale-105\",\n        onError: e => {\n          e.target.src = 'https://images.unsplash.com/photo-1543002588-bfa74002ed7e?auto=format&fit=crop&q=80&w=2730';\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full h-full flex items-center justify-center text-gray-300 bg-slate-50\",\n        children: /*#__PURE__*/_jsxDEV(Book, {\n          className: \"w-16 h-16\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-3 right-3 bg-white/90 backdrop-blur-sm px-2 py-1 rounded-md text-xs font-bold text-gray-700 shadow-sm\",\n        children: book.condition\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), user && onToggleFavorite && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => onToggleFavorite(book.id),\n        className: \"absolute top-3 left-3 bg-white/90 backdrop-blur-sm p-2 rounded-md hover:bg-white transition shadow-sm\",\n        title: isFavorited ? 'Remove from favorites' : 'Add to favorites',\n        children: /*#__PURE__*/_jsxDEV(Heart, {\n          className: `w-5 h-5 ${isFavorited ? 'fill-red-500 text-red-500' : 'text-gray-400'}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-5 flex flex-col flex-grow\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs font-semibold text-emerald-600 mb-2 uppercase tracking-wider\",\n        children: book.genre || 'General'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-bold text-gray-900 mb-1 leading-tight\",\n        children: book.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-500 mb-4\",\n        children: [\"by \", book.author]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 text-xs text-gray-400 mb-6 mt-auto\",\n        children: [/*#__PURE__*/_jsxDEV(MapPin, {\n          className: \"w-3 h-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: book.location || 'Remote'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between pt-4 border-t border-gray-50 mt-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-6 h-6 rounded-full bg-gradient-to-br from-purple-400 to-indigo-500 text-[10px] text-white flex items-center justify-center\",\n            children: book.ownerId ? book.ownerId.slice(0, 2).toUpperCase() : '??'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-500\",\n            children: \"Owner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 12\n        }, this), user && user.id === book.ownerId ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs font-medium text-gray-400 bg-gray-100 px-3 py-1 rounded-full\",\n          children: \"Your Book\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 14\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-actions\",\n          children: [book.status && book.status !== 'available' ? /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"glow-badge\",\n            children: book.status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 20\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleExchange(book),\n            disabled: book.status === 'exchanged',\n            className: `neon-btn ${book.status === 'exchanged' ? 'opacity-60 cursor-not-allowed' : ''}`,\n            children: book.status === 'exchanged' ? 'Taken' : 'Request'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 20\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleChat && handleChat(book),\n            className: \"text-sm px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 18\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 18\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 16\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 14\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 5\n  }, this);\n};\n_c3 = BookCard;\nconst Browse = ({\n  books,\n  loading,\n  user,\n  handleExchange,\n  handleChat,\n  favorites,\n  onToggleFavorite\n}) => {\n  _s();\n  const [searchTerm, setSearchTerm] = useState('');\n  const filteredBooks = books.filter(book => book.title.toLowerCase().includes(searchTerm.toLowerCase()) || book.author.toLowerCase().includes(searchTerm.toLowerCase()));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-6xl mx-auto px-4 py-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-900\",\n          children: \"Explore Collection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: \"Find your next favorite read.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative w-full md:w-96\",\n        children: [/*#__PURE__*/_jsxDEV(Search, {\n          className: \"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Search by title or author...\",\n          className: \"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition\",\n          value: searchTerm,\n          onChange: e => setSearchTerm(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }, this) : filteredBooks.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-20 bg-gray-50 rounded-2xl border border-dashed border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(Book, {\n        className: \"w-12 h-12 text-gray-300 mx-auto mb-3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-900\",\n        children: \"No books found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"Try adjusting your search terms.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",\n      children: filteredBooks.map(book => /*#__PURE__*/_jsxDEV(BookCard, {\n        book: book,\n        user: user,\n        handleExchange: handleExchange,\n        handleChat: handleChat,\n        isFavorited: favorites.includes(book.id),\n        onToggleFavorite: onToggleFavorite\n      }, book.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 236,\n    columnNumber: 5\n  }, this);\n};\n_s(Browse, \"a1cMJ8t0eYFnsCEdGcHtaGJdbCM=\");\n_c4 = Browse;\nconst Favorites = ({\n  books,\n  loading,\n  user,\n  handleExchange,\n  handleChat,\n  favorites,\n  onToggleFavorite\n}) => {\n  const favoriteBooks = books.filter(b => favorites.includes(b.id));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-6xl mx-auto px-4 py-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-3 mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(Heart, {\n        className: \"w-8 h-8 text-red-500 fill-red-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-gray-900\",\n        children: \"My Favorites\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 9\n    }, this) : favoriteBooks.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-20 bg-gray-50 rounded-2xl border border-dashed border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(Heart, {\n        className: \"w-12 h-12 text-gray-300 mx-auto mb-3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-900\",\n        children: \"No favorites yet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"Click the heart icon on books you love.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",\n      children: favoriteBooks.map(book => /*#__PURE__*/_jsxDEV(BookCard, {\n        book: book,\n        user: user,\n        handleExchange: handleExchange,\n        handleChat: handleChat,\n        isFavorited: true,\n        onToggleFavorite: onToggleFavorite\n      }, book.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 280,\n    columnNumber: 5\n  }, this);\n};\n_c5 = Favorites;\nconst AddBook = ({\n  setView,\n  user,\n  token\n}) => {\n  _s2();\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    title: '',\n    author: '',\n    genre: 'Fiction',\n    condition: 'Good',\n    location: '',\n    imageUrl: ''\n  });\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!user) return;\n    setLoading(true);\n    try {\n      // Post to server\n      await fetch(BOOKS_API, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: token ? `Bearer ${token}` : ''\n        },\n        body: JSON.stringify({\n          ...formData,\n          ownerId: user.id\n        })\n      });\n      setView('browse');\n    } catch (error) {\n      console.error(\"Error adding book:\", error);\n      alert(\"Failed to add book. Try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto px-4 py-12\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-8 rounded-2xl shadow-lg border border-gray-100\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3 mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-emerald-100 p-3 rounded-full\",\n          children: /*#__PURE__*/_jsxDEV(PlusCircle, {\n            className: \"w-6 h-6 text-emerald-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-2xl font-bold text-gray-900\",\n            children: \"List a Book\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-500 text-sm\",\n            children: \"Share a book with the community\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-semibold text-gray-700\",\n              children: \"Book Title\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              required: true,\n              className: \"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\",\n              placeholder: \"e.g. The Great Gatsby\",\n              value: formData.title,\n              onChange: e => setFormData({\n                ...formData,\n                title: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-semibold text-gray-700\",\n              children: \"Author\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              required: true,\n              className: \"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\",\n              placeholder: \"e.g. F. Scott Fitzgerald\",\n              value: formData.author,\n              onChange: e => setFormData({\n                ...formData,\n                author: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-semibold text-gray-700\",\n              children: \"Genre\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition bg-white\",\n              value: formData.genre,\n              onChange: e => setFormData({\n                ...formData,\n                genre: e.target.value\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Fiction\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 380,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Non-Fiction\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 381,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Sci-Fi\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Mystery\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Biography\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Textbook\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"text-sm font-semibold text-gray-700\",\n              children: \"Condition\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition bg-white\",\n              value: formData.condition,\n              onChange: e => setFormData({\n                ...formData,\n                condition: e.target.value\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"New\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 395,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Like New\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Good\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Fair\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Poor\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm font-semibold text-gray-700\",\n            children: \"Cover Image URL\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"url\",\n            className: \"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\",\n            placeholder: \"https://example.com/image.jpg\",\n            value: formData.imageUrl,\n            onChange: e => setFormData({\n              ...formData,\n              imageUrl: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500\",\n            children: \"Tip: Search Google Images, right click image, \\\"Copy Image Address\\\"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"text-sm font-semibold text-gray-700\",\n            children: \"City/Location\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            required: true,\n            className: \"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\",\n            placeholder: \"e.g. New York, NY\",\n            value: formData.location,\n            onChange: e => setFormData({\n              ...formData,\n              location: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pt-4 flex gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => setView('browse'),\n            className: \"flex-1 px-6 py-3 border border-gray-200 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 transition\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: loading,\n            className: \"flex-1 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-xl shadow-lg shadow-emerald-200 transition flex justify-center items-center\",\n            children: loading ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 26\n            }, this) : 'List Book'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 336,\n    columnNumber: 5\n  }, this);\n};\n\n// --- Main App Component ---\n_s2(AddBook, \"F9knlpYJ9vz1wcEg0NGlCFvfvao=\");\n_c6 = AddBook;\nexport default function App() {\n  _s3();\n  const [user, setUser] = useState(null);\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [currentView, setCurrentView] = useState('home'); // home, browse, add, favorites, chat, exchanges, profile\n  const [notification, setNotification] = useState(null);\n  const [token, setToken] = useState(null);\n  const [conversationId, setConversationId] = useState(null);\n  const [exchanges, setExchanges] = useState([]);\n  const [unreadTotal, setUnreadTotal] = useState(0);\n  const [favorites, setFavorites] = useState([]);\n  const apiFetch = (url, opts = {}) => {\n    const headers = opts.headers || {};\n    if (token) headers['Authorization'] = `Bearer ${token}`;\n    return fetch(url, {\n      ...opts,\n      headers\n    });\n  };\n\n  // 1. Auth Handling (JWT stored in localStorage)\n  useEffect(() => {\n    const t = localStorage.getItem('be_token');\n    const u = localStorage.getItem('be_user');\n    if (t) setToken(t);\n    if (u) setUser(JSON.parse(u));\n    // verify token and refresh user\n    if (t) {\n      fetch('/api/me', {\n        headers: {\n          Authorization: `Bearer ${t}`\n        }\n      }).then(r => r.json()).then(data => {\n        if (!data.error) {\n          setUser(data);\n          localStorage.setItem('be_user', JSON.stringify(data));\n        } else {\n          localStorage.removeItem('be_token');\n          localStorage.removeItem('be_user');\n          setToken(null);\n          setUser(null);\n        }\n      }).catch(() => {});\n    }\n  }, []);\n\n  // 2. Data Fetching\n  const fetchBooks = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch(BOOKS_API);\n      const data = await res.json();\n      setBooks(data || []);\n    } catch (err) {\n      console.error('Fetch books error', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchExchanges = async () => {\n    if (!token) return setExchanges([]);\n    try {\n      const res = await apiFetch('/api/exchanges');\n      const data = await res.json();\n      setExchanges(data || []);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const fetchFavorites = async () => {\n    if (!token) return setFavorites([]);\n    try {\n      const res = await apiFetch('/api/users/favorites');\n      const data = await res.json();\n      if (data && !data.error) {\n        setFavorites(data.map(b => b.id) || []);\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const handleToggleFavorite = async bookId => {\n    if (!token) return;\n    try {\n      const res = await apiFetch('/api/users/favorite', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          bookId\n        })\n      });\n      const data = await res.json();\n      if (data.favorites) {\n        setFavorites(data.favorites);\n        const isFav = data.favorites.includes(bookId);\n        showNotification(isFav ? 'Added to favorites' : 'Removed from favorites', 'success');\n      }\n    } catch (e) {\n      console.error(e);\n      showNotification('Failed to update favorite', 'error');\n    }\n  };\n  useEffect(() => {\n    fetchBooks();\n  }, []);\n  useEffect(() => {\n    fetchExchanges();\n  }, [token]);\n  useEffect(() => {\n    fetchFavorites();\n  }, [token]);\n  useEffect(() => {\n    // compute unread total from conversations\n    async function compute() {\n      if (!token) return setUnreadTotal(0);\n      try {\n        const r = await fetch('/api/conversations', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const d = await r.json();\n        const total = (d || []).reduce((s, c) => s + (c.unreadCount || 0), 0);\n        setUnreadTotal(total);\n        // update navbar badge\n        const badge = document.getElementById('nav-unread-badge');\n        if (badge) {\n          if (total > 0) {\n            badge.textContent = total;\n            badge.classList.remove('hidden');\n          } else {\n            badge.classList.add('hidden');\n          }\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    }\n    compute();\n  }, [token, conversationId]);\n\n  // Actions\n  const handleLogin = () => setCurrentView('signin');\n  const doSignup = async (name, email, password) => {\n    try {\n      const res = await fetch('/api/signup', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          name,\n          email,\n          password\n        })\n      });\n      const data = await res.json();\n      if (data.token) {\n        localStorage.setItem('be_token', data.token);\n        localStorage.setItem('be_user', JSON.stringify(data.user));\n        setToken(data.token);\n        setUser(data.user);\n        setCurrentView('browse');\n        showNotification('Account created', 'success');\n      } else {\n        showNotification(data.error || 'Signup failed', 'error');\n      }\n    } catch (err) {\n      showNotification('Signup failed', 'error');\n    }\n  };\n  const doLogin = async (email, password) => {\n    try {\n      const res = await fetch('/api/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email,\n          password\n        })\n      });\n      const data = await res.json();\n      if (data.token) {\n        localStorage.setItem('be_token', data.token);\n        localStorage.setItem('be_user', JSON.stringify(data.user));\n        setToken(data.token);\n        setUser(data.user);\n        setCurrentView('browse');\n        showNotification('Signed in', 'success');\n      } else {\n        showNotification(data.error || 'Login failed', 'error');\n      }\n    } catch (err) {\n      showNotification('Login failed', 'error');\n    }\n  };\n  const handleLogout = () => {\n    localStorage.removeItem('be_user');\n    localStorage.removeItem('be_token');\n    setUser(null);\n    setToken(null);\n    setCurrentView('home');\n    showNotification('Logged out', 'default');\n  };\n  const handleExchange = async book => {\n    if (!user) {\n      showNotification('Please sign in to request books.', 'error');\n      return;\n    }\n    if (!confirm(`Request to exchange \"${book.title}\"?`)) return;\n    try {\n      var _data$conversation;\n      // create an exchange request (server will create/get conversation)\n      const res = await apiFetch('/api/exchanges', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          bookId: book.id,\n          message: `I'd like to request ${book.title}`\n        })\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error || 'Failed to create exchange');\n      const conv = data.conversation || data.conversationId || ((_data$conversation = data.conversation) === null || _data$conversation === void 0 ? void 0 : _data$conversation.id) || (data.conversation && data.conversation.id ? data.conversation : null);\n      if (conv && conv.id) {\n        setConversationId(conv.id);\n        setCurrentView('chat');\n      } else if (data.conversation && data.conversation.id) {\n        setConversationId(data.conversation.id);\n        setCurrentView('chat');\n      }\n      showNotification('Request sent and private chat opened.', 'success');\n      fetchBooks();\n      fetchExchanges();\n    } catch (err) {\n      console.error(err);\n      showNotification('Failed to process exchange.', 'error');\n    }\n  };\n  const handleChat = async book => {\n    if (!user) {\n      showNotification('Please sign in to chat with owners.', 'error');\n      setCurrentView('signin');\n      return;\n    }\n    try {\n      const res = await apiFetch('/api/conversations', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          otherUserId: book.ownerId,\n          bookId: book.id\n        })\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error || 'Failed to create conversation');\n      const conv = data || null;\n      if (conv && conv.id) {\n        setConversationId(conv.id);\n        setCurrentView('chat');\n      }\n      showNotification('Private chat opened with owner.', 'success');\n    } catch (err) {\n      console.error(err);\n      showNotification('Failed to open chat.', 'error');\n    }\n  };\n  const showNotification = (message, type = 'default') => {\n    setNotification({\n      message,\n      type\n    });\n    setTimeout(() => setNotification(null), 3000);\n  };\n\n  // Helper for View Rendering\n  const renderView = () => {\n    switch (currentView) {\n      case 'home':\n        return /*#__PURE__*/_jsxDEV(Hero, {\n          setView: setCurrentView,\n          handleLogin: handleLogin,\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 16\n        }, this);\n      case 'browse':\n        return /*#__PURE__*/_jsxDEV(Browse, {\n          books: books,\n          loading: loading,\n          user: user,\n          handleExchange: handleExchange,\n          handleChat: handleChat,\n          favorites: favorites,\n          onToggleFavorite: handleToggleFavorite\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 16\n        }, this);\n      case 'favorites':\n        return user ? /*#__PURE__*/_jsxDEV(Favorites, {\n          books: books,\n          loading: loading,\n          user: user,\n          handleExchange: handleExchange,\n          handleChat: handleChat,\n          favorites: favorites,\n          onToggleFavorite: handleToggleFavorite\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 23\n        }, this) : /*#__PURE__*/_jsxDEV(Hero, {\n          setView: setCurrentView,\n          handleLogin: handleLogin,\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 201\n        }, this);\n      case 'add':\n        return user ? /*#__PURE__*/_jsxDEV(AddBook, {\n          setView: setCurrentView,\n          user: user,\n          token: token\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 661,\n          columnNumber: 23\n        }, this) : /*#__PURE__*/_jsxDEV(Hero, {\n          setView: setCurrentView,\n          handleLogin: handleLogin,\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 661,\n          columnNumber: 88\n        }, this);\n      case 'signin':\n        return /*#__PURE__*/_jsxDEV(SignIn, {\n          onLogin: doLogin,\n          onSwitch: () => setCurrentView('signup')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 663,\n          columnNumber: 16\n        }, this);\n      case 'signup':\n        return /*#__PURE__*/_jsxDEV(SignUp, {\n          onSignup: doSignup,\n          onSwitch: () => setCurrentView('signin')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 665,\n          columnNumber: 16\n        }, this);\n      case 'chat':\n        return /*#__PURE__*/_jsxDEV(Chat, {\n          user: user,\n          token: token,\n          conversationId: conversationId,\n          onSelectConversation: id => {\n            setConversationId(id);\n            setCurrentView('chat');\n          },\n          onLeave: () => {\n            setConversationId(null);\n            setCurrentView('chat');\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 667,\n          columnNumber: 16\n        }, this);\n      case 'exchanges':\n        return /*#__PURE__*/_jsxDEV(Exchanges, {\n          user: user,\n          token: token,\n          exchanges: exchanges,\n          refresh: fetchExchanges,\n          onOpenConversation: id => {\n            setConversationId(id);\n            setCurrentView('chat');\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 669,\n          columnNumber: 16\n        }, this);\n      case 'profile':\n        return /*#__PURE__*/_jsxDEV(Profile, {\n          user: user,\n          onUpdate: u => {\n            setUser(u);\n            localStorage.setItem('be_user', JSON.stringify(u));\n          },\n          token: token\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 671,\n          columnNumber: 16\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(Hero, {\n          setView: setCurrentView,\n          handleLogin: handleLogin,\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 673,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen pb-10 fancy-app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-blob\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 679,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Navbar, {\n      user: user,\n      setView: setCurrentView,\n      currentView: currentView,\n      handleLogin: handleLogin,\n      handleLogout: handleLogout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 680,\n      columnNumber: 7\n    }, this), notification && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `fixed top-20 right-4 z-50 px-6 py-3 rounded-lg shadow-xl border animate-fade-in-down ${notification.type === 'success' ? 'bg-emerald-100 border-emerald-200 text-emerald-800' : notification.type === 'error' ? 'bg-red-100 border-red-200 text-red-800' : 'bg-gray-800 text-white'}`,\n      children: notification.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 690,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: renderView()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 699,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 678,\n    columnNumber: 5\n  }, this);\n}\n\n// --- Auth / Chat / Profile UI Components ---\n_s3(App, \"4QIEx+Y9ylMfaAlScSCWvZ32KfM=\");\n_c7 = App;\nfunction SignIn({\n  onLogin,\n  onSwitch\n}) {\n  _s4();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-md mx-auto px-4 py-12\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-8 rounded shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold mb-4\",\n        children: \"Sign In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 714,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"w-full mb-2 p-2 border rounded\",\n        placeholder: \"Email\",\n        value: email,\n        onChange: e => setEmail(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 715,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"w-full mb-4 p-2 border rounded\",\n        placeholder: \"Password\",\n        value: password,\n        onChange: e => setPassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 716,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onLogin(email, password),\n          className: \"bg-emerald-600 text-white px-4 py-2 rounded\",\n          children: \"Sign In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 718,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onSwitch,\n          className: \"px-4 py-2 border rounded\",\n          children: \"Create Account\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 719,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 717,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 713,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 712,\n    columnNumber: 5\n  }, this);\n}\n_s4(SignIn, \"TSZhDBNy8CmbxXgprY/vvMmTG1Q=\");\n_c8 = SignIn;\nfunction SignUp({\n  onSignup,\n  onSwitch\n}) {\n  _s5();\n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-md mx-auto px-4 py-12\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-8 rounded shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold mb-4\",\n        children: \"Create Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 733,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"w-full mb-2 p-2 border rounded\",\n        placeholder: \"Name\",\n        value: name,\n        onChange: e => setName(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 734,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"w-full mb-2 p-2 border rounded\",\n        placeholder: \"Email\",\n        value: email,\n        onChange: e => setEmail(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 735,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"w-full mb-4 p-2 border rounded\",\n        placeholder: \"Password\",\n        value: password,\n        onChange: e => setPassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 736,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onSignup(name, email, password),\n          className: \"bg-emerald-600 text-white px-4 py-2 rounded\",\n          children: \"Sign Up\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onSwitch,\n          className: \"px-4 py-2 border rounded\",\n          children: \"Sign In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 739,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 737,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 732,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 731,\n    columnNumber: 5\n  }, this);\n}\n_s5(SignUp, \"y7AVIb+2dT29WONRxO7d74XBSmc=\");\n_c9 = SignUp;\nimport { io as ioClient } from 'socket.io-client';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Chat({\n  user,\n  token,\n  conversationId,\n  onSelectConversation,\n  onLeave\n}) {\n  _s6();\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState('');\n  const [conversations, setConversations] = useState([]);\n  const socketRef = React.useRef(null);\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      // Only load messages if a conversation is open\n      if (conversationId) {\n        const res = await fetch(`/api/conversations/${conversationId}/messages`, {\n          headers: {\n            Authorization: token ? `Bearer ${token}` : ''\n          }\n        });\n        const data = await res.json();\n        if (mounted) setMessages(data || []);\n      }\n    }\n    async function loadConvs() {\n      if (!token) return;\n      const r = await fetch('/api/conversations', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const d = await r.json();\n      setConversations(d || []);\n    }\n    load();\n    loadConvs();\n\n    // connect socket\n    socketRef.current = ioClient(window.location.origin.replace(/:\\d+$/, '') + ':5000');\n    // identify the socket with token so server can join user-specific room\n    if (token) {\n      socketRef.current.emit('identify', token);\n    }\n    socketRef.current.on('conversationMessage', msg => {\n      // only append if it belongs to our open conversation\n      if (conversationId && msg.conversationId === conversationId) setMessages(prev => [...prev, msg]);\n      // if not open, update conversation list (unread handled server-side)\n      if (!conversationId) loadConvs();\n    });\n    // exchange notifications\n    socketRef.current.on('exchangeRequest', ex => {\n      showNotification('New exchange request', 'default');\n      fetchExchanges();\n      loadConvs();\n    });\n    socketRef.current.on('exchangeAccepted', ex => {\n      showNotification('An exchange was accepted', 'success');\n      fetchExchanges();\n      fetchBooks();\n    });\n    socketRef.current.on('exchangeDeclined', ex => {\n      showNotification('An exchange was declined', 'error');\n      fetchExchanges();\n    });\n    return () => {\n      mounted = false;\n      if (socketRef.current) socketRef.current.disconnect();\n    };\n  }, [conversationId, token]);\n  useEffect(() => {\n    // when conversationId changes, join/leave socket room\n    if (!socketRef.current) return;\n    if (conversationId) {\n      socketRef.current.emit('joinConversation', conversationId);\n      // mark read on server\n      if (token) fetch(`/api/conversations/${conversationId}/read`, {\n        method: 'PUT',\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).catch(() => {});\n    }\n    return () => {\n      if (conversationId) socketRef.current.emit('leaveConversation', conversationId);\n    };\n  }, [conversationId]);\n  const send = async () => {\n    if (!text.trim()) return;\n    try {\n      if (conversationId) {\n        // send via socket to conversation room\n        if (socketRef.current && socketRef.current.connected) {\n          socketRef.current.emit('sendConversationMessage', {\n            token,\n            text,\n            conversationId\n          });\n        } else {\n          await fetch(`/api/conversations/${conversationId}/messages`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: token ? `Bearer ${token}` : ''\n            },\n            body: JSON.stringify({\n              text\n            })\n          });\n        }\n      }\n      setText('');\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-4xl mx-auto px-4 py-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold\",\n        children: \"Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 835,\n        columnNumber: 9\n      }, this), conversationId ? /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          if (onLeave) onLeave();\n        },\n        className: \"text-sm text-gray-600\",\n        children: \"Leave\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 836,\n        columnNumber: 27\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 834,\n      columnNumber: 7\n    }, this), !conversationId && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-semibold mb-2\",\n        children: \"Your Conversations\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 841,\n        columnNumber: 11\n      }, this), conversations.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-500\",\n        children: \"No conversations yet. Request a book to start a private chat.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 842,\n        columnNumber: 41\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: conversations.map(c => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onSelectConversation && onSelectConversation(c.id),\n          className: \"w-full text-left p-3 border rounded hover:bg-gray-50 flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-left\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm font-medium\",\n              children: [\"Conversation about \", c.bookId ? `book:${c.bookId}` : 'general']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 847,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-500\",\n              children: [\"With: \", (c.participantsInfo || c.participants).map(p => p.name || p).filter(Boolean).join(', ')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 848,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 846,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [c.unreadCount ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-emerald-600 text-white text-xs px-2 py-1 rounded-full\",\n              children: c.unreadCount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 851,\n              columnNumber: 38\n            }, this) : null, /*#__PURE__*/_jsxDEV(ArrowRight, {\n              className: \"w-4 h-4 text-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 852,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 850,\n            columnNumber: 19\n          }, this)]\n        }, c.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 845,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 843,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 840,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-glass p-4 rounded shadow h-[55vh] flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-auto mb-4\",\n        children: messages.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500\",\n            children: [m.fromName || m.from, \" \\u2022 \", new Date(m.createdAt).toLocaleTimeString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 865,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-100 inline-block p-2 rounded mt-1\",\n            children: m.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 866,\n            columnNumber: 15\n          }, this)]\n        }, m.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 864,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 862,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: text,\n          onChange: e => setText(e.target.value),\n          className: \"flex-1 p-2 border rounded\",\n          placeholder: user && conversationId ? 'Message the other participant...' : 'Select a conversation to start messaging',\n          disabled: !user || !conversationId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 871,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: send,\n          className: \"bg-emerald-600 text-white px-4 py-2 rounded\",\n          disabled: !user || !conversationId,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 872,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 870,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 861,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 833,\n    columnNumber: 5\n  }, this);\n}\n_s6(Chat, \"yAOD7aOYQdHy6S7/8PVGImWM2Eg=\");\n_c0 = Chat;\nfunction Profile({\n  user,\n  onUpdate,\n  token\n}) {\n  _s7();\n  const [name, setName] = useState((user === null || user === void 0 ? void 0 : user.name) || '');\n  const [bio, setBio] = useState((user === null || user === void 0 ? void 0 : user.bio) || '');\n  const save = async () => {\n    try {\n      if (!token) return;\n      const res = await fetch(`/api/users/${user.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          name,\n          bio\n        })\n      });\n      const data = await res.json();\n      if (res.ok) {\n        onUpdate(data);\n        showNotification('Profile updated', 'success');\n      } else {\n        showNotification(data.error || 'Failed to update profile', 'error');\n      }\n    } catch (e) {\n      console.error(e);\n      showNotification('Failed to update profile', 'error');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-md mx-auto px-4 py-12\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-8 rounded shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold mb-4\",\n        children: \"Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 898,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"w-full mb-2 p-2 border rounded\",\n        value: name,\n        onChange: e => setName(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 899,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"w-full mb-2 p-2 border rounded\",\n        value: bio,\n        onChange: e => setBio(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 900,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-2\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: save,\n          className: \"bg-emerald-600 text-white px-4 py-2 rounded\",\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 902,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 901,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 897,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 896,\n    columnNumber: 5\n  }, this);\n}\n_s7(Profile, \"eGB7YnSRDcPViUQwXwhWWyO/Loc=\");\n_c1 = Profile;\nfunction Exchanges({\n  user,\n  token,\n  exchanges,\n  refresh,\n  onOpenConversation\n}) {\n  const accept = async id => {\n    if (!token) return;\n    try {\n      const r = await fetch(`/api/exchanges/${id}/accept`, {\n        method: 'PUT',\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const d = await r.json();\n      if (r.ok) {\n        refresh();\n        alert('Exchange accepted');\n      } else alert(d.error || 'Failed');\n    } catch (e) {\n      console.error(e);\n      alert('Failed');\n    }\n  };\n  const decline = async id => {\n    if (!token) return;\n    try {\n      const r = await fetch(`/api/exchanges/${id}/decline`, {\n        method: 'PUT',\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const d = await r.json();\n      if (r.ok) {\n        refresh();\n        alert('Exchange declined');\n      } else alert(d.error || 'Failed');\n    } catch (e) {\n      console.error(e);\n      alert('Failed');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-4xl mx-auto px-4 py-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Exchange Requests\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 930,\n      columnNumber: 7\n    }, this), exchanges.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-gray-500\",\n      children: \"No exchange activity.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 931,\n      columnNumber: 33\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: exchanges.map(e => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white border p-4 rounded flex justify-between items-start\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-500\",\n            children: [\"Book: \", e.bookId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 936,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-medium\",\n            children: [\"From: \", e.requesterId, \" \\u2014 Status: \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: e.status\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 937,\n              columnNumber: 78\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 937,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-600 mt-2\",\n            children: e.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 938,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400 mt-2\",\n            children: [\"Requested at: \", new Date(e.createdAt).toLocaleString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 939,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 935,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col gap-2\",\n          children: [e.ownerId === (user === null || user === void 0 ? void 0 : user.id) && e.status === 'requested' ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => accept(e.id),\n              className: \"px-3 py-2 bg-emerald-600 text-white rounded\",\n              children: \"Accept\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 944,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => decline(e.id),\n              className: \"px-3 py-2 border rounded\",\n              children: \"Decline\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 945,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true) : null, /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              var _e$conversation;\n              return onOpenConversation && onOpenConversation(e.conversationId || ((_e$conversation = e.conversation) === null || _e$conversation === void 0 ? void 0 : _e$conversation.id));\n            },\n            className: \"px-3 py-2 bg-gray-100 rounded\",\n            children: \"Open Chat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 948,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 941,\n          columnNumber: 15\n        }, this)]\n      }, e.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 934,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 932,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 929,\n    columnNumber: 5\n  }, this);\n}\n_c10 = Exchanges;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10;\n$RefreshReg$(_c, \"Navbar\");\n$RefreshReg$(_c2, \"Hero\");\n$RefreshReg$(_c3, \"BookCard\");\n$RefreshReg$(_c4, \"Browse\");\n$RefreshReg$(_c5, \"Favorites\");\n$RefreshReg$(_c6, \"AddBook\");\n$RefreshReg$(_c7, \"App\");\n$RefreshReg$(_c8, \"SignIn\");\n$RefreshReg$(_c9, \"SignUp\");\n$RefreshReg$(_c0, \"Chat\");\n$RefreshReg$(_c1, \"Profile\");\n$RefreshReg$(_c10, \"Exchanges\");","map":{"version":3,"names":["React","useState","useEffect","Book","Search","PlusCircle","Library","User","LogOut","RefreshCw","MapPin","Heart","MessageSquare","ArrowRight","API_BASE","BOOKS_API","Navbar","user","setView","currentView","handleLogin","handleLogout","_jsxDEV","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_Fragment","title","id","slice","toUpperCase","_c","Hero","_c2","BookCard","book","handleExchange","handleChat","isFavorited","onToggleFavorite","imageUrl","src","alt","onError","e","target","condition","genre","author","location","ownerId","status","disabled","_c3","Browse","books","loading","favorites","_s","searchTerm","setSearchTerm","filteredBooks","filter","toLowerCase","includes","type","placeholder","value","onChange","length","map","_c4","Favorites","favoriteBooks","b","_c5","AddBook","token","_s2","setLoading","formData","setFormData","handleSubmit","preventDefault","fetch","method","headers","Authorization","body","JSON","stringify","error","console","alert","onSubmit","required","_c6","App","_s3","setUser","setBooks","setCurrentView","notification","setNotification","setToken","conversationId","setConversationId","exchanges","setExchanges","unreadTotal","setUnreadTotal","setFavorites","apiFetch","url","opts","t","localStorage","getItem","u","parse","then","r","json","data","setItem","removeItem","catch","fetchBooks","res","err","fetchExchanges","fetchFavorites","handleToggleFavorite","bookId","isFav","showNotification","compute","d","total","reduce","s","c","unreadCount","badge","document","getElementById","textContent","classList","remove","add","doSignup","name","email","password","doLogin","confirm","_data$conversation","message","ok","Error","conv","conversation","otherUserId","setTimeout","renderView","SignIn","onLogin","onSwitch","SignUp","onSignup","Chat","onSelectConversation","onLeave","Exchanges","refresh","onOpenConversation","Profile","onUpdate","_c7","_s4","setEmail","setPassword","_c8","_s5","setName","_c9","io","ioClient","jsxDEV","Fragment","_s6","messages","setMessages","text","setText","conversations","setConversations","socketRef","useRef","mounted","load","loadConvs","current","window","origin","replace","emit","on","msg","prev","ex","disconnect","send","trim","connected","participantsInfo","participants","p","Boolean","join","m","fromName","from","Date","createdAt","toLocaleTimeString","_c0","_s7","bio","setBio","save","_c1","accept","decline","requesterId","toLocaleString","_e$conversation","_c10","$RefreshReg$"],"sources":["C:/Users/dell/Desktop/pro/book-exchange-app/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { \r\n  Book, \r\n  Search, \r\n  PlusCircle, \r\n  Library, \r\n  User, \r\n  LogOut, \r\n  RefreshCw, \r\n  MapPin,\r\n  Heart,\r\n  MessageSquare,\r\n  ArrowRight\r\n} from 'lucide-react';\r\n\r\n// Use the server API (file-based) instead of Firebase.\r\nconst API_BASE = '';\r\nconst BOOKS_API = `${API_BASE}/api/books`;\r\n\r\n// --- Components ---\r\n\r\nconst Navbar = ({ user, setView, currentView, handleLogin, handleLogout }) => (\r\n  <nav className=\"site-header sticky top-0 z-50 px-4 py-3\">\r\n    <div className=\"max-w-6xl mx-auto flex justify-between items-center\">\r\n      <div \r\n        className=\"flex items-center gap-2 cursor-pointer site-logo\" \r\n        onClick={() => setView('home')}\r\n      >\r\n        <div className=\"logo-badge\">\r\n          <Book className=\"w-6 h-6 text-white\" />\r\n        </div>\r\n        <span className=\"logo-text\">BookLoop</span>\r\n      </div>\r\n\r\n      <div className=\"flex items-center gap-6\">\r\n        <button \r\n          onClick={() => setView('browse')}\r\n          className={`text-sm font-medium transition ${currentView === 'browse' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`}\r\n        >\r\n          Browse Books\r\n        </button>\r\n        <button \r\n          onClick={() => setView('chat')}\r\n          className={`text-sm font-medium transition ${currentView === 'chat' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`}\r\n        >\r\n          Chat\r\n        </button>\r\n        <button onClick={() => setView('exchanges')} className={`text-sm font-medium transition ${currentView === 'exchanges' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`}>Requests</button>\r\n        \r\n        {user ? (\r\n          <>\r\n            <button \r\n              onClick={() => setView('favorites')}\r\n              className={`text-sm font-medium transition flex items-center gap-1 ${currentView === 'favorites' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`}\r\n            >\r\n              <Heart className=\"w-4 h-4\" />\r\n              Favorites\r\n            </button>\r\n            <button \r\n              onClick={() => setView('add')}\r\n              className={`text-sm font-medium transition flex items-center gap-1 ${currentView === 'add' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`}\r\n            >\r\n              <PlusCircle className=\"w-4 h-4\" />\r\n              Add Book\r\n            </button>\r\n            <div className=\"flex items-center gap-3 pl-4 border-l\">\r\n              <button \r\n                onClick={() => setView('profile')}\r\n                className={`text-sm font-medium transition flex items-center justify-center ${currentView === 'profile' ? 'text-emerald-600' : 'text-gray-500 hover:text-gray-800'}`}\r\n                title=\"Profile\"\r\n              >\r\n                <div className=\"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-700 font-bold text-xs\">\r\n                  {(user?.id || '').slice(0,2).toUpperCase()}\r\n                </div>\r\n              </button>\r\n              {/* badge for unread */}\r\n              <div id=\"nav-unread-badge\" className=\"absolute -top-2 -right-2 bg-rose-500 text-white text-[10px] px-1 rounded-full hidden\">0</div>\r\n              <button \r\n                onClick={handleLogout}\r\n                className=\"text-gray-400 hover:text-red-500 transition\"\r\n                title=\"Logout\"\r\n              >\r\n                <LogOut className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          <div className=\"flex items-center gap-3\">\r\n            <button onClick={() => setView('signin')} className=\"text-sm text-gray-700 hover:text-gray-900\">Sign In</button>\r\n            <button onClick={() => setView('signup')} className=\"bg-emerald-600 text-white px-3 py-1 rounded-md text-sm\">Sign Up</button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  </nav>\r\n);\r\n\r\nconst Hero = ({ setView, handleLogin, user }) => (\r\n  <div className=\"bg-gradient-to-b from-emerald-50 to-white pt-20 pb-24 px-4\">\r\n    <div className=\"max-w-4xl mx-auto text-center\">\r\n      <div className=\"inline-flex items-center gap-2 bg-white/6 text-emerald-300 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider mb-6 backdrop-blur\">\r\n        <RefreshCw className=\"w-3 h-3\" />\r\n        The #1 Book Exchange Platform\r\n      </div>\r\n      <h1 className=\"text-5xl md:text-6xl font-extrabold text-gray-900 mb-6 leading-tight\">\r\n        Give a Book. <br/>\r\n        <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-teal-500\">\r\n          Get a Book.\r\n        </span>\r\n      </h1>\r\n      <p className=\"text-xl text-gray-600 mb-10 max-w-2xl mx-auto leading-relaxed\">\r\n        Join a community of readers. Upload the books gathering dust on your shelf and swap them for your next great adventure.\r\n      </p>\r\n      <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\r\n        <button \r\n          onClick={() => setView('browse')}\r\n          className=\"neon-btn w-full sm:w-auto\"\r\n        >\r\n          Start Browsing\r\n        </button>\r\n        {!user && (\r\n          <button \r\n            onClick={handleLogin}\r\n            className=\"outline-btn w-full sm:w-auto px-8 py-4 font-bold text-lg transition\"\r\n          >\r\n            Join Now\r\n          </button>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Stats */}\r\n      <div className=\"mt-16 grid grid-cols-3 gap-8 max-w-2xl mx-auto border-t pt-8\">\r\n        <div>\r\n          <div className=\"text-3xl font-bold text-gray-900\">2k+</div>\r\n          <div className=\"text-sm text-gray-500 mt-1\">Active Readers</div>\r\n        </div>\r\n        <div>\r\n          <div className=\"text-3xl font-bold text-gray-900\">5k+</div>\r\n          <div className=\"text-sm text-gray-500 mt-1\">Books Swapped</div>\r\n        </div>\r\n        <div>\r\n          <div className=\"text-3xl font-bold text-gray-900\">100%</div>\r\n          <div className=\"text-sm text-gray-500 mt-1\">Free to Join</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst BookCard = ({ book, user, handleExchange, handleChat, isFavorited, onToggleFavorite }) => {\r\n  return (\r\n    <div className=\"group fancy-card animate-tilt flex flex-col overflow-hidden h-full\">\r\n      <div className=\"h-48 overflow-hidden relative bg-gray-100\">\r\n        {book.imageUrl ? (\r\n          <img \r\n            src={book.imageUrl} \r\n            alt={book.title} \r\n            className=\"w-full h-full object-cover transition duration-500 group-hover:scale-105\"\r\n            onError={(e) => {\r\n              e.target.src = 'https://images.unsplash.com/photo-1543002588-bfa74002ed7e?auto=format&fit=crop&q=80&w=2730';\r\n            }}\r\n          />\r\n        ) : (\r\n          <div className=\"w-full h-full flex items-center justify-center text-gray-300 bg-slate-50\">\r\n            <Book className=\"w-16 h-16\" />\r\n          </div>\r\n        )}\r\n        <div className=\"absolute top-3 right-3 bg-white/90 backdrop-blur-sm px-2 py-1 rounded-md text-xs font-bold text-gray-700 shadow-sm\">\r\n          {book.condition}\r\n        </div>\r\n        {user && onToggleFavorite && (\r\n          <button\r\n            onClick={() => onToggleFavorite(book.id)}\r\n            className=\"absolute top-3 left-3 bg-white/90 backdrop-blur-sm p-2 rounded-md hover:bg-white transition shadow-sm\"\r\n            title={isFavorited ? 'Remove from favorites' : 'Add to favorites'}\r\n          >\r\n            <Heart className={`w-5 h-5 ${isFavorited ? 'fill-red-500 text-red-500' : 'text-gray-400'}`} />\r\n          </button>\r\n        )}\r\n      </div>\r\n      \r\n      <div className=\"p-5 flex flex-col flex-grow\">\r\n        <div className=\"text-xs font-semibold text-emerald-600 mb-2 uppercase tracking-wider\">{book.genre || 'General'}</div>\r\n        <h3 className=\"text-lg font-bold text-gray-900 mb-1 leading-tight\">{book.title}</h3>\r\n        <p className=\"text-sm text-gray-500 mb-4\">by {book.author}</p>\r\n        \r\n        <div className=\"flex items-center gap-2 text-xs text-gray-400 mb-6 mt-auto\">\r\n          <MapPin className=\"w-3 h-3\" />\r\n          <span>{book.location || 'Remote'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-between pt-4 border-t border-gray-50 mt-auto\">\r\n           <div className=\"flex items-center gap-2\">\r\n             <div className=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-400 to-indigo-500 text-[10px] text-white flex items-center justify-center\">\r\n               {book.ownerId ? book.ownerId.slice(0,2).toUpperCase() : '??'}\r\n             </div>\r\n             <span className=\"text-xs text-gray-500\">Owner</span>\r\n           </div>\r\n\r\n           {user && user.id === book.ownerId ? (\r\n             <span className=\"text-xs font-medium text-gray-400 bg-gray-100 px-3 py-1 rounded-full\">Your Book</span>\r\n           ) : (\r\n             <div className=\"card-actions\">\r\n              {book.status && book.status !== 'available' ? (\r\n                   <span className=\"glow-badge\">{book.status}</span>\r\n                 ) : (\r\n                   <button \r\n                    onClick={() => handleExchange(book)}\r\n                    disabled={book.status === 'exchanged'}\r\n                    className={`neon-btn ${book.status === 'exchanged' ? 'opacity-60 cursor-not-allowed' : ''}`}\r\n                   >\r\n                     {book.status === 'exchanged' ? 'Taken' : 'Request'}\r\n                   </button>\r\n                 )}\r\n               <button onClick={() => handleChat && handleChat(book)} className=\"text-sm px-3 py-2 border rounded-lg bg-white hover:bg-gray-50 flex items-center gap-2\">\r\n                 <MessageSquare className=\"w-4 h-4\" />\r\n                 <span>Message</span>\r\n               </button>\r\n             </div>\r\n           )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Browse = ({ books, loading, user, handleExchange, handleChat, favorites, onToggleFavorite }) => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  \r\n  const filteredBooks = books.filter(book => \r\n    book.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    book.author.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto px-4 py-8\">\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">Explore Collection</h2>\r\n          <p className=\"text-gray-500\">Find your next favorite read.</p>\r\n        </div>\r\n        \r\n        <div className=\"relative w-full md:w-96\">\r\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\r\n          <input \r\n            type=\"text\" \r\n            placeholder=\"Search by title or author...\" \r\n            className=\"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div className=\"flex justify-center items-center h-64\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600\"></div>\r\n        </div>\r\n      ) : filteredBooks.length === 0 ? (\r\n        <div className=\"text-center py-20 bg-gray-50 rounded-2xl border border-dashed border-gray-200\">\r\n          <Book className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n          <h3 className=\"text-lg font-medium text-gray-900\">No books found</h3>\r\n          <p className=\"text-gray-500\">Try adjusting your search terms.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n          {filteredBooks.map(book => (\r\n            <BookCard key={book.id} book={book} user={user} handleExchange={handleExchange} handleChat={handleChat} isFavorited={favorites.includes(book.id)} onToggleFavorite={onToggleFavorite} />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Favorites = ({ books, loading, user, handleExchange, handleChat, favorites, onToggleFavorite }) => {\r\n  const favoriteBooks = books.filter(b => favorites.includes(b.id));\r\n  \r\n  return (\r\n    <div className=\"max-w-6xl mx-auto px-4 py-8\">\r\n      <div className=\"flex items-center gap-3 mb-8\">\r\n        <Heart className=\"w-8 h-8 text-red-500 fill-red-500\" />\r\n        <h2 className=\"text-2xl font-bold text-gray-900\">My Favorites</h2>\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div className=\"flex justify-center items-center h-64\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600\"></div>\r\n        </div>\r\n      ) : favoriteBooks.length === 0 ? (\r\n        <div className=\"text-center py-20 bg-gray-50 rounded-2xl border border-dashed border-gray-200\">\r\n          <Heart className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n          <h3 className=\"text-lg font-medium text-gray-900\">No favorites yet</h3>\r\n          <p className=\"text-gray-500\">Click the heart icon on books you love.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n          {favoriteBooks.map(book => (\r\n            <BookCard key={book.id} book={book} user={user} handleExchange={handleExchange} handleChat={handleChat} isFavorited={true} onToggleFavorite={onToggleFavorite} />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AddBook = ({ setView, user, token }) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    author: '',\r\n    genre: 'Fiction',\r\n    condition: 'Good',\r\n    location: '',\r\n    imageUrl: ''\r\n  });\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!user) return;\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Post to server\r\n      await fetch(BOOKS_API, { method: 'POST', headers: { 'Content-Type': 'application/json', Authorization: token ? `Bearer ${token}` : '' }, body: JSON.stringify({ ...formData, ownerId: user.id }) });\r\n      setView('browse');\r\n    } catch (error) {\r\n      console.error(\"Error adding book:\", error);\r\n      alert(\"Failed to add book. Try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto px-4 py-12\">\r\n      <div className=\"bg-white p-8 rounded-2xl shadow-lg border border-gray-100\">\r\n        <div className=\"flex items-center gap-3 mb-8\">\r\n          <div className=\"bg-emerald-100 p-3 rounded-full\">\r\n            <PlusCircle className=\"w-6 h-6 text-emerald-600\" />\r\n          </div>\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold text-gray-900\">List a Book</h2>\r\n            <p className=\"text-gray-500 text-sm\">Share a book with the community</p>\r\n          </div>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-semibold text-gray-700\">Book Title</label>\r\n              <input \r\n                required\r\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\"\r\n                placeholder=\"e.g. The Great Gatsby\"\r\n                value={formData.title}\r\n                onChange={e => setFormData({...formData, title: e.target.value})}\r\n              />\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-semibold text-gray-700\">Author</label>\r\n              <input \r\n                required\r\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\"\r\n                placeholder=\"e.g. F. Scott Fitzgerald\"\r\n                value={formData.author}\r\n                onChange={e => setFormData({...formData, author: e.target.value})}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-semibold text-gray-700\">Genre</label>\r\n              <select \r\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition bg-white\"\r\n                value={formData.genre}\r\n                onChange={e => setFormData({...formData, genre: e.target.value})}\r\n              >\r\n                <option>Fiction</option>\r\n                <option>Non-Fiction</option>\r\n                <option>Sci-Fi</option>\r\n                <option>Mystery</option>\r\n                <option>Biography</option>\r\n                <option>Textbook</option>\r\n              </select>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-semibold text-gray-700\">Condition</label>\r\n              <select \r\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition bg-white\"\r\n                value={formData.condition}\r\n                onChange={e => setFormData({...formData, condition: e.target.value})}\r\n              >\r\n                <option>New</option>\r\n                <option>Like New</option>\r\n                <option>Good</option>\r\n                <option>Fair</option>\r\n                <option>Poor</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-sm font-semibold text-gray-700\">Cover Image URL</label>\r\n            <input \r\n              type=\"url\"\r\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\"\r\n              placeholder=\"https://example.com/image.jpg\"\r\n              value={formData.imageUrl}\r\n              onChange={e => setFormData({...formData, imageUrl: e.target.value})}\r\n            />\r\n            <p className=\"text-xs text-gray-500\">Tip: Search Google Images, right click image, \"Copy Image Address\"</p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-sm font-semibold text-gray-700\">City/Location</label>\r\n            <input \r\n              required\r\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-emerald-100 focus:border-emerald-500 outline-none transition\"\r\n              placeholder=\"e.g. New York, NY\"\r\n              value={formData.location}\r\n              onChange={e => setFormData({...formData, location: e.target.value})}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"pt-4 flex gap-4\">\r\n            <button \r\n              type=\"button\"\r\n              onClick={() => setView('browse')}\r\n              className=\"flex-1 px-6 py-3 border border-gray-200 text-gray-700 font-semibold rounded-xl hover:bg-gray-50 transition\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button \r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"flex-1 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-xl shadow-lg shadow-emerald-200 transition flex justify-center items-center\"\r\n            >\r\n              {loading ? <span className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></span> : 'List Book'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// --- Main App Component ---\r\n\r\nexport default function App() {\r\n  const [user, setUser] = useState(null);\r\n  const [books, setBooks] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [currentView, setCurrentView] = useState('home'); // home, browse, add, favorites, chat, exchanges, profile\r\n  const [notification, setNotification] = useState(null);\r\n  const [token, setToken] = useState(null);\r\n  const [conversationId, setConversationId] = useState(null);\r\n  const [exchanges, setExchanges] = useState([]);\r\n  const [unreadTotal, setUnreadTotal] = useState(0);\r\n  const [favorites, setFavorites] = useState([]);\r\n\r\n  const apiFetch = (url, opts = {}) => {\r\n    const headers = opts.headers || {};\r\n    if (token) headers['Authorization'] = `Bearer ${token}`;\r\n    return fetch(url, { ...opts, headers });\r\n  };\r\n\r\n  // 1. Auth Handling (JWT stored in localStorage)\r\n  useEffect(() => {\r\n    const t = localStorage.getItem('be_token');\r\n    const u = localStorage.getItem('be_user');\r\n    if (t) setToken(t);\r\n    if (u) setUser(JSON.parse(u));\r\n    // verify token and refresh user\r\n    if (t) {\r\n      fetch('/api/me', { headers: { Authorization: `Bearer ${t}` } })\r\n        .then(r => r.json())\r\n        .then(data => { if (!data.error) { setUser(data); localStorage.setItem('be_user', JSON.stringify(data)); } else { localStorage.removeItem('be_token'); localStorage.removeItem('be_user'); setToken(null); setUser(null); } })\r\n        .catch(() => {});\r\n    }\r\n  }, []);\r\n\r\n  // 2. Data Fetching\r\n  const fetchBooks = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(BOOKS_API);\r\n      const data = await res.json();\r\n      setBooks(data || []);\r\n    } catch (err) {\r\n      console.error('Fetch books error', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchExchanges = async () => {\r\n    if (!token) return setExchanges([]);\r\n    try {\r\n      const res = await apiFetch('/api/exchanges');\r\n      const data = await res.json();\r\n      setExchanges(data || []);\r\n    } catch (e) { console.error(e); }\r\n  };\r\n\r\n  const fetchFavorites = async () => {\r\n    if (!token) return setFavorites([]);\r\n    try {\r\n      const res = await apiFetch('/api/users/favorites');\r\n      const data = await res.json();\r\n      if (data && !data.error) {\r\n        setFavorites(data.map(b => b.id) || []);\r\n      }\r\n    } catch (e) { console.error(e); }\r\n  };\r\n\r\n  const handleToggleFavorite = async (bookId) => {\r\n    if (!token) return;\r\n    try {\r\n      const res = await apiFetch('/api/users/favorite', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ bookId }) });\r\n      const data = await res.json();\r\n      if (data.favorites) {\r\n        setFavorites(data.favorites);\r\n        const isFav = data.favorites.includes(bookId);\r\n        showNotification(isFav ? 'Added to favorites' : 'Removed from favorites', 'success');\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      showNotification('Failed to update favorite', 'error');\r\n    }\r\n  };\r\n\r\n  useEffect(() => { fetchBooks(); }, []);\r\n  useEffect(() => { fetchExchanges(); }, [token]);\r\n  useEffect(() => { fetchFavorites(); }, [token]);\r\n  useEffect(() => {\r\n    // compute unread total from conversations\r\n    async function compute() {\r\n      if (!token) return setUnreadTotal(0);\r\n      try {\r\n        const r = await fetch('/api/conversations', { headers: { Authorization: `Bearer ${token}` } });\r\n        const d = await r.json();\r\n        const total = (d || []).reduce((s, c) => s + (c.unreadCount || 0), 0);\r\n        setUnreadTotal(total);\r\n        // update navbar badge\r\n        const badge = document.getElementById('nav-unread-badge');\r\n        if (badge) {\r\n          if (total > 0) { badge.textContent = total; badge.classList.remove('hidden'); }\r\n          else { badge.classList.add('hidden'); }\r\n        }\r\n      } catch (e) { console.error(e); }\r\n    }\r\n    compute();\r\n  }, [token, conversationId]);\r\n\r\n  // Actions\r\n  const handleLogin = () => setCurrentView('signin');\r\n\r\n  const doSignup = async (name, email, password) => {\r\n    try {\r\n      const res = await fetch('/api/signup', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ name, email, password }) });\r\n      const data = await res.json();\r\n      if (data.token) {\r\n        localStorage.setItem('be_token', data.token);\r\n        localStorage.setItem('be_user', JSON.stringify(data.user));\r\n        setToken(data.token);\r\n        setUser(data.user);\r\n        setCurrentView('browse');\r\n        showNotification('Account created', 'success');\r\n      } else {\r\n        showNotification(data.error || 'Signup failed', 'error');\r\n      }\r\n    } catch (err) { showNotification('Signup failed', 'error'); }\r\n  };\r\n\r\n  const doLogin = async (email, password) => {\r\n    try {\r\n      const res = await fetch('/api/login', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email, password }) });\r\n      const data = await res.json();\r\n      if (data.token) {\r\n        localStorage.setItem('be_token', data.token);\r\n        localStorage.setItem('be_user', JSON.stringify(data.user));\r\n        setToken(data.token);\r\n        setUser(data.user);\r\n        setCurrentView('browse');\r\n        showNotification('Signed in', 'success');\r\n      } else {\r\n        showNotification(data.error || 'Login failed', 'error');\r\n      }\r\n    } catch (err) { showNotification('Login failed', 'error'); }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('be_user');\r\n    localStorage.removeItem('be_token');\r\n    setUser(null);\r\n    setToken(null);\r\n    setCurrentView('home');\r\n    showNotification('Logged out', 'default');\r\n  };\r\n\r\n  const handleExchange = async (book) => {\r\n    if (!user) { showNotification('Please sign in to request books.', 'error'); return; }\r\n    if (!confirm(`Request to exchange \"${book.title}\"?`)) return;\r\n    try {\r\n      // create an exchange request (server will create/get conversation)\r\n      const res = await apiFetch('/api/exchanges', { method: 'POST', headers: { 'Content-Type':'application/json' }, body: JSON.stringify({ bookId: book.id, message: `I'd like to request ${book.title}` }) });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data.error || 'Failed to create exchange');\r\n      const conv = data.conversation || data.conversationId || data.conversation?.id || (data.conversation && data.conversation.id ? data.conversation : null);\r\n      if (conv && conv.id) {\r\n        setConversationId(conv.id);\r\n        setCurrentView('chat');\r\n      } else if (data.conversation && data.conversation.id) {\r\n        setConversationId(data.conversation.id);\r\n        setCurrentView('chat');\r\n      }\r\n      showNotification('Request sent and private chat opened.', 'success');\r\n      fetchBooks();\r\n      fetchExchanges();\r\n    } catch (err) {\r\n      console.error(err);\r\n      showNotification('Failed to process exchange.', 'error');\r\n    }\r\n  };\r\n\r\n  const handleChat = async (book) => {\r\n    if (!user) { showNotification('Please sign in to chat with owners.', 'error'); setCurrentView('signin'); return; }\r\n    try {\r\n      const res = await apiFetch('/api/conversations', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ otherUserId: book.ownerId, bookId: book.id }) });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data.error || 'Failed to create conversation');\r\n      const conv = data || null;\r\n      if (conv && conv.id) {\r\n        setConversationId(conv.id);\r\n        setCurrentView('chat');\r\n      }\r\n      showNotification('Private chat opened with owner.', 'success');\r\n    } catch (err) {\r\n      console.error(err);\r\n      showNotification('Failed to open chat.', 'error');\r\n    }\r\n  };\r\n\r\n  const showNotification = (message, type = 'default') => {\r\n    setNotification({ message, type });\r\n    setTimeout(() => setNotification(null), 3000);\r\n  };\r\n\r\n  // Helper for View Rendering\r\n  const renderView = () => {\r\n    switch (currentView) {\r\n      case 'home':\r\n        return <Hero setView={setCurrentView} handleLogin={handleLogin} user={user} />;\r\n      case 'browse':\r\n        return <Browse books={books} loading={loading} user={user} handleExchange={handleExchange} handleChat={handleChat} favorites={favorites} onToggleFavorite={handleToggleFavorite} />;\r\n      case 'favorites':\r\n        return user ? <Favorites books={books} loading={loading} user={user} handleExchange={handleExchange} handleChat={handleChat} favorites={favorites} onToggleFavorite={handleToggleFavorite} /> : <Hero setView={setCurrentView} handleLogin={handleLogin} user={user} />;\r\n      case 'add':\r\n        return user ? <AddBook setView={setCurrentView} user={user} token={token} /> : <Hero setView={setCurrentView} handleLogin={handleLogin} user={user} />;\r\n      case 'signin':\r\n        return <SignIn onLogin={doLogin} onSwitch={() => setCurrentView('signup')} />;\r\n      case 'signup':\r\n        return <SignUp onSignup={doSignup} onSwitch={() => setCurrentView('signin')} />;\r\n      case 'chat':\r\n        return <Chat user={user} token={token} conversationId={conversationId} onSelectConversation={id => { setConversationId(id); setCurrentView('chat'); }} onLeave={() => { setConversationId(null); setCurrentView('chat'); }} />;\r\n      case 'exchanges':\r\n        return <Exchanges user={user} token={token} exchanges={exchanges} refresh={fetchExchanges} onOpenConversation={(id)=>{ setConversationId(id); setCurrentView('chat'); }} />;\r\n      case 'profile':\r\n        return <Profile user={user} onUpdate={(u)=>{ setUser(u); localStorage.setItem('be_user', JSON.stringify(u)); }} token={token} />;\r\n      default:\r\n        return <Hero setView={setCurrentView} handleLogin={handleLogin} user={user} />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen pb-10 fancy-app\">\r\n      <div className=\"bg-blob\"></div>\r\n      <Navbar \r\n        user={user} \r\n        setView={setCurrentView} \r\n        currentView={currentView}\r\n        handleLogin={handleLogin}\r\n        handleLogout={handleLogout}\r\n      />\r\n      \r\n      {/* Notification Toast */}\r\n      {notification && (\r\n        <div className={`fixed top-20 right-4 z-50 px-6 py-3 rounded-lg shadow-xl border animate-fade-in-down ${\r\n          notification.type === 'success' ? 'bg-emerald-100 border-emerald-200 text-emerald-800' :\r\n          notification.type === 'error' ? 'bg-red-100 border-red-200 text-red-800' :\r\n          'bg-gray-800 text-white'\r\n        }`}>\r\n          {notification.message}\r\n        </div>\r\n      )}\r\n\r\n      <main>\r\n        {renderView()}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Auth / Chat / Profile UI Components ---\r\n\r\nfunction SignIn({ onLogin, onSwitch }) {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  return (\r\n    <div className=\"max-w-md mx-auto px-4 py-12\">\r\n      <div className=\"bg-white p-8 rounded shadow\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Sign In</h2>\r\n        <input className=\"w-full mb-2 p-2 border rounded\" placeholder=\"Email\" value={email} onChange={e=>setEmail(e.target.value)} />\r\n        <input type=\"password\" className=\"w-full mb-4 p-2 border rounded\" placeholder=\"Password\" value={password} onChange={e=>setPassword(e.target.value)} />\r\n        <div className=\"flex gap-2\">\r\n          <button onClick={()=>onLogin(email,password)} className=\"bg-emerald-600 text-white px-4 py-2 rounded\">Sign In</button>\r\n          <button onClick={onSwitch} className=\"px-4 py-2 border rounded\">Create Account</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SignUp({ onSignup, onSwitch }) {\r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  return (\r\n    <div className=\"max-w-md mx-auto px-4 py-12\">\r\n      <div className=\"bg-white p-8 rounded shadow\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Create Account</h2>\r\n        <input className=\"w-full mb-2 p-2 border rounded\" placeholder=\"Name\" value={name} onChange={e=>setName(e.target.value)} />\r\n        <input className=\"w-full mb-2 p-2 border rounded\" placeholder=\"Email\" value={email} onChange={e=>setEmail(e.target.value)} />\r\n        <input type=\"password\" className=\"w-full mb-4 p-2 border rounded\" placeholder=\"Password\" value={password} onChange={e=>setPassword(e.target.value)} />\r\n        <div className=\"flex gap-2\">\r\n          <button onClick={()=>onSignup(name,email,password)} className=\"bg-emerald-600 text-white px-4 py-2 rounded\">Sign Up</button>\r\n          <button onClick={onSwitch} className=\"px-4 py-2 border rounded\">Sign In</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nimport { io as ioClient } from 'socket.io-client';\r\n\r\nfunction Chat({ user, token, conversationId, onSelectConversation, onLeave }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [text, setText] = useState('');\r\n  const [conversations, setConversations] = useState([]);\r\n  const socketRef = React.useRef(null);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load(){\r\n      // Only load messages if a conversation is open\r\n      if (conversationId) {\r\n        const res = await fetch(`/api/conversations/${conversationId}/messages`, { headers: { Authorization: token ? `Bearer ${token}` : '' } });\r\n        const data = await res.json();\r\n        if(mounted) setMessages(data || []);\r\n      }\r\n    }\r\n    async function loadConvs(){\r\n      if (!token) return;\r\n      const r = await fetch('/api/conversations', { headers: { Authorization: `Bearer ${token}` } });\r\n      const d = await r.json();\r\n      setConversations(d || []);\r\n    }\r\n    load();\r\n    loadConvs();\r\n\r\n    // connect socket\r\n    socketRef.current = ioClient(window.location.origin.replace(/:\\d+$/,'') + ':5000');\r\n    // identify the socket with token so server can join user-specific room\r\n    if (token) {\r\n      socketRef.current.emit('identify', token);\r\n    }\r\n    socketRef.current.on('conversationMessage', (msg) => {\r\n      // only append if it belongs to our open conversation\r\n      if (conversationId && msg.conversationId === conversationId) setMessages(prev => [...prev, msg]);\r\n      // if not open, update conversation list (unread handled server-side)\r\n      if (!conversationId) loadConvs();\r\n    });\r\n    // exchange notifications\r\n    socketRef.current.on('exchangeRequest', (ex) => {\r\n      showNotification('New exchange request', 'default');\r\n      fetchExchanges();\r\n      loadConvs();\r\n    });\r\n    socketRef.current.on('exchangeAccepted', (ex) => {\r\n      showNotification('An exchange was accepted', 'success');\r\n      fetchExchanges();\r\n      fetchBooks();\r\n    });\r\n    socketRef.current.on('exchangeDeclined', (ex) => {\r\n      showNotification('An exchange was declined', 'error');\r\n      fetchExchanges();\r\n    });\r\n\r\n    return ()=>{ mounted=false; if(socketRef.current) socketRef.current.disconnect(); };\r\n  }, [conversationId, token]);\r\n\r\n  useEffect(() => {\r\n    // when conversationId changes, join/leave socket room\r\n    if (!socketRef.current) return;\r\n    if (conversationId) {\r\n      socketRef.current.emit('joinConversation', conversationId);\r\n      // mark read on server\r\n      if (token) fetch(`/api/conversations/${conversationId}/read`, { method: 'PUT', headers: { Authorization: `Bearer ${token}` } }).catch(()=>{});\r\n    }\r\n    return () => {\r\n      if (conversationId) socketRef.current.emit('leaveConversation', conversationId);\r\n    };\r\n  }, [conversationId]);\r\n\r\n  const send = async () => {\r\n    if (!text.trim()) return;\r\n    try {\r\n      if (conversationId) {\r\n        // send via socket to conversation room\r\n        if (socketRef.current && socketRef.current.connected) {\r\n          socketRef.current.emit('sendConversationMessage', { token, text, conversationId });\r\n        } else {\r\n          await fetch(`/api/conversations/${conversationId}/messages`, { method: 'POST', headers: { 'Content-Type':'application/json', Authorization: token ? `Bearer ${token}` : '' }, body: JSON.stringify({ text }) });\r\n        }\r\n      }\r\n      setText('');\r\n    } catch (e) { console.error(e); }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto px-4 py-8\">\r\n      <div className=\"mb-4 flex items-center justify-between\">\r\n        <h2 className=\"text-xl font-bold\">Chat</h2>\r\n        {conversationId ? <button onClick={() => { if (onLeave) onLeave(); }} className=\"text-sm text-gray-600\">Leave</button> : null}\r\n      </div>\r\n\r\n      {!conversationId && (\r\n        <div className=\"mb-4\">\r\n          <h3 className=\"font-semibold mb-2\">Your Conversations</h3>\r\n          {conversations.length === 0 ? <div className=\"text-sm text-gray-500\">No conversations yet. Request a book to start a private chat.</div> : (\r\n            <div className=\"space-y-2\">\r\n              {conversations.map(c => (\r\n                <button key={c.id} onClick={() => onSelectConversation && onSelectConversation(c.id)} className=\"w-full text-left p-3 border rounded hover:bg-gray-50 flex items-center justify-between\">\r\n                  <div className=\"text-left\">\r\n                    <div className=\"text-sm font-medium\">Conversation about {c.bookId ? `book:${c.bookId}` : 'general'}</div>\r\n                    <div className=\"text-xs text-gray-500\">With: { (c.participantsInfo || c.participants).map(p => p.name || p).filter(Boolean).join(', ') }</div>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-3\">\r\n                    {c.unreadCount ? <div className=\"bg-emerald-600 text-white text-xs px-2 py-1 rounded-full\">{c.unreadCount}</div> : null}\r\n                    <ArrowRight className=\"w-4 h-4 text-gray-400\" />\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"chat-glass p-4 rounded shadow h-[55vh] flex flex-col\">\r\n        <div className=\"flex-1 overflow-auto mb-4\">\r\n          {messages.map(m => (\r\n            <div key={m.id} className=\"mb-3\">\r\n              <div className=\"text-xs text-gray-500\">{m.fromName || m.from}  {new Date(m.createdAt).toLocaleTimeString()}</div>\r\n              <div className=\"bg-gray-100 inline-block p-2 rounded mt-1\">{m.text}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <input value={text} onChange={e=>setText(e.target.value)} className=\"flex-1 p-2 border rounded\" placeholder={user && conversationId ? 'Message the other participant...' : 'Select a conversation to start messaging'} disabled={!user || !conversationId} />\r\n          <button onClick={send} className=\"bg-emerald-600 text-white px-4 py-2 rounded\" disabled={!user || !conversationId}>Send</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Profile({ user, onUpdate, token }) {\r\n  const [name, setName] = useState(user?.name || '');\r\n  const [bio, setBio] = useState(user?.bio || '');\r\n  const save = async () => {\r\n    try {\r\n      if (!token) return;\r\n      const res = await fetch(`/api/users/${user.id}`, { method: 'PUT', headers: { 'Content-Type':'application/json', Authorization: `Bearer ${token}` }, body: JSON.stringify({ name, bio }) });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        onUpdate(data);\r\n        showNotification('Profile updated', 'success');\r\n      } else {\r\n        showNotification(data.error || 'Failed to update profile', 'error');\r\n      }\r\n    } catch (e) { console.error(e); showNotification('Failed to update profile', 'error'); }\r\n  };\r\n  return (\r\n    <div className=\"max-w-md mx-auto px-4 py-12\">\r\n      <div className=\"bg-white p-8 rounded shadow\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Profile</h2>\r\n        <input className=\"w-full mb-2 p-2 border rounded\" value={name} onChange={e=>setName(e.target.value)} />\r\n        <textarea className=\"w-full mb-2 p-2 border rounded\" value={bio} onChange={e=>setBio(e.target.value)} />\r\n        <div className=\"flex gap-2\">\r\n          <button onClick={save} className=\"bg-emerald-600 text-white px-4 py-2 rounded\">Save</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Exchanges({ user, token, exchanges, refresh, onOpenConversation }) {\r\n  const accept = async (id) => {\r\n    if (!token) return;\r\n    try {\r\n      const r = await fetch(`/api/exchanges/${id}/accept`, { method: 'PUT', headers: { Authorization: `Bearer ${token}` } });\r\n      const d = await r.json();\r\n      if (r.ok) { refresh(); alert('Exchange accepted'); }\r\n      else alert(d.error || 'Failed');\r\n    } catch (e) { console.error(e); alert('Failed'); }\r\n  };\r\n  const decline = async (id) => {\r\n    if (!token) return;\r\n    try {\r\n      const r = await fetch(`/api/exchanges/${id}/decline`, { method: 'PUT', headers: { Authorization: `Bearer ${token}` } });\r\n      const d = await r.json();\r\n      if (r.ok) { refresh(); alert('Exchange declined'); }\r\n      else alert(d.error || 'Failed');\r\n    } catch (e) { console.error(e); alert('Failed'); }\r\n  };\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto px-4 py-8\">\r\n      <h2 className=\"text-2xl font-bold mb-4\">Exchange Requests</h2>\r\n      {exchanges.length === 0 ? <div className=\"text-gray-500\">No exchange activity.</div> : (\r\n        <div className=\"space-y-4\">\r\n          {exchanges.map(e => (\r\n            <div key={e.id} className=\"bg-white border p-4 rounded flex justify-between items-start\">\r\n              <div>\r\n                <div className=\"text-sm text-gray-500\">Book: {e.bookId}</div>\r\n                <div className=\"font-medium\">From: {e.requesterId}  Status: <span className=\"font-semibold\">{e.status}</span></div>\r\n                <div className=\"text-sm text-gray-600 mt-2\">{e.message}</div>\r\n                <div className=\"text-xs text-gray-400 mt-2\">Requested at: {new Date(e.createdAt).toLocaleString()}</div>\r\n              </div>\r\n              <div className=\"flex flex-col gap-2\">\r\n                {e.ownerId === user?.id && e.status === 'requested' ? (\r\n                  <>\r\n                    <button onClick={() => accept(e.id)} className=\"px-3 py-2 bg-emerald-600 text-white rounded\">Accept</button>\r\n                    <button onClick={() => decline(e.id)} className=\"px-3 py-2 border rounded\">Decline</button>\r\n                  </>\r\n                ) : null}\r\n                <button onClick={() => onOpenConversation && onOpenConversation(e.conversationId || e.conversation?.id)} className=\"px-3 py-2 bg-gray-100 rounded\">Open Chat</button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"mappings":";;;;;;;;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SACEC,IAAI,EACJC,MAAM,EACNC,UAAU,EACVC,OAAO,EACPC,IAAI,EACJC,MAAM,EACNC,SAAS,EACTC,MAAM,EACNC,KAAK,EACLC,aAAa,EACbC,UAAU,QACL,cAAc;;AAErB;AACA,MAAMC,QAAQ,GAAG,EAAE;AACnB,MAAMC,SAAS,GAAG,GAAGD,QAAQ,YAAY;;AAEzC;;AAEA,MAAME,MAAM,GAAGA,CAAC;EAAEC,IAAI;EAAEC,OAAO;EAAEC,WAAW;EAAEC,WAAW;EAAEC;AAAa,CAAC,kBACvEC,OAAA;EAAKC,SAAS,EAAC,yCAAyC;EAAAC,QAAA,eACtDF,OAAA;IAAKC,SAAS,EAAC,qDAAqD;IAAAC,QAAA,gBAClEF,OAAA;MACEC,SAAS,EAAC,kDAAkD;MAC5DE,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,MAAM,CAAE;MAAAM,QAAA,gBAE/BF,OAAA;QAAKC,SAAS,EAAC,YAAY;QAAAC,QAAA,eACzBF,OAAA,CAACnB,IAAI;UAACoB,SAAS,EAAC;QAAoB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpC,CAAC,eACNP,OAAA;QAAMC,SAAS,EAAC,WAAW;QAAAC,QAAA,EAAC;MAAQ;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxC,CAAC,eAENP,OAAA;MAAKC,SAAS,EAAC,yBAAyB;MAAAC,QAAA,gBACtCF,OAAA;QACEG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,QAAQ,CAAE;QACjCK,SAAS,EAAE,kCAAkCJ,WAAW,KAAK,QAAQ,GAAG,kBAAkB,GAAG,mCAAmC,EAAG;QAAAK,QAAA,EACpI;MAED;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACTP,OAAA;QACEG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,MAAM,CAAE;QAC/BK,SAAS,EAAE,kCAAkCJ,WAAW,KAAK,MAAM,GAAG,kBAAkB,GAAG,mCAAmC,EAAG;QAAAK,QAAA,EAClI;MAED;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACTP,OAAA;QAAQG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,WAAW,CAAE;QAACK,SAAS,EAAE,kCAAkCJ,WAAW,KAAK,WAAW,GAAG,kBAAkB,GAAG,mCAAmC,EAAG;QAAAK,QAAA,EAAC;MAAQ;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,EAEpMZ,IAAI,gBACHK,OAAA,CAAAQ,SAAA;QAAAN,QAAA,gBACEF,OAAA;UACEG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,WAAW,CAAE;UACpCK,SAAS,EAAE,0DAA0DJ,WAAW,KAAK,WAAW,GAAG,kBAAkB,GAAG,mCAAmC,EAAG;UAAAK,QAAA,gBAE9JF,OAAA,CAACX,KAAK;YAACY,SAAS,EAAC;UAAS;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,aAE/B;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACTP,OAAA;UACEG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,KAAK,CAAE;UAC9BK,SAAS,EAAE,0DAA0DJ,WAAW,KAAK,KAAK,GAAG,kBAAkB,GAAG,mCAAmC,EAAG;UAAAK,QAAA,gBAExJF,OAAA,CAACjB,UAAU;YAACkB,SAAS,EAAC;UAAS;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,YAEpC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACTP,OAAA;UAAKC,SAAS,EAAC,uCAAuC;UAAAC,QAAA,gBACpDF,OAAA;YACEG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,SAAS,CAAE;YAClCK,SAAS,EAAE,mEAAmEJ,WAAW,KAAK,SAAS,GAAG,kBAAkB,GAAG,mCAAmC,EAAG;YACrKY,KAAK,EAAC,SAAS;YAAAP,QAAA,eAEfF,OAAA;cAAKC,SAAS,EAAC,yGAAyG;cAAAC,QAAA,EACrH,CAAC,CAAAP,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEe,EAAE,KAAI,EAAE,EAAEC,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAACC,WAAW,CAAC;YAAC;cAAAR,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvC;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC,eAETP,OAAA;YAAKU,EAAE,EAAC,kBAAkB;YAACT,SAAS,EAAC,sFAAsF;YAAAC,QAAA,EAAC;UAAC;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACnIP,OAAA;YACEG,OAAO,EAAEJ,YAAa;YACtBE,SAAS,EAAC,6CAA6C;YACvDQ,KAAK,EAAC,QAAQ;YAAAP,QAAA,eAEdF,OAAA,CAACd,MAAM;cAACe,SAAS,EAAC;YAAS;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA,eACN,CAAC,gBAEHP,OAAA;QAAKC,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBACtCF,OAAA;UAAQG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,QAAQ,CAAE;UAACK,SAAS,EAAC,2CAA2C;UAAAC,QAAA,EAAC;QAAO;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAChHP,OAAA;UAAQG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,QAAQ,CAAE;UAACK,SAAS,EAAC,wDAAwD;UAAAC,QAAA,EAAC;QAAO;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC1H,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH;AAAC;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACH,CACN;AAACM,EAAA,GA1EInB,MAAM;AA4EZ,MAAMoB,IAAI,GAAGA,CAAC;EAAElB,OAAO;EAAEE,WAAW;EAAEH;AAAK,CAAC,kBAC1CK,OAAA;EAAKC,SAAS,EAAC,4DAA4D;EAAAC,QAAA,eACzEF,OAAA;IAAKC,SAAS,EAAC,+BAA+B;IAAAC,QAAA,gBAC5CF,OAAA;MAAKC,SAAS,EAAC,iJAAiJ;MAAAC,QAAA,gBAC9JF,OAAA,CAACb,SAAS;QAACc,SAAS,EAAC;MAAS;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,iCAEnC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,eACNP,OAAA;MAAIC,SAAS,EAAC,sEAAsE;MAAAC,QAAA,GAAC,eACtE,eAAAF,OAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAClBP,OAAA;QAAMC,SAAS,EAAC,6EAA6E;QAAAC,QAAA,EAAC;MAE9F;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,eACLP,OAAA;MAAGC,SAAS,EAAC,+DAA+D;MAAAC,QAAA,EAAC;IAE7E;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,eACJP,OAAA;MAAKC,SAAS,EAAC,6DAA6D;MAAAC,QAAA,gBAC1EF,OAAA;QACEG,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,QAAQ,CAAE;QACjCK,SAAS,EAAC,2BAA2B;QAAAC,QAAA,EACtC;MAED;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,EACR,CAACZ,IAAI,iBACJK,OAAA;QACEG,OAAO,EAAEL,WAAY;QACrBG,SAAS,EAAC,qEAAqE;QAAAC,QAAA,EAChF;MAED;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CACT;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAGNP,OAAA;MAAKC,SAAS,EAAC,8DAA8D;MAAAC,QAAA,gBAC3EF,OAAA;QAAAE,QAAA,gBACEF,OAAA;UAAKC,SAAS,EAAC,kCAAkC;UAAAC,QAAA,EAAC;QAAG;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eAC3DP,OAAA;UAAKC,SAAS,EAAC,4BAA4B;UAAAC,QAAA,EAAC;QAAc;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7D,CAAC,eACNP,OAAA;QAAAE,QAAA,gBACEF,OAAA;UAAKC,SAAS,EAAC,kCAAkC;UAAAC,QAAA,EAAC;QAAG;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eAC3DP,OAAA;UAAKC,SAAS,EAAC,4BAA4B;UAAAC,QAAA,EAAC;QAAa;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5D,CAAC,eACNP,OAAA;QAAAE,QAAA,gBACEF,OAAA;UAAKC,SAAS,EAAC,kCAAkC;UAAAC,QAAA,EAAC;QAAI;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eAC5DP,OAAA;UAAKC,SAAS,EAAC,4BAA4B;UAAAC,QAAA,EAAC;QAAY;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3D,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH;AAAC;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACH,CACN;AAACQ,GAAA,GAlDID,IAAI;AAoDV,MAAME,QAAQ,GAAGA,CAAC;EAAEC,IAAI;EAAEtB,IAAI;EAAEuB,cAAc;EAAEC,UAAU;EAAEC,WAAW;EAAEC;AAAiB,CAAC,KAAK;EAC9F,oBACErB,OAAA;IAAKC,SAAS,EAAC,oEAAoE;IAAAC,QAAA,gBACjFF,OAAA;MAAKC,SAAS,EAAC,2CAA2C;MAAAC,QAAA,GACvDe,IAAI,CAACK,QAAQ,gBACZtB,OAAA;QACEuB,GAAG,EAAEN,IAAI,CAACK,QAAS;QACnBE,GAAG,EAAEP,IAAI,CAACR,KAAM;QAChBR,SAAS,EAAC,0EAA0E;QACpFwB,OAAO,EAAGC,CAAC,IAAK;UACdA,CAAC,CAACC,MAAM,CAACJ,GAAG,GAAG,4FAA4F;QAC7G;MAAE;QAAAnB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,gBAEFP,OAAA;QAAKC,SAAS,EAAC,0EAA0E;QAAAC,QAAA,eACvFF,OAAA,CAACnB,IAAI;UAACoB,SAAS,EAAC;QAAW;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3B,CACN,eACDP,OAAA;QAAKC,SAAS,EAAC,oHAAoH;QAAAC,QAAA,EAChIe,IAAI,CAACW;MAAS;QAAAxB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACZ,CAAC,EACLZ,IAAI,IAAI0B,gBAAgB,iBACvBrB,OAAA;QACEG,OAAO,EAAEA,CAAA,KAAMkB,gBAAgB,CAACJ,IAAI,CAACP,EAAE,CAAE;QACzCT,SAAS,EAAC,uGAAuG;QACjHQ,KAAK,EAAEW,WAAW,GAAG,uBAAuB,GAAG,kBAAmB;QAAAlB,QAAA,eAElEF,OAAA,CAACX,KAAK;UAACY,SAAS,EAAE,WAAWmB,WAAW,GAAG,2BAA2B,GAAG,eAAe;QAAG;UAAAhB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxF,CACT;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAENP,OAAA;MAAKC,SAAS,EAAC,6BAA6B;MAAAC,QAAA,gBAC1CF,OAAA;QAAKC,SAAS,EAAC,sEAAsE;QAAAC,QAAA,EAAEe,IAAI,CAACY,KAAK,IAAI;MAAS;QAAAzB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACrHP,OAAA;QAAIC,SAAS,EAAC,oDAAoD;QAAAC,QAAA,EAAEe,IAAI,CAACR;MAAK;QAAAL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACpFP,OAAA;QAAGC,SAAS,EAAC,4BAA4B;QAAAC,QAAA,GAAC,KAAG,EAACe,IAAI,CAACa,MAAM;MAAA;QAAA1B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAE9DP,OAAA;QAAKC,SAAS,EAAC,4DAA4D;QAAAC,QAAA,gBACzEF,OAAA,CAACZ,MAAM;UAACa,SAAS,EAAC;QAAS;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAC9BP,OAAA;UAAAE,QAAA,EAAOe,IAAI,CAACc,QAAQ,IAAI;QAAQ;UAAA3B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrC,CAAC,eAENP,OAAA;QAAKC,SAAS,EAAC,wEAAwE;QAAAC,QAAA,gBACpFF,OAAA;UAAKC,SAAS,EAAC,yBAAyB;UAAAC,QAAA,gBACtCF,OAAA;YAAKC,SAAS,EAAC,8HAA8H;YAAAC,QAAA,EAC1Ie,IAAI,CAACe,OAAO,GAAGf,IAAI,CAACe,OAAO,CAACrB,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG;UAAI;YAAAR,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzD,CAAC,eACNP,OAAA;YAAMC,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACjD,CAAC,EAELZ,IAAI,IAAIA,IAAI,CAACe,EAAE,KAAKO,IAAI,CAACe,OAAO,gBAC/BhC,OAAA;UAAMC,SAAS,EAAC,sEAAsE;UAAAC,QAAA,EAAC;QAAS;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,gBAEvGP,OAAA;UAAKC,SAAS,EAAC,cAAc;UAAAC,QAAA,GAC3Be,IAAI,CAACgB,MAAM,IAAIhB,IAAI,CAACgB,MAAM,KAAK,WAAW,gBACtCjC,OAAA;YAAMC,SAAS,EAAC,YAAY;YAAAC,QAAA,EAAEe,IAAI,CAACgB;UAAM;YAAA7B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,gBAEjDP,OAAA;YACCG,OAAO,EAAEA,CAAA,KAAMe,cAAc,CAACD,IAAI,CAAE;YACpCiB,QAAQ,EAAEjB,IAAI,CAACgB,MAAM,KAAK,WAAY;YACtChC,SAAS,EAAE,YAAYgB,IAAI,CAACgB,MAAM,KAAK,WAAW,GAAG,+BAA+B,GAAG,EAAE,EAAG;YAAA/B,QAAA,EAE1Fe,IAAI,CAACgB,MAAM,KAAK,WAAW,GAAG,OAAO,GAAG;UAAS;YAAA7B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5C,CACT,eACHP,OAAA;YAAQG,OAAO,EAAEA,CAAA,KAAMgB,UAAU,IAAIA,UAAU,CAACF,IAAI,CAAE;YAAChB,SAAS,EAAC,uFAAuF;YAAAC,QAAA,gBACtJF,OAAA,CAACV,aAAa;cAACW,SAAS,EAAC;YAAS;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACrCP,OAAA;cAAAE,QAAA,EAAM;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACd,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAAC4B,GAAA,GA3EInB,QAAQ;AA6Ed,MAAMoB,MAAM,GAAGA,CAAC;EAAEC,KAAK;EAAEC,OAAO;EAAE3C,IAAI;EAAEuB,cAAc;EAAEC,UAAU;EAAEoB,SAAS;EAAElB;AAAiB,CAAC,KAAK;EAAAmB,EAAA;EACpG,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAG/D,QAAQ,CAAC,EAAE,CAAC;EAEhD,MAAMgE,aAAa,GAAGN,KAAK,CAACO,MAAM,CAAC3B,IAAI,IACrCA,IAAI,CAACR,KAAK,CAACoC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACL,UAAU,CAACI,WAAW,CAAC,CAAC,CAAC,IAC3D5B,IAAI,CAACa,MAAM,CAACe,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACL,UAAU,CAACI,WAAW,CAAC,CAAC,CAC7D,CAAC;EAED,oBACE7C,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,gBAC1CF,OAAA;MAAKC,SAAS,EAAC,sEAAsE;MAAAC,QAAA,gBACnFF,OAAA;QAAAE,QAAA,gBACEF,OAAA;UAAIC,SAAS,EAAC,kCAAkC;UAAAC,QAAA,EAAC;QAAkB;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACxEP,OAAA;UAAGC,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAC;QAA6B;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3D,CAAC,eAENP,OAAA;QAAKC,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBACtCF,OAAA,CAAClB,MAAM;UAACmB,SAAS,EAAC;QAAgE;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACrFP,OAAA;UACE+C,IAAI,EAAC,MAAM;UACXC,WAAW,EAAC,8BAA8B;UAC1C/C,SAAS,EAAC,+IAA+I;UACzJgD,KAAK,EAAER,UAAW;UAClBS,QAAQ,EAAGxB,CAAC,IAAKgB,aAAa,CAAChB,CAAC,CAACC,MAAM,CAACsB,KAAK;QAAE;UAAA7C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAEL+B,OAAO,gBACNtC,OAAA;MAAKC,SAAS,EAAC,uCAAuC;MAAAC,QAAA,eACpDF,OAAA;QAAKC,SAAS,EAAC;MAAmE;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtF,CAAC,GACJoC,aAAa,CAACQ,MAAM,KAAK,CAAC,gBAC5BnD,OAAA;MAAKC,SAAS,EAAC,+EAA+E;MAAAC,QAAA,gBAC5FF,OAAA,CAACnB,IAAI;QAACoB,SAAS,EAAC;MAAsC;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACzDP,OAAA;QAAIC,SAAS,EAAC,mCAAmC;QAAAC,QAAA,EAAC;MAAc;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACrEP,OAAA;QAAGC,SAAS,EAAC,eAAe;QAAAC,QAAA,EAAC;MAAgC;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC9D,CAAC,gBAENP,OAAA;MAAKC,SAAS,EAAC,qEAAqE;MAAAC,QAAA,EACjFyC,aAAa,CAACS,GAAG,CAACnC,IAAI,iBACrBjB,OAAA,CAACgB,QAAQ;QAAeC,IAAI,EAAEA,IAAK;QAACtB,IAAI,EAAEA,IAAK;QAACuB,cAAc,EAAEA,cAAe;QAACC,UAAU,EAAEA,UAAW;QAACC,WAAW,EAAEmB,SAAS,CAACO,QAAQ,CAAC7B,IAAI,CAACP,EAAE,CAAE;QAACW,gBAAgB,EAAEA;MAAiB,GAAtKJ,IAAI,CAACP,EAAE;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAiK,CACxL;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACiC,EAAA,CA/CIJ,MAAM;AAAAiB,GAAA,GAANjB,MAAM;AAiDZ,MAAMkB,SAAS,GAAGA,CAAC;EAAEjB,KAAK;EAAEC,OAAO;EAAE3C,IAAI;EAAEuB,cAAc;EAAEC,UAAU;EAAEoB,SAAS;EAAElB;AAAiB,CAAC,KAAK;EACvG,MAAMkC,aAAa,GAAGlB,KAAK,CAACO,MAAM,CAACY,CAAC,IAAIjB,SAAS,CAACO,QAAQ,CAACU,CAAC,CAAC9C,EAAE,CAAC,CAAC;EAEjE,oBACEV,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,gBAC1CF,OAAA;MAAKC,SAAS,EAAC,8BAA8B;MAAAC,QAAA,gBAC3CF,OAAA,CAACX,KAAK;QAACY,SAAS,EAAC;MAAmC;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACvDP,OAAA;QAAIC,SAAS,EAAC,kCAAkC;QAAAC,QAAA,EAAC;MAAY;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC/D,CAAC,EAEL+B,OAAO,gBACNtC,OAAA;MAAKC,SAAS,EAAC,uCAAuC;MAAAC,QAAA,eACpDF,OAAA;QAAKC,SAAS,EAAC;MAAmE;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtF,CAAC,GACJgD,aAAa,CAACJ,MAAM,KAAK,CAAC,gBAC5BnD,OAAA;MAAKC,SAAS,EAAC,+EAA+E;MAAAC,QAAA,gBAC5FF,OAAA,CAACX,KAAK;QAACY,SAAS,EAAC;MAAsC;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC1DP,OAAA;QAAIC,SAAS,EAAC,mCAAmC;QAAAC,QAAA,EAAC;MAAgB;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACvEP,OAAA;QAAGC,SAAS,EAAC,eAAe;QAAAC,QAAA,EAAC;MAAuC;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrE,CAAC,gBAENP,OAAA;MAAKC,SAAS,EAAC,qEAAqE;MAAAC,QAAA,EACjFqD,aAAa,CAACH,GAAG,CAACnC,IAAI,iBACrBjB,OAAA,CAACgB,QAAQ;QAAeC,IAAI,EAAEA,IAAK;QAACtB,IAAI,EAAEA,IAAK;QAACuB,cAAc,EAAEA,cAAe;QAACC,UAAU,EAAEA,UAAW;QAACC,WAAW,EAAE,IAAK;QAACC,gBAAgB,EAAEA;MAAiB,GAA/IJ,IAAI,CAACP,EAAE;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAA0I,CACjK;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACkD,GAAA,GA7BIH,SAAS;AA+Bf,MAAMI,OAAO,GAAGA,CAAC;EAAE9D,OAAO;EAAED,IAAI;EAAEgE;AAAM,CAAC,KAAK;EAAAC,GAAA;EAC5C,MAAM,CAACtB,OAAO,EAAEuB,UAAU,CAAC,GAAGlF,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACmF,QAAQ,EAAEC,WAAW,CAAC,GAAGpF,QAAQ,CAAC;IACvC8B,KAAK,EAAE,EAAE;IACTqB,MAAM,EAAE,EAAE;IACVD,KAAK,EAAE,SAAS;IAChBD,SAAS,EAAE,MAAM;IACjBG,QAAQ,EAAE,EAAE;IACZT,QAAQ,EAAE;EACZ,CAAC,CAAC;EAEF,MAAM0C,YAAY,GAAG,MAAOtC,CAAC,IAAK;IAChCA,CAAC,CAACuC,cAAc,CAAC,CAAC;IAClB,IAAI,CAACtE,IAAI,EAAE;IACXkE,UAAU,CAAC,IAAI,CAAC;IAEhB,IAAI;MACF;MACA,MAAMK,KAAK,CAACzE,SAAS,EAAE;QAAE0E,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAE,kBAAkB;UAAEC,aAAa,EAAEV,KAAK,GAAG,UAAUA,KAAK,EAAE,GAAG;QAAG,CAAC;QAAEW,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAE,GAAGV,QAAQ;UAAE9B,OAAO,EAAErC,IAAI,CAACe;QAAG,CAAC;MAAE,CAAC,CAAC;MACnMd,OAAO,CAAC,QAAQ,CAAC;IACnB,CAAC,CAAC,OAAO6E,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;MAC1CE,KAAK,CAAC,gCAAgC,CAAC;IACzC,CAAC,SAAS;MACRd,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,oBACE7D,OAAA;IAAKC,SAAS,EAAC,8BAA8B;IAAAC,QAAA,eAC3CF,OAAA;MAAKC,SAAS,EAAC,2DAA2D;MAAAC,QAAA,gBACxEF,OAAA;QAAKC,SAAS,EAAC,8BAA8B;QAAAC,QAAA,gBAC3CF,OAAA;UAAKC,SAAS,EAAC,iCAAiC;UAAAC,QAAA,eAC9CF,OAAA,CAACjB,UAAU;YAACkB,SAAS,EAAC;UAA0B;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChD,CAAC,eACNP,OAAA;UAAAE,QAAA,gBACEF,OAAA;YAAIC,SAAS,EAAC,kCAAkC;YAAAC,QAAA,EAAC;UAAW;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACjEP,OAAA;YAAGC,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAA+B;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAENP,OAAA;QAAM4E,QAAQ,EAAEZ,YAAa;QAAC/D,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACjDF,OAAA;UAAKC,SAAS,EAAC,uCAAuC;UAAAC,QAAA,gBACpDF,OAAA;YAAKC,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxBF,OAAA;cAAOC,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAU;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACzEP,OAAA;cACE6E,QAAQ;cACR5E,SAAS,EAAC,yIAAyI;cACnJ+C,WAAW,EAAC,uBAAuB;cACnCC,KAAK,EAAEa,QAAQ,CAACrD,KAAM;cACtByC,QAAQ,EAAExB,CAAC,IAAIqC,WAAW,CAAC;gBAAC,GAAGD,QAAQ;gBAAErD,KAAK,EAAEiB,CAAC,CAACC,MAAM,CAACsB;cAAK,CAAC;YAAE;cAAA7C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC,eACNP,OAAA;YAAKC,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxBF,OAAA;cAAOC,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAM;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACrEP,OAAA;cACE6E,QAAQ;cACR5E,SAAS,EAAC,yIAAyI;cACnJ+C,WAAW,EAAC,0BAA0B;cACtCC,KAAK,EAAEa,QAAQ,CAAChC,MAAO;cACvBoB,QAAQ,EAAExB,CAAC,IAAIqC,WAAW,CAAC;gBAAC,GAAGD,QAAQ;gBAAEhC,MAAM,EAAEJ,CAAC,CAACC,MAAM,CAACsB;cAAK,CAAC;YAAE;cAAA7C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAENP,OAAA;UAAKC,SAAS,EAAC,uCAAuC;UAAAC,QAAA,gBACpDF,OAAA;YAAKC,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxBF,OAAA;cAAOC,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACpEP,OAAA;cACEC,SAAS,EAAC,kJAAkJ;cAC5JgD,KAAK,EAAEa,QAAQ,CAACjC,KAAM;cACtBqB,QAAQ,EAAExB,CAAC,IAAIqC,WAAW,CAAC;gBAAC,GAAGD,QAAQ;gBAAEjC,KAAK,EAAEH,CAAC,CAACC,MAAM,CAACsB;cAAK,CAAC,CAAE;cAAA/C,QAAA,gBAEjEF,OAAA;gBAAAE,QAAA,EAAQ;cAAO;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACxBP,OAAA;gBAAAE,QAAA,EAAQ;cAAW;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eAC5BP,OAAA;gBAAAE,QAAA,EAAQ;cAAM;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACvBP,OAAA;gBAAAE,QAAA,EAAQ;cAAO;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACxBP,OAAA;gBAAAE,QAAA,EAAQ;cAAS;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eAC1BP,OAAA;gBAAAE,QAAA,EAAQ;cAAQ;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC,eACNP,OAAA;YAAKC,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxBF,OAAA;cAAOC,SAAS,EAAC,qCAAqC;cAAAC,QAAA,EAAC;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACxEP,OAAA;cACEC,SAAS,EAAC,kJAAkJ;cAC5JgD,KAAK,EAAEa,QAAQ,CAAClC,SAAU;cAC1BsB,QAAQ,EAAExB,CAAC,IAAIqC,WAAW,CAAC;gBAAC,GAAGD,QAAQ;gBAAElC,SAAS,EAAEF,CAAC,CAACC,MAAM,CAACsB;cAAK,CAAC,CAAE;cAAA/C,QAAA,gBAErEF,OAAA;gBAAAE,QAAA,EAAQ;cAAG;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACpBP,OAAA;gBAAAE,QAAA,EAAQ;cAAQ;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACzBP,OAAA;gBAAAE,QAAA,EAAQ;cAAI;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACrBP,OAAA;gBAAAE,QAAA,EAAQ;cAAI;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACrBP,OAAA;gBAAAE,QAAA,EAAQ;cAAI;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACf,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAENP,OAAA;UAAKC,SAAS,EAAC,WAAW;UAAAC,QAAA,gBACxBF,OAAA;YAAOC,SAAS,EAAC,qCAAqC;YAAAC,QAAA,EAAC;UAAe;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC9EP,OAAA;YACE+C,IAAI,EAAC,KAAK;YACV9C,SAAS,EAAC,yIAAyI;YACnJ+C,WAAW,EAAC,+BAA+B;YAC3CC,KAAK,EAAEa,QAAQ,CAACxC,QAAS;YACzB4B,QAAQ,EAAExB,CAAC,IAAIqC,WAAW,CAAC;cAAC,GAAGD,QAAQ;cAAExC,QAAQ,EAAEI,CAAC,CAACC,MAAM,CAACsB;YAAK,CAAC;UAAE;YAAA7C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrE,CAAC,eACFP,OAAA;YAAGC,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAkE;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxG,CAAC,eAENP,OAAA;UAAKC,SAAS,EAAC,WAAW;UAAAC,QAAA,gBACxBF,OAAA;YAAOC,SAAS,EAAC,qCAAqC;YAAAC,QAAA,EAAC;UAAa;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC5EP,OAAA;YACE6E,QAAQ;YACR5E,SAAS,EAAC,yIAAyI;YACnJ+C,WAAW,EAAC,mBAAmB;YAC/BC,KAAK,EAAEa,QAAQ,CAAC/B,QAAS;YACzBmB,QAAQ,EAAExB,CAAC,IAAIqC,WAAW,CAAC;cAAC,GAAGD,QAAQ;cAAE/B,QAAQ,EAAEL,CAAC,CAACC,MAAM,CAACsB;YAAK,CAAC;UAAE;YAAA7C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENP,OAAA;UAAKC,SAAS,EAAC,iBAAiB;UAAAC,QAAA,gBAC9BF,OAAA;YACE+C,IAAI,EAAC,QAAQ;YACb5C,OAAO,EAAEA,CAAA,KAAMP,OAAO,CAAC,QAAQ,CAAE;YACjCK,SAAS,EAAC,4GAA4G;YAAAC,QAAA,EACvH;UAED;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACTP,OAAA;YACE+C,IAAI,EAAC,QAAQ;YACbb,QAAQ,EAAEI,OAAQ;YAClBrC,SAAS,EAAC,mKAAmK;YAAAC,QAAA,EAE5KoC,OAAO,gBAAGtC,OAAA;cAAMC,SAAS,EAAC;YAA2D;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,GAAG;UAAW;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;;AAED;AAAAqD,GAAA,CA9IMF,OAAO;AAAAoB,GAAA,GAAPpB,OAAO;AAgJb,eAAe,SAASqB,GAAGA,CAAA,EAAG;EAAAC,GAAA;EAC5B,MAAM,CAACrF,IAAI,EAAEsF,OAAO,CAAC,GAAGtG,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAAC0D,KAAK,EAAE6C,QAAQ,CAAC,GAAGvG,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAAC2D,OAAO,EAAEuB,UAAU,CAAC,GAAGlF,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACkB,WAAW,EAAEsF,cAAc,CAAC,GAAGxG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;EACxD,MAAM,CAACyG,YAAY,EAAEC,eAAe,CAAC,GAAG1G,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACgF,KAAK,EAAE2B,QAAQ,CAAC,GAAG3G,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAAC4G,cAAc,EAAEC,iBAAiB,CAAC,GAAG7G,QAAQ,CAAC,IAAI,CAAC;EAC1D,MAAM,CAAC8G,SAAS,EAAEC,YAAY,CAAC,GAAG/G,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACgH,WAAW,EAAEC,cAAc,CAAC,GAAGjH,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAAC4D,SAAS,EAAEsD,YAAY,CAAC,GAAGlH,QAAQ,CAAC,EAAE,CAAC;EAE9C,MAAMmH,QAAQ,GAAGA,CAACC,GAAG,EAAEC,IAAI,GAAG,CAAC,CAAC,KAAK;IACnC,MAAM5B,OAAO,GAAG4B,IAAI,CAAC5B,OAAO,IAAI,CAAC,CAAC;IAClC,IAAIT,KAAK,EAAES,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUT,KAAK,EAAE;IACvD,OAAOO,KAAK,CAAC6B,GAAG,EAAE;MAAE,GAAGC,IAAI;MAAE5B;IAAQ,CAAC,CAAC;EACzC,CAAC;;EAED;EACAxF,SAAS,CAAC,MAAM;IACd,MAAMqH,CAAC,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IAC1C,MAAMC,CAAC,GAAGF,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IACzC,IAAIF,CAAC,EAAEX,QAAQ,CAACW,CAAC,CAAC;IAClB,IAAIG,CAAC,EAAEnB,OAAO,CAACV,IAAI,CAAC8B,KAAK,CAACD,CAAC,CAAC,CAAC;IAC7B;IACA,IAAIH,CAAC,EAAE;MACL/B,KAAK,CAAC,SAAS,EAAE;QAAEE,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAU4B,CAAC;QAAG;MAAE,CAAC,CAAC,CAC5DK,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CACnBF,IAAI,CAACG,IAAI,IAAI;QAAE,IAAI,CAACA,IAAI,CAAChC,KAAK,EAAE;UAAEQ,OAAO,CAACwB,IAAI,CAAC;UAAEP,YAAY,CAACQ,OAAO,CAAC,SAAS,EAAEnC,IAAI,CAACC,SAAS,CAACiC,IAAI,CAAC,CAAC;QAAE,CAAC,MAAM;UAAEP,YAAY,CAACS,UAAU,CAAC,UAAU,CAAC;UAAET,YAAY,CAACS,UAAU,CAAC,SAAS,CAAC;UAAErB,QAAQ,CAAC,IAAI,CAAC;UAAEL,OAAO,CAAC,IAAI,CAAC;QAAE;MAAE,CAAC,CAAC,CAC7N2B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;IACpB;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7BhD,UAAU,CAAC,IAAI,CAAC;IAChB,IAAI;MACF,MAAMiD,GAAG,GAAG,MAAM5C,KAAK,CAACzE,SAAS,CAAC;MAClC,MAAMgH,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7BtB,QAAQ,CAACuB,IAAI,IAAI,EAAE,CAAC;IACtB,CAAC,CAAC,OAAOM,GAAG,EAAE;MACZrC,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEsC,GAAG,CAAC;IACzC,CAAC,SAAS;MACRlD,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,MAAMmD,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI,CAACrD,KAAK,EAAE,OAAO+B,YAAY,CAAC,EAAE,CAAC;IACnC,IAAI;MACF,MAAMoB,GAAG,GAAG,MAAMhB,QAAQ,CAAC,gBAAgB,CAAC;MAC5C,MAAMW,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7Bd,YAAY,CAACe,IAAI,IAAI,EAAE,CAAC;IAC1B,CAAC,CAAC,OAAO/E,CAAC,EAAE;MAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;IAAE;EAClC,CAAC;EAED,MAAMuF,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI,CAACtD,KAAK,EAAE,OAAOkC,YAAY,CAAC,EAAE,CAAC;IACnC,IAAI;MACF,MAAMiB,GAAG,GAAG,MAAMhB,QAAQ,CAAC,sBAAsB,CAAC;MAClD,MAAMW,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAIC,IAAI,IAAI,CAACA,IAAI,CAAChC,KAAK,EAAE;QACvBoB,YAAY,CAACY,IAAI,CAACrD,GAAG,CAACI,CAAC,IAAIA,CAAC,CAAC9C,EAAE,CAAC,IAAI,EAAE,CAAC;MACzC;IACF,CAAC,CAAC,OAAOgB,CAAC,EAAE;MAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;IAAE;EAClC,CAAC;EAED,MAAMwF,oBAAoB,GAAG,MAAOC,MAAM,IAAK;IAC7C,IAAI,CAACxD,KAAK,EAAE;IACZ,IAAI;MACF,MAAMmD,GAAG,GAAG,MAAMhB,QAAQ,CAAC,qBAAqB,EAAE;QAAE3B,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAAEE,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAE2C;QAAO,CAAC;MAAE,CAAC,CAAC;MACxJ,MAAMV,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAIC,IAAI,CAAClE,SAAS,EAAE;QAClBsD,YAAY,CAACY,IAAI,CAAClE,SAAS,CAAC;QAC5B,MAAM6E,KAAK,GAAGX,IAAI,CAAClE,SAAS,CAACO,QAAQ,CAACqE,MAAM,CAAC;QAC7CE,gBAAgB,CAACD,KAAK,GAAG,oBAAoB,GAAG,wBAAwB,EAAE,SAAS,CAAC;MACtF;IACF,CAAC,CAAC,OAAO1F,CAAC,EAAE;MACVgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;MAChB2F,gBAAgB,CAAC,2BAA2B,EAAE,OAAO,CAAC;IACxD;EACF,CAAC;EAEDzI,SAAS,CAAC,MAAM;IAAEiI,UAAU,CAAC,CAAC;EAAE,CAAC,EAAE,EAAE,CAAC;EACtCjI,SAAS,CAAC,MAAM;IAAEoI,cAAc,CAAC,CAAC;EAAE,CAAC,EAAE,CAACrD,KAAK,CAAC,CAAC;EAC/C/E,SAAS,CAAC,MAAM;IAAEqI,cAAc,CAAC,CAAC;EAAE,CAAC,EAAE,CAACtD,KAAK,CAAC,CAAC;EAC/C/E,SAAS,CAAC,MAAM;IACd;IACA,eAAe0I,OAAOA,CAAA,EAAG;MACvB,IAAI,CAAC3D,KAAK,EAAE,OAAOiC,cAAc,CAAC,CAAC,CAAC;MACpC,IAAI;QACF,MAAMW,CAAC,GAAG,MAAMrC,KAAK,CAAC,oBAAoB,EAAE;UAAEE,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUV,KAAK;UAAG;QAAE,CAAC,CAAC;QAC9F,MAAM4D,CAAC,GAAG,MAAMhB,CAAC,CAACC,IAAI,CAAC,CAAC;QACxB,MAAMgB,KAAK,GAAG,CAACD,CAAC,IAAI,EAAE,EAAEE,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,IAAIC,CAAC,CAACC,WAAW,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;QACrEhC,cAAc,CAAC4B,KAAK,CAAC;QACrB;QACA,MAAMK,KAAK,GAAGC,QAAQ,CAACC,cAAc,CAAC,kBAAkB,CAAC;QACzD,IAAIF,KAAK,EAAE;UACT,IAAIL,KAAK,GAAG,CAAC,EAAE;YAAEK,KAAK,CAACG,WAAW,GAAGR,KAAK;YAAEK,KAAK,CAACI,SAAS,CAACC,MAAM,CAAC,QAAQ,CAAC;UAAE,CAAC,MAC1E;YAAEL,KAAK,CAACI,SAAS,CAACE,GAAG,CAAC,QAAQ,CAAC;UAAE;QACxC;MACF,CAAC,CAAC,OAAOzG,CAAC,EAAE;QAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;MAAE;IAClC;IACA4F,OAAO,CAAC,CAAC;EACX,CAAC,EAAE,CAAC3D,KAAK,EAAE4B,cAAc,CAAC,CAAC;;EAE3B;EACA,MAAMzF,WAAW,GAAGA,CAAA,KAAMqF,cAAc,CAAC,QAAQ,CAAC;EAElD,MAAMiD,QAAQ,GAAG,MAAAA,CAAOC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,KAAK;IAChD,IAAI;MACF,MAAMzB,GAAG,GAAG,MAAM5C,KAAK,CAAC,aAAa,EAAE;QAAEC,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAAEE,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAE6D,IAAI;UAAEC,KAAK;UAAEC;QAAS,CAAC;MAAE,CAAC,CAAC;MAC5J,MAAM9B,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAIC,IAAI,CAAC9C,KAAK,EAAE;QACduC,YAAY,CAACQ,OAAO,CAAC,UAAU,EAAED,IAAI,CAAC9C,KAAK,CAAC;QAC5CuC,YAAY,CAACQ,OAAO,CAAC,SAAS,EAAEnC,IAAI,CAACC,SAAS,CAACiC,IAAI,CAAC9G,IAAI,CAAC,CAAC;QAC1D2F,QAAQ,CAACmB,IAAI,CAAC9C,KAAK,CAAC;QACpBsB,OAAO,CAACwB,IAAI,CAAC9G,IAAI,CAAC;QAClBwF,cAAc,CAAC,QAAQ,CAAC;QACxBkC,gBAAgB,CAAC,iBAAiB,EAAE,SAAS,CAAC;MAChD,CAAC,MAAM;QACLA,gBAAgB,CAACZ,IAAI,CAAChC,KAAK,IAAI,eAAe,EAAE,OAAO,CAAC;MAC1D;IACF,CAAC,CAAC,OAAOsC,GAAG,EAAE;MAAEM,gBAAgB,CAAC,eAAe,EAAE,OAAO,CAAC;IAAE;EAC9D,CAAC;EAED,MAAMmB,OAAO,GAAG,MAAAA,CAAOF,KAAK,EAAEC,QAAQ,KAAK;IACzC,IAAI;MACF,MAAMzB,GAAG,GAAG,MAAM5C,KAAK,CAAC,YAAY,EAAE;QAAEC,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAAEE,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAE8D,KAAK;UAAEC;QAAS,CAAC;MAAE,CAAC,CAAC;MACrJ,MAAM9B,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAIC,IAAI,CAAC9C,KAAK,EAAE;QACduC,YAAY,CAACQ,OAAO,CAAC,UAAU,EAAED,IAAI,CAAC9C,KAAK,CAAC;QAC5CuC,YAAY,CAACQ,OAAO,CAAC,SAAS,EAAEnC,IAAI,CAACC,SAAS,CAACiC,IAAI,CAAC9G,IAAI,CAAC,CAAC;QAC1D2F,QAAQ,CAACmB,IAAI,CAAC9C,KAAK,CAAC;QACpBsB,OAAO,CAACwB,IAAI,CAAC9G,IAAI,CAAC;QAClBwF,cAAc,CAAC,QAAQ,CAAC;QACxBkC,gBAAgB,CAAC,WAAW,EAAE,SAAS,CAAC;MAC1C,CAAC,MAAM;QACLA,gBAAgB,CAACZ,IAAI,CAAChC,KAAK,IAAI,cAAc,EAAE,OAAO,CAAC;MACzD;IACF,CAAC,CAAC,OAAOsC,GAAG,EAAE;MAAEM,gBAAgB,CAAC,cAAc,EAAE,OAAO,CAAC;IAAE;EAC7D,CAAC;EAED,MAAMtH,YAAY,GAAGA,CAAA,KAAM;IACzBmG,YAAY,CAACS,UAAU,CAAC,SAAS,CAAC;IAClCT,YAAY,CAACS,UAAU,CAAC,UAAU,CAAC;IACnC1B,OAAO,CAAC,IAAI,CAAC;IACbK,QAAQ,CAAC,IAAI,CAAC;IACdH,cAAc,CAAC,MAAM,CAAC;IACtBkC,gBAAgB,CAAC,YAAY,EAAE,SAAS,CAAC;EAC3C,CAAC;EAED,MAAMnG,cAAc,GAAG,MAAOD,IAAI,IAAK;IACrC,IAAI,CAACtB,IAAI,EAAE;MAAE0H,gBAAgB,CAAC,kCAAkC,EAAE,OAAO,CAAC;MAAE;IAAQ;IACpF,IAAI,CAACoB,OAAO,CAAC,wBAAwBxH,IAAI,CAACR,KAAK,IAAI,CAAC,EAAE;IACtD,IAAI;MAAA,IAAAiI,kBAAA;MACF;MACA,MAAM5B,GAAG,GAAG,MAAMhB,QAAQ,CAAC,gBAAgB,EAAE;QAAE3B,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAC;QAAmB,CAAC;QAAEE,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAE2C,MAAM,EAAElG,IAAI,CAACP,EAAE;UAAEiI,OAAO,EAAE,uBAAuB1H,IAAI,CAACR,KAAK;QAAG,CAAC;MAAE,CAAC,CAAC;MACzM,MAAMgG,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAI,CAACM,GAAG,CAAC8B,EAAE,EAAE,MAAM,IAAIC,KAAK,CAACpC,IAAI,CAAChC,KAAK,IAAI,2BAA2B,CAAC;MACvE,MAAMqE,IAAI,GAAGrC,IAAI,CAACsC,YAAY,IAAItC,IAAI,CAAClB,cAAc,MAAAmD,kBAAA,GAAIjC,IAAI,CAACsC,YAAY,cAAAL,kBAAA,uBAAjBA,kBAAA,CAAmBhI,EAAE,MAAK+F,IAAI,CAACsC,YAAY,IAAItC,IAAI,CAACsC,YAAY,CAACrI,EAAE,GAAG+F,IAAI,CAACsC,YAAY,GAAG,IAAI,CAAC;MACxJ,IAAID,IAAI,IAAIA,IAAI,CAACpI,EAAE,EAAE;QACnB8E,iBAAiB,CAACsD,IAAI,CAACpI,EAAE,CAAC;QAC1ByE,cAAc,CAAC,MAAM,CAAC;MACxB,CAAC,MAAM,IAAIsB,IAAI,CAACsC,YAAY,IAAItC,IAAI,CAACsC,YAAY,CAACrI,EAAE,EAAE;QACpD8E,iBAAiB,CAACiB,IAAI,CAACsC,YAAY,CAACrI,EAAE,CAAC;QACvCyE,cAAc,CAAC,MAAM,CAAC;MACxB;MACAkC,gBAAgB,CAAC,uCAAuC,EAAE,SAAS,CAAC;MACpER,UAAU,CAAC,CAAC;MACZG,cAAc,CAAC,CAAC;IAClB,CAAC,CAAC,OAAOD,GAAG,EAAE;MACZrC,OAAO,CAACD,KAAK,CAACsC,GAAG,CAAC;MAClBM,gBAAgB,CAAC,6BAA6B,EAAE,OAAO,CAAC;IAC1D;EACF,CAAC;EAED,MAAMlG,UAAU,GAAG,MAAOF,IAAI,IAAK;IACjC,IAAI,CAACtB,IAAI,EAAE;MAAE0H,gBAAgB,CAAC,qCAAqC,EAAE,OAAO,CAAC;MAAElC,cAAc,CAAC,QAAQ,CAAC;MAAE;IAAQ;IACjH,IAAI;MACF,MAAM2B,GAAG,GAAG,MAAMhB,QAAQ,CAAC,oBAAoB,EAAE;QAAE3B,MAAM,EAAE,MAAM;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAAEE,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEwE,WAAW,EAAE/H,IAAI,CAACe,OAAO;UAAEmF,MAAM,EAAElG,IAAI,CAACP;QAAG,CAAC;MAAE,CAAC,CAAC;MAC3L,MAAM+F,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAI,CAACM,GAAG,CAAC8B,EAAE,EAAE,MAAM,IAAIC,KAAK,CAACpC,IAAI,CAAChC,KAAK,IAAI,+BAA+B,CAAC;MAC3E,MAAMqE,IAAI,GAAGrC,IAAI,IAAI,IAAI;MACzB,IAAIqC,IAAI,IAAIA,IAAI,CAACpI,EAAE,EAAE;QACnB8E,iBAAiB,CAACsD,IAAI,CAACpI,EAAE,CAAC;QAC1ByE,cAAc,CAAC,MAAM,CAAC;MACxB;MACAkC,gBAAgB,CAAC,iCAAiC,EAAE,SAAS,CAAC;IAChE,CAAC,CAAC,OAAON,GAAG,EAAE;MACZrC,OAAO,CAACD,KAAK,CAACsC,GAAG,CAAC;MAClBM,gBAAgB,CAAC,sBAAsB,EAAE,OAAO,CAAC;IACnD;EACF,CAAC;EAED,MAAMA,gBAAgB,GAAGA,CAACsB,OAAO,EAAE5F,IAAI,GAAG,SAAS,KAAK;IACtDsC,eAAe,CAAC;MAAEsD,OAAO;MAAE5F;IAAK,CAAC,CAAC;IAClCkG,UAAU,CAAC,MAAM5D,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC;EAC/C,CAAC;;EAED;EACA,MAAM6D,UAAU,GAAGA,CAAA,KAAM;IACvB,QAAQrJ,WAAW;MACjB,KAAK,MAAM;QACT,oBAAOG,OAAA,CAACc,IAAI;UAAClB,OAAO,EAAEuF,cAAe;UAACrF,WAAW,EAAEA,WAAY;UAACH,IAAI,EAAEA;QAAK;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAChF,KAAK,QAAQ;QACX,oBAAOP,OAAA,CAACoC,MAAM;UAACC,KAAK,EAAEA,KAAM;UAACC,OAAO,EAAEA,OAAQ;UAAC3C,IAAI,EAAEA,IAAK;UAACuB,cAAc,EAAEA,cAAe;UAACC,UAAU,EAAEA,UAAW;UAACoB,SAAS,EAAEA,SAAU;UAAClB,gBAAgB,EAAE6F;QAAqB;UAAA9G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MACrL,KAAK,WAAW;QACd,OAAOZ,IAAI,gBAAGK,OAAA,CAACsD,SAAS;UAACjB,KAAK,EAAEA,KAAM;UAACC,OAAO,EAAEA,OAAQ;UAAC3C,IAAI,EAAEA,IAAK;UAACuB,cAAc,EAAEA,cAAe;UAACC,UAAU,EAAEA,UAAW;UAACoB,SAAS,EAAEA,SAAU;UAAClB,gBAAgB,EAAE6F;QAAqB;UAAA9G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,gBAAGP,OAAA,CAACc,IAAI;UAAClB,OAAO,EAAEuF,cAAe;UAACrF,WAAW,EAAEA,WAAY;UAACH,IAAI,EAAEA;QAAK;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MACzQ,KAAK,KAAK;QACR,OAAOZ,IAAI,gBAAGK,OAAA,CAAC0D,OAAO;UAAC9D,OAAO,EAAEuF,cAAe;UAACxF,IAAI,EAAEA,IAAK;UAACgE,KAAK,EAAEA;QAAM;UAAAvD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,gBAAGP,OAAA,CAACc,IAAI;UAAClB,OAAO,EAAEuF,cAAe;UAACrF,WAAW,EAAEA,WAAY;UAACH,IAAI,EAAEA;QAAK;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MACxJ,KAAK,QAAQ;QACX,oBAAOP,OAAA,CAACmJ,MAAM;UAACC,OAAO,EAAEZ,OAAQ;UAACa,QAAQ,EAAEA,CAAA,KAAMlE,cAAc,CAAC,QAAQ;QAAE;UAAA/E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAC/E,KAAK,QAAQ;QACX,oBAAOP,OAAA,CAACsJ,MAAM;UAACC,QAAQ,EAAEnB,QAAS;UAACiB,QAAQ,EAAEA,CAAA,KAAMlE,cAAc,CAAC,QAAQ;QAAE;UAAA/E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MACjF,KAAK,MAAM;QACT,oBAAOP,OAAA,CAACwJ,IAAI;UAAC7J,IAAI,EAAEA,IAAK;UAACgE,KAAK,EAAEA,KAAM;UAAC4B,cAAc,EAAEA,cAAe;UAACkE,oBAAoB,EAAE/I,EAAE,IAAI;YAAE8E,iBAAiB,CAAC9E,EAAE,CAAC;YAAEyE,cAAc,CAAC,MAAM,CAAC;UAAE,CAAE;UAACuE,OAAO,EAAEA,CAAA,KAAM;YAAElE,iBAAiB,CAAC,IAAI,CAAC;YAAEL,cAAc,CAAC,MAAM,CAAC;UAAE;QAAE;UAAA/E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAChO,KAAK,WAAW;QACd,oBAAOP,OAAA,CAAC2J,SAAS;UAAChK,IAAI,EAAEA,IAAK;UAACgE,KAAK,EAAEA,KAAM;UAAC8B,SAAS,EAAEA,SAAU;UAACmE,OAAO,EAAE5C,cAAe;UAAC6C,kBAAkB,EAAGnJ,EAAE,IAAG;YAAE8E,iBAAiB,CAAC9E,EAAE,CAAC;YAAEyE,cAAc,CAAC,MAAM,CAAC;UAAE;QAAE;UAAA/E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAC7K,KAAK,SAAS;QACZ,oBAAOP,OAAA,CAAC8J,OAAO;UAACnK,IAAI,EAAEA,IAAK;UAACoK,QAAQ,EAAG3D,CAAC,IAAG;YAAEnB,OAAO,CAACmB,CAAC,CAAC;YAAEF,YAAY,CAACQ,OAAO,CAAC,SAAS,EAAEnC,IAAI,CAACC,SAAS,CAAC4B,CAAC,CAAC,CAAC;UAAE,CAAE;UAACzC,KAAK,EAAEA;QAAM;UAAAvD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAClI;QACE,oBAAOP,OAAA,CAACc,IAAI;UAAClB,OAAO,EAAEuF,cAAe;UAACrF,WAAW,EAAEA,WAAY;UAACH,IAAI,EAAEA;QAAK;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;IAClF;EACF,CAAC;EAED,oBACEP,OAAA;IAAKC,SAAS,EAAC,8BAA8B;IAAAC,QAAA,gBAC3CF,OAAA;MAAKC,SAAS,EAAC;IAAS;MAAAG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,eAC/BP,OAAA,CAACN,MAAM;MACLC,IAAI,EAAEA,IAAK;MACXC,OAAO,EAAEuF,cAAe;MACxBtF,WAAW,EAAEA,WAAY;MACzBC,WAAW,EAAEA,WAAY;MACzBC,YAAY,EAAEA;IAAa;MAAAK,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC5B,CAAC,EAGD6E,YAAY,iBACXpF,OAAA;MAAKC,SAAS,EAAE,wFACdmF,YAAY,CAACrC,IAAI,KAAK,SAAS,GAAG,oDAAoD,GACtFqC,YAAY,CAACrC,IAAI,KAAK,OAAO,GAAG,wCAAwC,GACxE,wBAAwB,EACvB;MAAA7C,QAAA,EACAkF,YAAY,CAACuD;IAAO;MAAAvI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAClB,CACN,eAEDP,OAAA;MAAAE,QAAA,EACGgJ,UAAU,CAAC;IAAC;MAAA9I,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACT,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACJ,CAAC;AAEV;;AAEA;AAAAyE,GAAA,CA/PwBD,GAAG;AAAAiF,GAAA,GAAHjF,GAAG;AAiQ3B,SAASoE,MAAMA,CAAC;EAAEC,OAAO;EAAEC;AAAS,CAAC,EAAE;EAAAY,GAAA;EACrC,MAAM,CAAC3B,KAAK,EAAE4B,QAAQ,CAAC,GAAGvL,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAAC4J,QAAQ,EAAE4B,WAAW,CAAC,GAAGxL,QAAQ,CAAC,EAAE,CAAC;EAC5C,oBACEqB,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,eAC1CF,OAAA;MAAKC,SAAS,EAAC,6BAA6B;MAAAC,QAAA,gBAC1CF,OAAA;QAAIC,SAAS,EAAC,wBAAwB;QAAAC,QAAA,EAAC;MAAO;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnDP,OAAA;QAAOC,SAAS,EAAC,gCAAgC;QAAC+C,WAAW,EAAC,OAAO;QAACC,KAAK,EAAEqF,KAAM;QAACpF,QAAQ,EAAExB,CAAC,IAAEwI,QAAQ,CAACxI,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC7HP,OAAA;QAAO+C,IAAI,EAAC,UAAU;QAAC9C,SAAS,EAAC,gCAAgC;QAAC+C,WAAW,EAAC,UAAU;QAACC,KAAK,EAAEsF,QAAS;QAACrF,QAAQ,EAAExB,CAAC,IAAEyI,WAAW,CAACzI,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACtJP,OAAA;QAAKC,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACzBF,OAAA;UAAQG,OAAO,EAAEA,CAAA,KAAIiJ,OAAO,CAACd,KAAK,EAACC,QAAQ,CAAE;UAACtI,SAAS,EAAC,6CAA6C;UAAAC,QAAA,EAAC;QAAO;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACtHP,OAAA;UAAQG,OAAO,EAAEkJ,QAAS;UAACpJ,SAAS,EAAC,0BAA0B;UAAAC,QAAA,EAAC;QAAc;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpF,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC0J,GAAA,CAhBQd,MAAM;AAAAiB,GAAA,GAANjB,MAAM;AAkBf,SAASG,MAAMA,CAAC;EAAEC,QAAQ;EAAEF;AAAS,CAAC,EAAE;EAAAgB,GAAA;EACtC,MAAM,CAAChC,IAAI,EAAEiC,OAAO,CAAC,GAAG3L,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAAC2J,KAAK,EAAE4B,QAAQ,CAAC,GAAGvL,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAAC4J,QAAQ,EAAE4B,WAAW,CAAC,GAAGxL,QAAQ,CAAC,EAAE,CAAC;EAC5C,oBACEqB,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,eAC1CF,OAAA;MAAKC,SAAS,EAAC,6BAA6B;MAAAC,QAAA,gBAC1CF,OAAA;QAAIC,SAAS,EAAC,wBAAwB;QAAAC,QAAA,EAAC;MAAc;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC1DP,OAAA;QAAOC,SAAS,EAAC,gCAAgC;QAAC+C,WAAW,EAAC,MAAM;QAACC,KAAK,EAAEoF,IAAK;QAACnF,QAAQ,EAAExB,CAAC,IAAE4I,OAAO,CAAC5I,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC1HP,OAAA;QAAOC,SAAS,EAAC,gCAAgC;QAAC+C,WAAW,EAAC,OAAO;QAACC,KAAK,EAAEqF,KAAM;QAACpF,QAAQ,EAAExB,CAAC,IAAEwI,QAAQ,CAACxI,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC7HP,OAAA;QAAO+C,IAAI,EAAC,UAAU;QAAC9C,SAAS,EAAC,gCAAgC;QAAC+C,WAAW,EAAC,UAAU;QAACC,KAAK,EAAEsF,QAAS;QAACrF,QAAQ,EAAExB,CAAC,IAAEyI,WAAW,CAACzI,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACtJP,OAAA;QAAKC,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACzBF,OAAA;UAAQG,OAAO,EAAEA,CAAA,KAAIoJ,QAAQ,CAAClB,IAAI,EAACC,KAAK,EAACC,QAAQ,CAAE;UAACtI,SAAS,EAAC,6CAA6C;UAAAC,QAAA,EAAC;QAAO;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC5HP,OAAA;UAAQG,OAAO,EAAEkJ,QAAS;UAACpJ,SAAS,EAAC,0BAA0B;UAAAC,QAAA,EAAC;QAAO;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7E,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC8J,GAAA,CAlBQf,MAAM;AAAAiB,GAAA,GAANjB,MAAM;AAoBf,SAASkB,EAAE,IAAIC,QAAQ,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAA1K,OAAA,EAAA2K,QAAA,IAAAnK,SAAA;AAElD,SAASgJ,IAAIA,CAAC;EAAE7J,IAAI;EAAEgE,KAAK;EAAE4B,cAAc;EAAEkE,oBAAoB;EAAEC;AAAQ,CAAC,EAAE;EAAAkB,GAAA;EAC5E,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGnM,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACoM,IAAI,EAAEC,OAAO,CAAC,GAAGrM,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAACsM,aAAa,EAAEC,gBAAgB,CAAC,GAAGvM,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAMwM,SAAS,GAAGzM,KAAK,CAAC0M,MAAM,CAAC,IAAI,CAAC;EAEpCxM,SAAS,CAAC,MAAM;IACd,IAAIyM,OAAO,GAAG,IAAI;IAClB,eAAeC,IAAIA,CAAA,EAAE;MACnB;MACA,IAAI/F,cAAc,EAAE;QAClB,MAAMuB,GAAG,GAAG,MAAM5C,KAAK,CAAC,sBAAsBqB,cAAc,WAAW,EAAE;UAAEnB,OAAO,EAAE;YAAEC,aAAa,EAAEV,KAAK,GAAG,UAAUA,KAAK,EAAE,GAAG;UAAG;QAAE,CAAC,CAAC;QACxI,MAAM8C,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;QAC7B,IAAG6E,OAAO,EAAEP,WAAW,CAACrE,IAAI,IAAI,EAAE,CAAC;MACrC;IACF;IACA,eAAe8E,SAASA,CAAA,EAAE;MACxB,IAAI,CAAC5H,KAAK,EAAE;MACZ,MAAM4C,CAAC,GAAG,MAAMrC,KAAK,CAAC,oBAAoB,EAAE;QAAEE,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAUV,KAAK;QAAG;MAAE,CAAC,CAAC;MAC9F,MAAM4D,CAAC,GAAG,MAAMhB,CAAC,CAACC,IAAI,CAAC,CAAC;MACxB0E,gBAAgB,CAAC3D,CAAC,IAAI,EAAE,CAAC;IAC3B;IACA+D,IAAI,CAAC,CAAC;IACNC,SAAS,CAAC,CAAC;;IAEX;IACAJ,SAAS,CAACK,OAAO,GAAGf,QAAQ,CAACgB,MAAM,CAAC1J,QAAQ,CAAC2J,MAAM,CAACC,OAAO,CAAC,OAAO,EAAC,EAAE,CAAC,GAAG,OAAO,CAAC;IAClF;IACA,IAAIhI,KAAK,EAAE;MACTwH,SAAS,CAACK,OAAO,CAACI,IAAI,CAAC,UAAU,EAAEjI,KAAK,CAAC;IAC3C;IACAwH,SAAS,CAACK,OAAO,CAACK,EAAE,CAAC,qBAAqB,EAAGC,GAAG,IAAK;MACnD;MACA,IAAIvG,cAAc,IAAIuG,GAAG,CAACvG,cAAc,KAAKA,cAAc,EAAEuF,WAAW,CAACiB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAED,GAAG,CAAC,CAAC;MAChG;MACA,IAAI,CAACvG,cAAc,EAAEgG,SAAS,CAAC,CAAC;IAClC,CAAC,CAAC;IACF;IACAJ,SAAS,CAACK,OAAO,CAACK,EAAE,CAAC,iBAAiB,EAAGG,EAAE,IAAK;MAC9C3E,gBAAgB,CAAC,sBAAsB,EAAE,SAAS,CAAC;MACnDL,cAAc,CAAC,CAAC;MAChBuE,SAAS,CAAC,CAAC;IACb,CAAC,CAAC;IACFJ,SAAS,CAACK,OAAO,CAACK,EAAE,CAAC,kBAAkB,EAAGG,EAAE,IAAK;MAC/C3E,gBAAgB,CAAC,0BAA0B,EAAE,SAAS,CAAC;MACvDL,cAAc,CAAC,CAAC;MAChBH,UAAU,CAAC,CAAC;IACd,CAAC,CAAC;IACFsE,SAAS,CAACK,OAAO,CAACK,EAAE,CAAC,kBAAkB,EAAGG,EAAE,IAAK;MAC/C3E,gBAAgB,CAAC,0BAA0B,EAAE,OAAO,CAAC;MACrDL,cAAc,CAAC,CAAC;IAClB,CAAC,CAAC;IAEF,OAAO,MAAI;MAAEqE,OAAO,GAAC,KAAK;MAAE,IAAGF,SAAS,CAACK,OAAO,EAAEL,SAAS,CAACK,OAAO,CAACS,UAAU,CAAC,CAAC;IAAE,CAAC;EACrF,CAAC,EAAE,CAAC1G,cAAc,EAAE5B,KAAK,CAAC,CAAC;EAE3B/E,SAAS,CAAC,MAAM;IACd;IACA,IAAI,CAACuM,SAAS,CAACK,OAAO,EAAE;IACxB,IAAIjG,cAAc,EAAE;MAClB4F,SAAS,CAACK,OAAO,CAACI,IAAI,CAAC,kBAAkB,EAAErG,cAAc,CAAC;MAC1D;MACA,IAAI5B,KAAK,EAAEO,KAAK,CAAC,sBAAsBqB,cAAc,OAAO,EAAE;QAAEpB,MAAM,EAAE,KAAK;QAAEC,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAUV,KAAK;QAAG;MAAE,CAAC,CAAC,CAACiD,KAAK,CAAC,MAAI,CAAC,CAAC,CAAC;IAC/I;IACA,OAAO,MAAM;MACX,IAAIrB,cAAc,EAAE4F,SAAS,CAACK,OAAO,CAACI,IAAI,CAAC,mBAAmB,EAAErG,cAAc,CAAC;IACjF,CAAC;EACH,CAAC,EAAE,CAACA,cAAc,CAAC,CAAC;EAEpB,MAAM2G,IAAI,GAAG,MAAAA,CAAA,KAAY;IACvB,IAAI,CAACnB,IAAI,CAACoB,IAAI,CAAC,CAAC,EAAE;IAClB,IAAI;MACF,IAAI5G,cAAc,EAAE;QAClB;QACA,IAAI4F,SAAS,CAACK,OAAO,IAAIL,SAAS,CAACK,OAAO,CAACY,SAAS,EAAE;UACpDjB,SAAS,CAACK,OAAO,CAACI,IAAI,CAAC,yBAAyB,EAAE;YAAEjI,KAAK;YAAEoH,IAAI;YAAExF;UAAe,CAAC,CAAC;QACpF,CAAC,MAAM;UACL,MAAMrB,KAAK,CAAC,sBAAsBqB,cAAc,WAAW,EAAE;YAAEpB,MAAM,EAAE,MAAM;YAAEC,OAAO,EAAE;cAAE,cAAc,EAAC,kBAAkB;cAAEC,aAAa,EAAEV,KAAK,GAAG,UAAUA,KAAK,EAAE,GAAG;YAAG,CAAC;YAAEW,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;cAAEuG;YAAK,CAAC;UAAE,CAAC,CAAC;QACjN;MACF;MACAC,OAAO,CAAC,EAAE,CAAC;IACb,CAAC,CAAC,OAAOtJ,CAAC,EAAE;MAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;IAAE;EAClC,CAAC;EAED,oBACE1B,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,gBAC1CF,OAAA;MAAKC,SAAS,EAAC,wCAAwC;MAAAC,QAAA,gBACrDF,OAAA;QAAIC,SAAS,EAAC,mBAAmB;QAAAC,QAAA,EAAC;MAAI;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,EAC1CgF,cAAc,gBAAGvF,OAAA;QAAQG,OAAO,EAAEA,CAAA,KAAM;UAAE,IAAIuJ,OAAO,EAAEA,OAAO,CAAC,CAAC;QAAE,CAAE;QAACzJ,SAAS,EAAC,uBAAuB;QAAAC,QAAA,EAAC;MAAK;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,GAAG,IAAI;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC1H,CAAC,EAEL,CAACgF,cAAc,iBACdvF,OAAA;MAAKC,SAAS,EAAC,MAAM;MAAAC,QAAA,gBACnBF,OAAA;QAAIC,SAAS,EAAC,oBAAoB;QAAAC,QAAA,EAAC;MAAkB;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,EACzD0K,aAAa,CAAC9H,MAAM,KAAK,CAAC,gBAAGnD,OAAA;QAAKC,SAAS,EAAC,uBAAuB;QAAAC,QAAA,EAAC;MAA6D;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,gBACtIP,OAAA;QAAKC,SAAS,EAAC,WAAW;QAAAC,QAAA,EACvB+K,aAAa,CAAC7H,GAAG,CAACuE,CAAC,iBAClB3H,OAAA;UAAmBG,OAAO,EAAEA,CAAA,KAAMsJ,oBAAoB,IAAIA,oBAAoB,CAAC9B,CAAC,CAACjH,EAAE,CAAE;UAACT,SAAS,EAAC,wFAAwF;UAAAC,QAAA,gBACtLF,OAAA;YAAKC,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxBF,OAAA;cAAKC,SAAS,EAAC,qBAAqB;cAAAC,QAAA,GAAC,qBAAmB,EAACyH,CAAC,CAACR,MAAM,GAAG,QAAQQ,CAAC,CAACR,MAAM,EAAE,GAAG,SAAS;YAAA;cAAA/G,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACzGP,OAAA;cAAKC,SAAS,EAAC,uBAAuB;cAAAC,QAAA,GAAC,QAAM,EAAE,CAACyH,CAAC,CAAC0E,gBAAgB,IAAI1E,CAAC,CAAC2E,YAAY,EAAElJ,GAAG,CAACmJ,CAAC,IAAIA,CAAC,CAAClE,IAAI,IAAIkE,CAAC,CAAC,CAAC3J,MAAM,CAAC4J,OAAO,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;YAAA;cAAArM,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3I,CAAC,eACNP,OAAA;YAAKC,SAAS,EAAC,yBAAyB;YAAAC,QAAA,GACrCyH,CAAC,CAACC,WAAW,gBAAG5H,OAAA;cAAKC,SAAS,EAAC,0DAA0D;cAAAC,QAAA,EAAEyH,CAAC,CAACC;YAAW;cAAAxH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,GAAG,IAAI,eACvHP,OAAA,CAACT,UAAU;cAACU,SAAS,EAAC;YAAuB;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7C,CAAC;QAAA,GARKoH,CAAC,CAACjH,EAAE;UAAAN,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAST,CACT;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CACN,eAEDP,OAAA;MAAKC,SAAS,EAAC,sDAAsD;MAAAC,QAAA,gBACnEF,OAAA;QAAKC,SAAS,EAAC,2BAA2B;QAAAC,QAAA,EACvC2K,QAAQ,CAACzH,GAAG,CAACsJ,CAAC,iBACb1M,OAAA;UAAgBC,SAAS,EAAC,MAAM;UAAAC,QAAA,gBAC9BF,OAAA;YAAKC,SAAS,EAAC,uBAAuB;YAAAC,QAAA,GAAEwM,CAAC,CAACC,QAAQ,IAAID,CAAC,CAACE,IAAI,EAAC,UAAG,EAAC,IAAIC,IAAI,CAACH,CAAC,CAACI,SAAS,CAAC,CAACC,kBAAkB,CAAC,CAAC;UAAA;YAAA3M,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAClHP,OAAA;YAAKC,SAAS,EAAC,2CAA2C;YAAAC,QAAA,EAAEwM,CAAC,CAAC3B;UAAI;YAAA3K,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA,GAFjEmM,CAAC,CAAChM,EAAE;UAAAN,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAGT,CACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACNP,OAAA;QAAKC,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACzBF,OAAA;UAAOiD,KAAK,EAAE8H,IAAK;UAAC7H,QAAQ,EAAExB,CAAC,IAAEsJ,OAAO,CAACtJ,CAAC,CAACC,MAAM,CAACsB,KAAK,CAAE;UAAChD,SAAS,EAAC,2BAA2B;UAAC+C,WAAW,EAAErD,IAAI,IAAI4F,cAAc,GAAG,kCAAkC,GAAG,0CAA2C;UAACrD,QAAQ,EAAE,CAACvC,IAAI,IAAI,CAAC4F;QAAe;UAAAnF,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAC7PP,OAAA;UAAQG,OAAO,EAAE+L,IAAK;UAACjM,SAAS,EAAC,6CAA6C;UAACiC,QAAQ,EAAE,CAACvC,IAAI,IAAI,CAAC4F,cAAe;UAAArF,QAAA,EAAC;QAAI;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7H,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACqK,GAAA,CAjIQpB,IAAI;AAAAwD,GAAA,GAAJxD,IAAI;AAmIb,SAASM,OAAOA,CAAC;EAAEnK,IAAI;EAAEoK,QAAQ;EAAEpG;AAAM,CAAC,EAAE;EAAAsJ,GAAA;EAC1C,MAAM,CAAC5E,IAAI,EAAEiC,OAAO,CAAC,GAAG3L,QAAQ,CAAC,CAAAgB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE0I,IAAI,KAAI,EAAE,CAAC;EAClD,MAAM,CAAC6E,GAAG,EAAEC,MAAM,CAAC,GAAGxO,QAAQ,CAAC,CAAAgB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEuN,GAAG,KAAI,EAAE,CAAC;EAC/C,MAAME,IAAI,GAAG,MAAAA,CAAA,KAAY;IACvB,IAAI;MACF,IAAI,CAACzJ,KAAK,EAAE;MACZ,MAAMmD,GAAG,GAAG,MAAM5C,KAAK,CAAC,cAAcvE,IAAI,CAACe,EAAE,EAAE,EAAE;QAAEyD,MAAM,EAAE,KAAK;QAAEC,OAAO,EAAE;UAAE,cAAc,EAAC,kBAAkB;UAAEC,aAAa,EAAE,UAAUV,KAAK;QAAG,CAAC;QAAEW,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAE6D,IAAI;UAAE6E;QAAI,CAAC;MAAE,CAAC,CAAC;MAC1L,MAAMzG,IAAI,GAAG,MAAMK,GAAG,CAACN,IAAI,CAAC,CAAC;MAC7B,IAAIM,GAAG,CAAC8B,EAAE,EAAE;QACVmB,QAAQ,CAACtD,IAAI,CAAC;QACdY,gBAAgB,CAAC,iBAAiB,EAAE,SAAS,CAAC;MAChD,CAAC,MAAM;QACLA,gBAAgB,CAACZ,IAAI,CAAChC,KAAK,IAAI,0BAA0B,EAAE,OAAO,CAAC;MACrE;IACF,CAAC,CAAC,OAAO/C,CAAC,EAAE;MAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;MAAE2F,gBAAgB,CAAC,0BAA0B,EAAE,OAAO,CAAC;IAAE;EACzF,CAAC;EACD,oBACErH,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,eAC1CF,OAAA;MAAKC,SAAS,EAAC,6BAA6B;MAAAC,QAAA,gBAC1CF,OAAA;QAAIC,SAAS,EAAC,wBAAwB;QAAAC,QAAA,EAAC;MAAO;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnDP,OAAA;QAAOC,SAAS,EAAC,gCAAgC;QAACgD,KAAK,EAAEoF,IAAK;QAACnF,QAAQ,EAAExB,CAAC,IAAE4I,OAAO,CAAC5I,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACvGP,OAAA;QAAUC,SAAS,EAAC,gCAAgC;QAACgD,KAAK,EAAEiK,GAAI;QAAChK,QAAQ,EAAExB,CAAC,IAAEyL,MAAM,CAACzL,CAAC,CAACC,MAAM,CAACsB,KAAK;MAAE;QAAA7C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACxGP,OAAA;QAAKC,SAAS,EAAC,YAAY;QAAAC,QAAA,eACzBF,OAAA;UAAQG,OAAO,EAAEiN,IAAK;UAACnN,SAAS,EAAC,6CAA6C;UAAAC,QAAA,EAAC;QAAI;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzF,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC0M,GAAA,CA5BQnD,OAAO;AAAAuD,GAAA,GAAPvD,OAAO;AA8BhB,SAASH,SAASA,CAAC;EAAEhK,IAAI;EAAEgE,KAAK;EAAE8B,SAAS;EAAEmE,OAAO;EAAEC;AAAmB,CAAC,EAAE;EAC1E,MAAMyD,MAAM,GAAG,MAAO5M,EAAE,IAAK;IAC3B,IAAI,CAACiD,KAAK,EAAE;IACZ,IAAI;MACF,MAAM4C,CAAC,GAAG,MAAMrC,KAAK,CAAC,kBAAkBxD,EAAE,SAAS,EAAE;QAAEyD,MAAM,EAAE,KAAK;QAAEC,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAUV,KAAK;QAAG;MAAE,CAAC,CAAC;MACtH,MAAM4D,CAAC,GAAG,MAAMhB,CAAC,CAACC,IAAI,CAAC,CAAC;MACxB,IAAID,CAAC,CAACqC,EAAE,EAAE;QAAEgB,OAAO,CAAC,CAAC;QAAEjF,KAAK,CAAC,mBAAmB,CAAC;MAAE,CAAC,MAC/CA,KAAK,CAAC4C,CAAC,CAAC9C,KAAK,IAAI,QAAQ,CAAC;IACjC,CAAC,CAAC,OAAO/C,CAAC,EAAE;MAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;MAAEiD,KAAK,CAAC,QAAQ,CAAC;IAAE;EACnD,CAAC;EACD,MAAM4I,OAAO,GAAG,MAAO7M,EAAE,IAAK;IAC5B,IAAI,CAACiD,KAAK,EAAE;IACZ,IAAI;MACF,MAAM4C,CAAC,GAAG,MAAMrC,KAAK,CAAC,kBAAkBxD,EAAE,UAAU,EAAE;QAAEyD,MAAM,EAAE,KAAK;QAAEC,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAUV,KAAK;QAAG;MAAE,CAAC,CAAC;MACvH,MAAM4D,CAAC,GAAG,MAAMhB,CAAC,CAACC,IAAI,CAAC,CAAC;MACxB,IAAID,CAAC,CAACqC,EAAE,EAAE;QAAEgB,OAAO,CAAC,CAAC;QAAEjF,KAAK,CAAC,mBAAmB,CAAC;MAAE,CAAC,MAC/CA,KAAK,CAAC4C,CAAC,CAAC9C,KAAK,IAAI,QAAQ,CAAC;IACjC,CAAC,CAAC,OAAO/C,CAAC,EAAE;MAAEgD,OAAO,CAACD,KAAK,CAAC/C,CAAC,CAAC;MAAEiD,KAAK,CAAC,QAAQ,CAAC;IAAE;EACnD,CAAC;EACD,oBACE3E,OAAA;IAAKC,SAAS,EAAC,6BAA6B;IAAAC,QAAA,gBAC1CF,OAAA;MAAIC,SAAS,EAAC,yBAAyB;MAAAC,QAAA,EAAC;IAAiB;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAC7DkF,SAAS,CAACtC,MAAM,KAAK,CAAC,gBAAGnD,OAAA;MAAKC,SAAS,EAAC,eAAe;MAAAC,QAAA,EAAC;IAAqB;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,gBAClFP,OAAA;MAAKC,SAAS,EAAC,WAAW;MAAAC,QAAA,EACvBuF,SAAS,CAACrC,GAAG,CAAC1B,CAAC,iBACd1B,OAAA;QAAgBC,SAAS,EAAC,8DAA8D;QAAAC,QAAA,gBACtFF,OAAA;UAAAE,QAAA,gBACEF,OAAA;YAAKC,SAAS,EAAC,uBAAuB;YAAAC,QAAA,GAAC,QAAM,EAACwB,CAAC,CAACyF,MAAM;UAAA;YAAA/G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC7DP,OAAA;YAAKC,SAAS,EAAC,aAAa;YAAAC,QAAA,GAAC,QAAM,EAACwB,CAAC,CAAC8L,WAAW,EAAC,kBAAW,eAAAxN,OAAA;cAAMC,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAEwB,CAAC,CAACO;YAAM;cAAA7B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACpHP,OAAA;YAAKC,SAAS,EAAC,4BAA4B;YAAAC,QAAA,EAAEwB,CAAC,CAACiH;UAAO;YAAAvI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC7DP,OAAA;YAAKC,SAAS,EAAC,4BAA4B;YAAAC,QAAA,GAAC,gBAAc,EAAC,IAAI2M,IAAI,CAACnL,CAAC,CAACoL,SAAS,CAAC,CAACW,cAAc,CAAC,CAAC;UAAA;YAAArN,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrG,CAAC,eACNP,OAAA;UAAKC,SAAS,EAAC,qBAAqB;UAAAC,QAAA,GACjCwB,CAAC,CAACM,OAAO,MAAKrC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEe,EAAE,KAAIgB,CAAC,CAACO,MAAM,KAAK,WAAW,gBACjDjC,OAAA,CAAAQ,SAAA;YAAAN,QAAA,gBACEF,OAAA;cAAQG,OAAO,EAAEA,CAAA,KAAMmN,MAAM,CAAC5L,CAAC,CAAChB,EAAE,CAAE;cAACT,SAAS,EAAC,6CAA6C;cAAAC,QAAA,EAAC;YAAM;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eAC5GP,OAAA;cAAQG,OAAO,EAAEA,CAAA,KAAMoN,OAAO,CAAC7L,CAAC,CAAChB,EAAE,CAAE;cAACT,SAAS,EAAC,0BAA0B;cAAAC,QAAA,EAAC;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA,eAC3F,CAAC,GACD,IAAI,eACRP,OAAA;YAAQG,OAAO,EAAEA,CAAA;cAAA,IAAAuN,eAAA;cAAA,OAAM7D,kBAAkB,IAAIA,kBAAkB,CAACnI,CAAC,CAAC6D,cAAc,MAAAmI,eAAA,GAAIhM,CAAC,CAACqH,YAAY,cAAA2E,eAAA,uBAAdA,eAAA,CAAgBhN,EAAE,EAAC;YAAA,CAAC;YAACT,SAAS,EAAC,+BAA+B;YAAAC,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClK,CAAC;MAAA,GAfEmB,CAAC,CAAChB,EAAE;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAgBT,CACN;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAACoN,IAAA,GA/CQhE,SAAS;AAAA,IAAA9I,EAAA,EAAAE,GAAA,EAAAoB,GAAA,EAAAkB,GAAA,EAAAI,GAAA,EAAAqB,GAAA,EAAAkF,GAAA,EAAAI,GAAA,EAAAG,GAAA,EAAAyC,GAAA,EAAAK,GAAA,EAAAM,IAAA;AAAAC,YAAA,CAAA/M,EAAA;AAAA+M,YAAA,CAAA7M,GAAA;AAAA6M,YAAA,CAAAzL,GAAA;AAAAyL,YAAA,CAAAvK,GAAA;AAAAuK,YAAA,CAAAnK,GAAA;AAAAmK,YAAA,CAAA9I,GAAA;AAAA8I,YAAA,CAAA5D,GAAA;AAAA4D,YAAA,CAAAxD,GAAA;AAAAwD,YAAA,CAAArD,GAAA;AAAAqD,YAAA,CAAAZ,GAAA;AAAAY,YAAA,CAAAP,GAAA;AAAAO,YAAA,CAAAD,IAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}