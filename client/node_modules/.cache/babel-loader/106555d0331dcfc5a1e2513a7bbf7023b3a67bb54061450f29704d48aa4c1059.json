{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dell\\\\Desktop\\\\pro\\\\book-exchange-app\\\\client\\\\src\\\\context\\\\AppDataContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport { booksApi, conversationsApi, exchangesApi, favoritesApi } from '../services/api';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppDataContext = /*#__PURE__*/createContext(null);\nexport const AppDataProvider = ({\n  children\n}) => {\n  _s();\n  const {\n    token,\n    user\n  } = useAuth();\n  const [books, setBooks] = useState([]);\n  const [booksStatus, setBooksStatus] = useState('idle'); // idle | loading | ready | error\n  const [favorites, setFavorites] = useState([]);\n  const [exchanges, setExchanges] = useState([]);\n  const [conversations, setConversations] = useState([]);\n  const [activeConversationId, setActiveConversationId] = useState(null);\n  const refreshBooks = useCallback(async () => {\n    setBooksStatus('loading');\n    try {\n      const data = await booksApi.list();\n      setBooks(data);\n      setBooksStatus('ready');\n      return data;\n    } catch (err) {\n      setBooksStatus('error');\n      throw err;\n    }\n  }, []);\n  const refreshFavorites = useCallback(async () => {\n    if (!token) {\n      setFavorites([]);\n      return [];\n    }\n    const data = await favoritesApi.list(token);\n    setFavorites(data.map(b => b.id));\n    return data;\n  }, [token]);\n  const refreshExchanges = useCallback(async () => {\n    if (!token) {\n      setExchanges([]);\n      return [];\n    }\n    const data = await exchangesApi.list(token);\n    setExchanges(data);\n    return data;\n  }, [token]);\n  const refreshConversations = useCallback(async () => {\n    if (!token) {\n      setConversations([]);\n      return [];\n    }\n    const data = await conversationsApi.list(token);\n    setConversations(data);\n    return data;\n  }, [token]);\n  useEffect(() => {\n    refreshBooks();\n  }, [refreshBooks]);\n  useEffect(() => {\n    refreshFavorites();\n    refreshExchanges();\n    refreshConversations();\n  }, [token, refreshFavorites, refreshExchanges, refreshConversations]);\n  const toggleFavorite = useCallback(async bookId => {\n    if (!token) throw new Error('Please sign in to save favorites.');\n    const data = await favoritesApi.toggle(bookId, token);\n    setFavorites(data.favorites || []);\n    return data.favorites || [];\n  }, [token]);\n  const value = useMemo(() => ({\n    books,\n    booksStatus,\n    refreshBooks,\n    favorites,\n    toggleFavorite,\n    exchanges,\n    refreshExchanges,\n    conversations,\n    refreshConversations,\n    activeConversationId,\n    setActiveConversationId,\n    isOwner: book => user && (book === null || book === void 0 ? void 0 : book.ownerId) === user.id\n  }), [books, booksStatus, refreshBooks, favorites, toggleFavorite, exchanges, refreshExchanges, conversations, refreshConversations, activeConversationId, user]);\n  return /*#__PURE__*/_jsxDEV(AppDataContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 10\n  }, this);\n};\n_s(AppDataProvider, \"6KDTirVaM8qTq6eJv5KcH9IkHAM=\", false, function () {\n  return [useAuth];\n});\n_c = AppDataProvider;\nexport const useAppData = () => {\n  _s2();\n  const ctx = useContext(AppDataContext);\n  if (!ctx) throw new Error('useAppData must be used within AppDataProvider');\n  return ctx;\n};\n_s2(useAppData, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nvar _c;\n$RefreshReg$(_c, \"AppDataProvider\");","map":{"version":3,"names":["createContext","useCallback","useContext","useEffect","useMemo","useState","booksApi","conversationsApi","exchangesApi","favoritesApi","useAuth","jsxDEV","_jsxDEV","AppDataContext","AppDataProvider","children","_s","token","user","books","setBooks","booksStatus","setBooksStatus","favorites","setFavorites","exchanges","setExchanges","conversations","setConversations","activeConversationId","setActiveConversationId","refreshBooks","data","list","err","refreshFavorites","map","b","id","refreshExchanges","refreshConversations","toggleFavorite","bookId","Error","toggle","value","isOwner","book","ownerId","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAppData","_s2","ctx","$RefreshReg$"],"sources":["C:/Users/dell/Desktop/pro/book-exchange-app/client/src/context/AppDataContext.js"],"sourcesContent":["import { createContext, useCallback, useContext, useEffect, useMemo, useState } from 'react';\r\nimport {\r\n  booksApi,\r\n  conversationsApi,\r\n  exchangesApi,\r\n  favoritesApi,\r\n} from '../services/api';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst AppDataContext = createContext(null);\r\n\r\nexport const AppDataProvider = ({ children }) => {\r\n  const { token, user } = useAuth();\r\n  const [books, setBooks] = useState([]);\r\n  const [booksStatus, setBooksStatus] = useState('idle'); // idle | loading | ready | error\r\n  const [favorites, setFavorites] = useState([]);\r\n  const [exchanges, setExchanges] = useState([]);\r\n  const [conversations, setConversations] = useState([]);\r\n  const [activeConversationId, setActiveConversationId] = useState(null);\r\n\r\n  const refreshBooks = useCallback(async () => {\r\n    setBooksStatus('loading');\r\n    try {\r\n      const data = await booksApi.list();\r\n      setBooks(data);\r\n      setBooksStatus('ready');\r\n      return data;\r\n    } catch (err) {\r\n      setBooksStatus('error');\r\n      throw err;\r\n    }\r\n  }, []);\r\n\r\n  const refreshFavorites = useCallback(async () => {\r\n    if (!token) {\r\n      setFavorites([]);\r\n      return [];\r\n    }\r\n    const data = await favoritesApi.list(token);\r\n    setFavorites(data.map((b) => b.id));\r\n    return data;\r\n  }, [token]);\r\n\r\n  const refreshExchanges = useCallback(async () => {\r\n    if (!token) {\r\n      setExchanges([]);\r\n      return [];\r\n    }\r\n    const data = await exchangesApi.list(token);\r\n    setExchanges(data);\r\n    return data;\r\n  }, [token]);\r\n\r\n  const refreshConversations = useCallback(async () => {\r\n    if (!token) {\r\n      setConversations([]);\r\n      return [];\r\n    }\r\n    const data = await conversationsApi.list(token);\r\n    setConversations(data);\r\n    return data;\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    refreshBooks();\r\n  }, [refreshBooks]);\r\n\r\n  useEffect(() => {\r\n    refreshFavorites();\r\n    refreshExchanges();\r\n    refreshConversations();\r\n  }, [token, refreshFavorites, refreshExchanges, refreshConversations]);\r\n\r\n  const toggleFavorite = useCallback(\r\n    async (bookId) => {\r\n      if (!token) throw new Error('Please sign in to save favorites.');\r\n      const data = await favoritesApi.toggle(bookId, token);\r\n      setFavorites(data.favorites || []);\r\n      return data.favorites || [];\r\n    },\r\n    [token]\r\n  );\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      books,\r\n      booksStatus,\r\n      refreshBooks,\r\n      favorites,\r\n      toggleFavorite,\r\n      exchanges,\r\n      refreshExchanges,\r\n      conversations,\r\n      refreshConversations,\r\n      activeConversationId,\r\n      setActiveConversationId,\r\n      isOwner: (book) => user && book?.ownerId === user.id,\r\n    }),\r\n    [\r\n      books,\r\n      booksStatus,\r\n      refreshBooks,\r\n      favorites,\r\n      toggleFavorite,\r\n      exchanges,\r\n      refreshExchanges,\r\n      conversations,\r\n      refreshConversations,\r\n      activeConversationId,\r\n      user,\r\n    ]\r\n  );\r\n\r\n  return <AppDataContext.Provider value={value}>{children}</AppDataContext.Provider>;\r\n};\r\n\r\nexport const useAppData = () => {\r\n  const ctx = useContext(AppDataContext);\r\n  if (!ctx) throw new Error('useAppData must be used within AppDataProvider');\r\n  return ctx;\r\n};\r\n\r\n"],"mappings":";;;AAAA,SAASA,aAAa,EAAEC,WAAW,EAAEC,UAAU,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AAC5F,SACEC,QAAQ,EACRC,gBAAgB,EAChBC,YAAY,EACZC,YAAY,QACP,iBAAiB;AACxB,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,cAAc,gBAAGb,aAAa,CAAC,IAAI,CAAC;AAE1C,OAAO,MAAMc,eAAe,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC/C,MAAM;IAAEC,KAAK;IAAEC;EAAK,CAAC,GAAGR,OAAO,CAAC,CAAC;EACjC,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGf,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACgB,WAAW,EAAEC,cAAc,CAAC,GAAGjB,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;EACxD,MAAM,CAACkB,SAAS,EAAEC,YAAY,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACoB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACsB,aAAa,EAAEC,gBAAgB,CAAC,GAAGvB,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACwB,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGzB,QAAQ,CAAC,IAAI,CAAC;EAEtE,MAAM0B,YAAY,GAAG9B,WAAW,CAAC,YAAY;IAC3CqB,cAAc,CAAC,SAAS,CAAC;IACzB,IAAI;MACF,MAAMU,IAAI,GAAG,MAAM1B,QAAQ,CAAC2B,IAAI,CAAC,CAAC;MAClCb,QAAQ,CAACY,IAAI,CAAC;MACdV,cAAc,CAAC,OAAO,CAAC;MACvB,OAAOU,IAAI;IACb,CAAC,CAAC,OAAOE,GAAG,EAAE;MACZZ,cAAc,CAAC,OAAO,CAAC;MACvB,MAAMY,GAAG;IACX;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,gBAAgB,GAAGlC,WAAW,CAAC,YAAY;IAC/C,IAAI,CAACgB,KAAK,EAAE;MACVO,YAAY,CAAC,EAAE,CAAC;MAChB,OAAO,EAAE;IACX;IACA,MAAMQ,IAAI,GAAG,MAAMvB,YAAY,CAACwB,IAAI,CAAChB,KAAK,CAAC;IAC3CO,YAAY,CAACQ,IAAI,CAACI,GAAG,CAAEC,CAAC,IAAKA,CAAC,CAACC,EAAE,CAAC,CAAC;IACnC,OAAON,IAAI;EACb,CAAC,EAAE,CAACf,KAAK,CAAC,CAAC;EAEX,MAAMsB,gBAAgB,GAAGtC,WAAW,CAAC,YAAY;IAC/C,IAAI,CAACgB,KAAK,EAAE;MACVS,YAAY,CAAC,EAAE,CAAC;MAChB,OAAO,EAAE;IACX;IACA,MAAMM,IAAI,GAAG,MAAMxB,YAAY,CAACyB,IAAI,CAAChB,KAAK,CAAC;IAC3CS,YAAY,CAACM,IAAI,CAAC;IAClB,OAAOA,IAAI;EACb,CAAC,EAAE,CAACf,KAAK,CAAC,CAAC;EAEX,MAAMuB,oBAAoB,GAAGvC,WAAW,CAAC,YAAY;IACnD,IAAI,CAACgB,KAAK,EAAE;MACVW,gBAAgB,CAAC,EAAE,CAAC;MACpB,OAAO,EAAE;IACX;IACA,MAAMI,IAAI,GAAG,MAAMzB,gBAAgB,CAAC0B,IAAI,CAAChB,KAAK,CAAC;IAC/CW,gBAAgB,CAACI,IAAI,CAAC;IACtB,OAAOA,IAAI;EACb,CAAC,EAAE,CAACf,KAAK,CAAC,CAAC;EAEXd,SAAS,CAAC,MAAM;IACd4B,YAAY,CAAC,CAAC;EAChB,CAAC,EAAE,CAACA,YAAY,CAAC,CAAC;EAElB5B,SAAS,CAAC,MAAM;IACdgC,gBAAgB,CAAC,CAAC;IAClBI,gBAAgB,CAAC,CAAC;IAClBC,oBAAoB,CAAC,CAAC;EACxB,CAAC,EAAE,CAACvB,KAAK,EAAEkB,gBAAgB,EAAEI,gBAAgB,EAAEC,oBAAoB,CAAC,CAAC;EAErE,MAAMC,cAAc,GAAGxC,WAAW,CAChC,MAAOyC,MAAM,IAAK;IAChB,IAAI,CAACzB,KAAK,EAAE,MAAM,IAAI0B,KAAK,CAAC,mCAAmC,CAAC;IAChE,MAAMX,IAAI,GAAG,MAAMvB,YAAY,CAACmC,MAAM,CAACF,MAAM,EAAEzB,KAAK,CAAC;IACrDO,YAAY,CAACQ,IAAI,CAACT,SAAS,IAAI,EAAE,CAAC;IAClC,OAAOS,IAAI,CAACT,SAAS,IAAI,EAAE;EAC7B,CAAC,EACD,CAACN,KAAK,CACR,CAAC;EAED,MAAM4B,KAAK,GAAGzC,OAAO,CACnB,OAAO;IACLe,KAAK;IACLE,WAAW;IACXU,YAAY;IACZR,SAAS;IACTkB,cAAc;IACdhB,SAAS;IACTc,gBAAgB;IAChBZ,aAAa;IACba,oBAAoB;IACpBX,oBAAoB;IACpBC,uBAAuB;IACvBgB,OAAO,EAAGC,IAAI,IAAK7B,IAAI,IAAI,CAAA6B,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEC,OAAO,MAAK9B,IAAI,CAACoB;EACpD,CAAC,CAAC,EACF,CACEnB,KAAK,EACLE,WAAW,EACXU,YAAY,EACZR,SAAS,EACTkB,cAAc,EACdhB,SAAS,EACTc,gBAAgB,EAChBZ,aAAa,EACba,oBAAoB,EACpBX,oBAAoB,EACpBX,IAAI,CAER,CAAC;EAED,oBAAON,OAAA,CAACC,cAAc,CAACoC,QAAQ;IAACJ,KAAK,EAAEA,KAAM;IAAA9B,QAAA,EAAEA;EAAQ;IAAAmC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAA0B,CAAC;AACpF,CAAC;AAACrC,EAAA,CAvGWF,eAAe;EAAA,QACFJ,OAAO;AAAA;AAAA4C,EAAA,GADpBxC,eAAe;AAyG5B,OAAO,MAAMyC,UAAU,GAAGA,CAAA,KAAM;EAAAC,GAAA;EAC9B,MAAMC,GAAG,GAAGvD,UAAU,CAACW,cAAc,CAAC;EACtC,IAAI,CAAC4C,GAAG,EAAE,MAAM,IAAId,KAAK,CAAC,gDAAgD,CAAC;EAC3E,OAAOc,GAAG;AACZ,CAAC;AAACD,GAAA,CAJWD,UAAU;AAAA,IAAAD,EAAA;AAAAI,YAAA,CAAAJ,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}