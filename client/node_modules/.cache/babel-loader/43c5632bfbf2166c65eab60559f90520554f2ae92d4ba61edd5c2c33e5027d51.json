{"ast":null,"code":"import{useNavigate}from'react-router-dom';import{Heart}from'lucide-react';import BookGrid from'../components/books/BookGrid';import SectionHeading from'../components/common/SectionHeading';import EmptyState from'../components/common/EmptyState';import{useAppData}from'../context/AppDataContext';import{useAuth}from'../context/AuthContext';import{exchangesApi,conversationsApi}from'../services/api';import{useNotification}from'../context/NotificationContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Favorites=()=>{const{books,favorites,toggleFavorite,isOwner,refreshBooks,refreshExchanges,exchanges}=useAppData();const{token,user}=useAuth();const{notify}=useNotification();const navigate=useNavigate();const favoriteBooks=books.filter(book=>favorites.includes(book.id));if(!favorites.length){return/*#__PURE__*/_jsx(EmptyState,{title:\"No favorites yet\",description:\"Tap the heart on any book to keep it in your shortlist.\",icon:/*#__PURE__*/_jsx(Heart,{className:\"h-10 w-10\"}),action:/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/browse'),className:\"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-slate-600\",children:\"Browse books\"})});}const handleRequest=async book=>{try{await exchangesApi.create({bookId:book.id,message:\"Checking in about \".concat(book.title)},token);notify('Exchange request sent.','success');refreshBooks();refreshExchanges();}catch(err){notify(err.message||'Unable to request exchange.','error');}};const canChatOnBook=book=>{if(!user)return false;return exchanges.some(exchange=>exchange.bookId===book.id&&[exchange.ownerId,exchange.requesterId].includes(user.id)&&[exchange.ownerId,exchange.requesterId].includes(book.ownerId));};const handleChat=async book=>{if(!canChatOnBook(book)){notify('Send or accept an exchange request before chatting with the owner.','info');return;}try{const conversation=await conversationsApi.create({otherUserId:book.ownerId,bookId:book.id},token);navigate('/chat',{state:{conversationId:conversation.id}});}catch(err){notify(err.message||'Unable to open chat.','error');}};const shareFavorites=async()=>{try{const summary=favoriteBooks.map((book,idx)=>\"\".concat(idx+1,\". \").concat(book.title,\" by \").concat(book.author)).join('\\n');await navigator.clipboard.writeText(\"My BookLoop wishlist:\\n\".concat(summary||'No favorites yet.'));notify('Wishlist copied to clipboard!','success');}catch(error){notify('Unable to copy wishlist right now.','error');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(SectionHeading,{eyebrow:\"Saved list\",title:\"Books you\\u2019re tracking\",description:\"You\\u2019ll get notified when statuses change or owners reply.\",align:\"left\",actions:/*#__PURE__*/_jsx(\"button\",{onClick:shareFavorites,className:\"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-slate-600 hover:border-slate-300\",children:\"Share wishlist\"})}),/*#__PURE__*/_jsx(BookGrid,{books:favoriteBooks,favorites:favorites,onToggleFavorite:toggleFavorite,onRequestExchange:handleRequest,onChat:handleChat,isOwner:isOwner})]});};export default Favorites;","map":{"version":3,"names":["useNavigate","Heart","BookGrid","SectionHeading","EmptyState","useAppData","useAuth","exchangesApi","conversationsApi","useNotification","jsx","_jsx","jsxs","_jsxs","Favorites","books","favorites","toggleFavorite","isOwner","refreshBooks","refreshExchanges","exchanges","token","user","notify","navigate","favoriteBooks","filter","book","includes","id","length","title","description","icon","className","action","onClick","children","handleRequest","create","bookId","message","concat","err","canChatOnBook","some","exchange","ownerId","requesterId","handleChat","conversation","otherUserId","state","conversationId","shareFavorites","summary","map","idx","author","join","navigator","clipboard","writeText","error","eyebrow","align","actions","onToggleFavorite","onRequestExchange","onChat"],"sources":["C:/Users/dell/Desktop/pro/book-exchange-app/client/src/pages/Favorites.jsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\r\nimport { Heart } from 'lucide-react';\r\nimport BookGrid from '../components/books/BookGrid';\r\nimport SectionHeading from '../components/common/SectionHeading';\r\nimport EmptyState from '../components/common/EmptyState';\r\nimport { useAppData } from '../context/AppDataContext';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { exchangesApi, conversationsApi } from '../services/api';\r\nimport { useNotification } from '../context/NotificationContext';\r\n\r\nconst Favorites = () => {\r\n  const { books, favorites, toggleFavorite, isOwner, refreshBooks, refreshExchanges, exchanges } =\r\n    useAppData();\r\n  const { token, user } = useAuth();\r\n  const { notify } = useNotification();\r\n  const navigate = useNavigate();\r\n  const favoriteBooks = books.filter((book) => favorites.includes(book.id));\r\n\r\n  if (!favorites.length) {\r\n    return (\r\n      <EmptyState\r\n        title=\"No favorites yet\"\r\n        description=\"Tap the heart on any book to keep it in your shortlist.\"\r\n        icon={<Heart className=\"h-10 w-10\" />}\r\n        action={\r\n          <button\r\n            onClick={() => navigate('/browse')}\r\n            className=\"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-slate-600\"\r\n          >\r\n            Browse books\r\n          </button>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  const handleRequest = async (book) => {\r\n    try {\r\n      await exchangesApi.create(\r\n        { bookId: book.id, message: `Checking in about ${book.title}` },\r\n        token\r\n      );\r\n      notify('Exchange request sent.', 'success');\r\n      refreshBooks();\r\n      refreshExchanges();\r\n    } catch (err) {\r\n      notify(err.message || 'Unable to request exchange.', 'error');\r\n    }\r\n  };\r\n\r\n  const canChatOnBook = (book) => {\r\n    if (!user) return false;\r\n    return exchanges.some(\r\n      (exchange) =>\r\n        exchange.bookId === book.id &&\r\n        [exchange.ownerId, exchange.requesterId].includes(user.id) &&\r\n        [exchange.ownerId, exchange.requesterId].includes(book.ownerId)\r\n    );\r\n  };\r\n\r\n  const handleChat = async (book) => {\r\n    if (!canChatOnBook(book)) {\r\n      notify('Send or accept an exchange request before chatting with the owner.', 'info');\r\n      return;\r\n    }\r\n    try {\r\n      const conversation = await conversationsApi.create(\r\n        { otherUserId: book.ownerId, bookId: book.id },\r\n        token\r\n      );\r\n      navigate('/chat', { state: { conversationId: conversation.id } });\r\n    } catch (err) {\r\n      notify(err.message || 'Unable to open chat.', 'error');\r\n    }\r\n  };\r\n\r\n  const shareFavorites = async () => {\r\n    try {\r\n      const summary = favoriteBooks\r\n        .map((book, idx) => `${idx + 1}. ${book.title} by ${book.author}`)\r\n        .join('\\n');\r\n      await navigator.clipboard.writeText(\r\n        `My BookLoop wishlist:\\n${summary || 'No favorites yet.'}`\r\n      );\r\n      notify('Wishlist copied to clipboard!', 'success');\r\n    } catch (error) {\r\n      notify('Unable to copy wishlist right now.', 'error');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <SectionHeading\r\n        eyebrow=\"Saved list\"\r\n        title=\"Books you’re tracking\"\r\n        description=\"You’ll get notified when statuses change or owners reply.\"\r\n        align=\"left\"\r\n        actions={\r\n          <button\r\n            onClick={shareFavorites}\r\n            className=\"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-slate-600 hover:border-slate-300\"\r\n          >\r\n            Share wishlist\r\n          </button>\r\n        }\r\n      />\r\n      <BookGrid\r\n        books={favoriteBooks}\r\n        favorites={favorites}\r\n        onToggleFavorite={toggleFavorite}\r\n        onRequestExchange={handleRequest}\r\n        onChat={handleChat}\r\n        isOwner={isOwner}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Favorites;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}