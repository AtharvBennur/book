{"ast":null,"code":"import{useCallback,useEffect,useMemo,useRef,useState}from'react';import{useLocation}from'react-router-dom';import{io as ioClient}from'socket.io-client';import{Send,MessageSquare}from'lucide-react';import SectionHeading from'../components/common/SectionHeading';import LoadingScreen from'../components/common/LoadingScreen';import{useAuth}from'../context/AuthContext';import{useAppData}from'../context/AppDataContext';import{conversationsApi}from'../services/api';import{useNotification}from'../context/NotificationContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chat=()=>{var _selectedConversation;const{token}=useAuth();const{conversations,refreshConversations,activeConversationId,setActiveConversationId}=useAppData();const{state}=useLocation();const[messages,setMessages]=useState([]);const[input,setInput]=useState('');const[isSending,setIsSending]=useState(false);const[loadingMessages,setLoadingMessages]=useState(false);const socketRef=useRef(null);const{notify}=useNotification();useEffect(()=>{refreshConversations();},[refreshConversations]);// auto-open conversation from navigation state\nuseEffect(()=>{if(state!==null&&state!==void 0&&state.conversationId){setActiveConversationId(state.conversationId);}},[state,setActiveConversationId]);const loadMessages=useCallback(async conversationId=>{if(!conversationId||!token)return;setLoadingMessages(true);try{const data=await conversationsApi.messages(conversationId,token);setMessages(data);await conversationsApi.markRead(conversationId,token);}catch(err){notify(err.message||'Unable to load messages','error');}finally{setLoadingMessages(false);}},[token,notify]);useEffect(()=>{loadMessages(activeConversationId);},[activeConversationId,loadMessages]);useEffect(()=>{if(!token)return undefined;const socket=ioClient(window.location.origin.replace(/:\\d+$/,'')+':5000');socketRef.current=socket;socket.emit('identify',token);socket.on('conversationMessage',message=>{if(message.conversationId===activeConversationId){setMessages(prev=>[...prev,message]);}else{refreshConversations();}});return()=>{socket.disconnect();};},[token,activeConversationId,refreshConversations]);useEffect(()=>{if(!socketRef.current)return undefined;if(activeConversationId){socketRef.current.emit('joinConversation',activeConversationId);return()=>{var _socketRef$current;(_socketRef$current=socketRef.current)===null||_socketRef$current===void 0?void 0:_socketRef$current.emit('leaveConversation',activeConversationId);};}return undefined;},[activeConversationId]);const sendMessage=async()=>{if(!input.trim()||!activeConversationId)return;setIsSending(true);try{var _socketRef$current2;if((_socketRef$current2=socketRef.current)!==null&&_socketRef$current2!==void 0&&_socketRef$current2.connected){socketRef.current.emit('sendConversationMessage',{token,text:input,conversationId:activeConversationId});}else{await conversationsApi.sendMessage(activeConversationId,{text:input},token);}setInput('');}catch(err){notify(err.message||'Unable to send message','error');}finally{setIsSending(false);}};const selectedConversation=useMemo(()=>conversations.find(conversation=>conversation.id===activeConversationId),[conversations,activeConversationId]);if(!conversations.length){return/*#__PURE__*/_jsx(LoadingScreen,{label:\"Start an exchange to unlock chat.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"grid gap-6 lg:grid-cols-[0.9fr_1.1fr]\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"rounded-3xl border border-white/10 bg-white/5 p-4\",children:[/*#__PURE__*/_jsx(SectionHeading,{eyebrow:\"Inbox\",title:\"Conversations\",description:\"Every exchange has its own secure thread.\",align:\"left\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 space-y-3\",children:conversations.map(conversation=>{var _conversation$bookId,_conversation$partici,_conversation$lastMes;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveConversationId(conversation.id),className:\"w-full rounded-2xl border px-4 py-3 text-left text-sm transition \".concat(conversation.id===activeConversationId?'border-emerald-400/50 bg-emerald-500/10 text-white':'border-white/10 bg-slate-950/40 text-white/70 hover:border-white/30'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs uppercase tracking-[0.3em]\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Book #\",(_conversation$bookId=conversation.bookId)!==null&&_conversation$bookId!==void 0?_conversation$bookId:'general']}),conversation.unreadCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"rounded-full bg-emerald-500/80 px-2 py-0.5 text-[10px] font-bold text-slate-900\",children:conversation.unreadCount})]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-base font-semibold text-white\",children:(_conversation$partici=conversation.participantsInfo)===null||_conversation$partici===void 0?void 0:_conversation$partici.map(participant=>participant.name||participant.id).join(', ')}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-xs text-white/50\",children:((_conversation$lastMes=conversation.lastMessage)===null||_conversation$lastMes===void 0?void 0:_conversation$lastMes.text)||'No messages yet'})]},conversation.id);})})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"flex flex-col rounded-3xl border border-white/10 bg-white/5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-white/10 p-4\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:selectedConversation?\"Chat about \".concat((_selectedConversation=selectedConversation.bookId)!==null&&_selectedConversation!==void 0?_selectedConversation:'exchange'):'Select a conversation'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 space-y-3 overflow-y-auto px-4 py-4\",children:loadingMessages?/*#__PURE__*/_jsx(LoadingScreen,{label:\"Loading messages\\u2026\"}):messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-1 text-sm text-white/70\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs uppercase tracking-[0.3em] text-white/40\",children:[message.fromName,\" \\u2014 \",new Date(message.createdAt).toLocaleTimeString()]}),/*#__PURE__*/_jsx(\"div\",{className:\"rounded-2xl bg-slate-950/60 px-4 py-2\",children:message.text})]},message.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-white/10 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 items-center gap-3 rounded-full border border-white/10 bg-slate-950/40 px-4\",children:[/*#__PURE__*/_jsx(MessageSquare,{className:\"h-4 w-4 text-white/40\"}),/*#__PURE__*/_jsx(\"input\",{value:input,onChange:event=>setInput(event.target.value),placeholder:\"Type a message\\u2026\",className:\"flex-1 bg-transparent py-3 text-sm text-white outline-none\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,disabled:!activeConversationId||isSending,className:\"rounded-full bg-gradient-to-r from-emerald-500 to-teal-400 p-3 text-slate-900 disabled:cursor-not-allowed disabled:opacity-50\",children:/*#__PURE__*/_jsx(Send,{className:\"h-4 w-4\"})})]})})]})]})]});};export default Chat;","map":{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","useLocation","io","ioClient","Send","MessageSquare","SectionHeading","LoadingScreen","useAuth","useAppData","conversationsApi","useNotification","jsx","_jsx","jsxs","_jsxs","Chat","_selectedConversation","token","conversations","refreshConversations","activeConversationId","setActiveConversationId","state","messages","setMessages","input","setInput","isSending","setIsSending","loadingMessages","setLoadingMessages","socketRef","notify","conversationId","loadMessages","data","markRead","err","message","undefined","socket","window","location","origin","replace","current","emit","on","prev","disconnect","_socketRef$current","sendMessage","trim","_socketRef$current2","connected","text","selectedConversation","find","conversation","id","length","label","className","children","eyebrow","title","description","align","map","_conversation$bookId","_conversation$partici","_conversation$lastMes","onClick","concat","bookId","unreadCount","participantsInfo","participant","name","join","lastMessage","fromName","Date","createdAt","toLocaleTimeString","value","onChange","event","target","placeholder","disabled"],"sources":["C:/Users/dell/Desktop/pro/book-exchange-app/client/src/pages/Chat.jsx"],"sourcesContent":["import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { io as ioClient } from 'socket.io-client';\r\nimport { Send, MessageSquare } from 'lucide-react';\r\nimport SectionHeading from '../components/common/SectionHeading';\r\nimport LoadingScreen from '../components/common/LoadingScreen';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useAppData } from '../context/AppDataContext';\r\nimport { conversationsApi } from '../services/api';\r\nimport { useNotification } from '../context/NotificationContext';\r\n\r\nconst Chat = () => {\r\n  const { token } = useAuth();\r\n  const {\r\n    conversations,\r\n    refreshConversations,\r\n    activeConversationId,\r\n    setActiveConversationId,\r\n  } = useAppData();\r\n  const { state } = useLocation();\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const [isSending, setIsSending] = useState(false);\r\n  const [loadingMessages, setLoadingMessages] = useState(false);\r\n  const socketRef = useRef(null);\r\n  const { notify } = useNotification();\r\n\r\n  useEffect(() => {\r\n    refreshConversations();\r\n  }, [refreshConversations]);\r\n\r\n  // auto-open conversation from navigation state\r\n  useEffect(() => {\r\n    if (state?.conversationId) {\r\n      setActiveConversationId(state.conversationId);\r\n    }\r\n  }, [state, setActiveConversationId]);\r\n\r\n  const loadMessages = useCallback(\r\n    async (conversationId) => {\r\n      if (!conversationId || !token) return;\r\n      setLoadingMessages(true);\r\n      try {\r\n        const data = await conversationsApi.messages(conversationId, token);\r\n        setMessages(data);\r\n        await conversationsApi.markRead(conversationId, token);\r\n      } catch (err) {\r\n        notify(err.message || 'Unable to load messages', 'error');\r\n      } finally {\r\n        setLoadingMessages(false);\r\n      }\r\n    },\r\n    [token, notify]\r\n  );\r\n\r\n  useEffect(() => {\r\n    loadMessages(activeConversationId);\r\n  }, [activeConversationId, loadMessages]);\r\n\r\n  useEffect(() => {\r\n    if (!token) return undefined;\r\n    const socket = ioClient(window.location.origin.replace(/:\\d+$/, '') + ':5000');\r\n    socketRef.current = socket;\r\n    socket.emit('identify', token);\r\n    socket.on('conversationMessage', (message) => {\r\n      if (message.conversationId === activeConversationId) {\r\n        setMessages((prev) => [...prev, message]);\r\n      } else {\r\n        refreshConversations();\r\n      }\r\n    });\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [token, activeConversationId, refreshConversations]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return undefined;\r\n    if (activeConversationId) {\r\n      socketRef.current.emit('joinConversation', activeConversationId);\r\n      return () => {\r\n        socketRef.current?.emit('leaveConversation', activeConversationId);\r\n      };\r\n    }\r\n    return undefined;\r\n  }, [activeConversationId]);\r\n\r\n  const sendMessage = async () => {\r\n    if (!input.trim() || !activeConversationId) return;\r\n    setIsSending(true);\r\n    try {\r\n      if (socketRef.current?.connected) {\r\n        socketRef.current.emit('sendConversationMessage', {\r\n          token,\r\n          text: input,\r\n          conversationId: activeConversationId,\r\n        });\r\n      } else {\r\n        await conversationsApi.sendMessage(activeConversationId, { text: input }, token);\r\n      }\r\n      setInput('');\r\n    } catch (err) {\r\n      notify(err.message || 'Unable to send message', 'error');\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  const selectedConversation = useMemo(\r\n    () => conversations.find((conversation) => conversation.id === activeConversationId),\r\n    [conversations, activeConversationId]\r\n  );\r\n\r\n  if (!conversations.length) {\r\n    return <LoadingScreen label=\"Start an exchange to unlock chat.\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid gap-6 lg:grid-cols-[0.9fr_1.1fr]\">\r\n      <aside className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\r\n        <SectionHeading\r\n          eyebrow=\"Inbox\"\r\n          title=\"Conversations\"\r\n          description=\"Every exchange has its own secure thread.\"\r\n          align=\"left\"\r\n        />\r\n        <div className=\"mt-4 space-y-3\">\r\n          {conversations.map((conversation) => (\r\n            <button\r\n              key={conversation.id}\r\n              onClick={() => setActiveConversationId(conversation.id)}\r\n              className={`w-full rounded-2xl border px-4 py-3 text-left text-sm transition ${\r\n                conversation.id === activeConversationId\r\n                  ? 'border-emerald-400/50 bg-emerald-500/10 text-white'\r\n                  : 'border-white/10 bg-slate-950/40 text-white/70 hover:border-white/30'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center justify-between text-xs uppercase tracking-[0.3em]\">\r\n                <span>Book #{conversation.bookId ?? 'general'}</span>\r\n                {conversation.unreadCount > 0 && (\r\n                  <span className=\"rounded-full bg-emerald-500/80 px-2 py-0.5 text-[10px] font-bold text-slate-900\">\r\n                    {conversation.unreadCount}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <p className=\"mt-2 text-base font-semibold text-white\">\r\n                {conversation.participantsInfo\r\n                  ?.map((participant) => participant.name || participant.id)\r\n                  .join(', ')}\r\n              </p>\r\n              <p className=\"mt-1 text-xs text-white/50\">\r\n                {conversation.lastMessage?.text || 'No messages yet'}\r\n              </p>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </aside>\r\n      <section className=\"flex flex-col rounded-3xl border border-white/10 bg-white/5\">\r\n        <div className=\"border-b border-white/10 p-4\">\r\n          <h3 className=\"text-lg font-semibold text-white\">\r\n            {selectedConversation\r\n              ? `Chat about ${selectedConversation.bookId ?? 'exchange'}`\r\n              : 'Select a conversation'}\r\n          </h3>\r\n        </div>\r\n        <div className=\"flex flex-1 flex-col\">\r\n          <div className=\"flex-1 space-y-3 overflow-y-auto px-4 py-4\">\r\n            {loadingMessages ? (\r\n              <LoadingScreen label=\"Loading messages…\" />\r\n            ) : (\r\n              messages.map((message) => (\r\n                <div key={message.id} className=\"flex flex-col gap-1 text-sm text-white/70\">\r\n                  <div className=\"text-xs uppercase tracking-[0.3em] text-white/40\">\r\n                    {message.fromName} — {new Date(message.createdAt).toLocaleTimeString()}\r\n                  </div>\r\n                  <div className=\"rounded-2xl bg-slate-950/60 px-4 py-2\">{message.text}</div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n          <div className=\"border-t border-white/10 p-4\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"flex flex-1 items-center gap-3 rounded-full border border-white/10 bg-slate-950/40 px-4\">\r\n                <MessageSquare className=\"h-4 w-4 text-white/40\" />\r\n                <input\r\n                  value={input}\r\n                  onChange={(event) => setInput(event.target.value)}\r\n                  placeholder=\"Type a message…\"\r\n                  className=\"flex-1 bg-transparent py-3 text-sm text-white outline-none\"\r\n                />\r\n              </div>\r\n              <button\r\n                onClick={sendMessage}\r\n                disabled={!activeConversationId || isSending}\r\n                className=\"rounded-full bg-gradient-to-r from-emerald-500 to-teal-400 p-3 text-slate-900 disabled:cursor-not-allowed disabled:opacity-50\"\r\n              >\r\n                <Send className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}