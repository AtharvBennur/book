{"ast":null,"code":"import{useMemo}from'react';import{ArrowRightLeft,CheckCircle2,Clock,XCircle}from'lucide-react';import SectionHeading from'../components/common/SectionHeading';import EmptyState from'../components/common/EmptyState';import{useAppData}from'../context/AppDataContext';import{useAuth}from'../context/AuthContext';import{exchangesApi}from'../services/api';import{useNotification}from'../context/NotificationContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Exchanges=()=>{const{exchanges,refreshExchanges}=useAppData();const{token,user}=useAuth();const{notify}=useNotification();const pending=useMemo(()=>exchanges.filter(item=>item.status==='requested'),[exchanges]);const handleAction=async(exchangeId,action)=>{try{if(action==='accept'){await exchangesApi.accept(exchangeId,token);notify('Exchange accepted.','success');}else{await exchangesApi.decline(exchangeId,token);notify('Exchange declined.','info');}refreshExchanges();}catch(err){notify(err.message||'Unable to update exchange.','error');}};if(!exchanges.length){return/*#__PURE__*/_jsx(EmptyState,{title:\"No exchange activity yet\",description:\"Request a book or wait for an interested reader to reach out.\",icon:/*#__PURE__*/_jsx(ArrowRightLeft,{className:\"h-10 w-10\"})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(SectionHeading,{eyebrow:\"Workflow\",title:\"All exchange activity\",description:\"Track who requested what, approve in one tap, and keep history for future reference.\",align:\"left\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 text-sm text-white/60\",children:[pending.length,\" pending approval \\u2022 \",exchanges.length-pending.length,\" completed\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:exchanges.map(exchange=>{const isOwner=exchange.ownerId===(user===null||user===void 0?void 0:user.id);return/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-3xl border border-white/10 bg-white/5 p-5 shadow-lg shadow-black/20\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs uppercase tracking-[0.3em] text-white/40\",children:[\"Book #\",exchange.bookId]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg font-semibold text-white\",children:[exchange.requesterId.slice(0,6),\" \\u21C4 \",exchange.ownerId.slice(0,6)]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-white/60\",children:exchange.message||'No message'})]}),/*#__PURE__*/_jsx(StatusPill,{status:exchange.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex flex-wrap items-center gap-3 text-xs text-white/50\",children:[/*#__PURE__*/_jsx(Clock,{className:\"h-4 w-4\"}),new Date(exchange.createdAt).toLocaleString()]}),isOwner&&exchange.status==='requested'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex flex-wrap gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAction(exchange.id,'accept'),className:\"rounded-full bg-emerald-500/90 px-4 py-2 text-sm font-semibold text-slate-900\",children:\"Accept\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAction(exchange.id,'decline'),className:\"rounded-full border border-white/20 px-4 py-2 text-sm font-semibold text-white/80\",children:\"Decline\"})]})]},exchange.id);})})]});};const StatusPill=_ref=>{let{status}=_ref;const icons={requested:/*#__PURE__*/_jsx(Clock,{className:\"h-4 w-4\"}),accepted:/*#__PURE__*/_jsx(CheckCircle2,{className:\"h-4 w-4\"}),declined:/*#__PURE__*/_jsx(XCircle,{className:\"h-4 w-4\"})};const colors={requested:'bg-amber-500/20 text-amber-200',accepted:'bg-emerald-500/20 text-emerald-200',declined:'bg-rose-500/20 text-rose-200'};return/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] \".concat(colors[status]),children:[icons[status],status]});};export default Exchanges;","map":{"version":3,"names":["useMemo","ArrowRightLeft","CheckCircle2","Clock","XCircle","SectionHeading","EmptyState","useAppData","useAuth","exchangesApi","useNotification","jsx","_jsx","jsxs","_jsxs","Exchanges","exchanges","refreshExchanges","token","user","notify","pending","filter","item","status","handleAction","exchangeId","action","accept","decline","err","message","length","title","description","icon","className","children","eyebrow","align","map","exchange","isOwner","ownerId","id","bookId","requesterId","slice","StatusPill","Date","createdAt","toLocaleString","onClick","_ref","icons","requested","accepted","declined","colors","concat"],"sources":["C:/Users/dell/Desktop/pro/book-exchange-app/client/src/pages/Exchanges.jsx"],"sourcesContent":["import { useMemo } from 'react';\r\nimport { ArrowRightLeft, CheckCircle2, Clock, XCircle } from 'lucide-react';\r\nimport SectionHeading from '../components/common/SectionHeading';\r\nimport EmptyState from '../components/common/EmptyState';\r\nimport { useAppData } from '../context/AppDataContext';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { exchangesApi } from '../services/api';\r\nimport { useNotification } from '../context/NotificationContext';\r\n\r\nconst Exchanges = () => {\r\n  const { exchanges, refreshExchanges } = useAppData();\r\n  const { token, user } = useAuth();\r\n  const { notify } = useNotification();\r\n\r\n  const pending = useMemo(() => exchanges.filter((item) => item.status === 'requested'), [exchanges]);\r\n\r\n  const handleAction = async (exchangeId, action) => {\r\n    try {\r\n      if (action === 'accept') {\r\n        await exchangesApi.accept(exchangeId, token);\r\n        notify('Exchange accepted.', 'success');\r\n      } else {\r\n        await exchangesApi.decline(exchangeId, token);\r\n        notify('Exchange declined.', 'info');\r\n      }\r\n      refreshExchanges();\r\n    } catch (err) {\r\n      notify(err.message || 'Unable to update exchange.', 'error');\r\n    }\r\n  };\r\n\r\n  if (!exchanges.length) {\r\n    return (\r\n      <EmptyState\r\n          title=\"No exchange activity yet\"\r\n          description=\"Request a book or wait for an interested reader to reach out.\"\r\n          icon={<ArrowRightLeft className=\"h-10 w-10\" />}\r\n        />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <SectionHeading\r\n        eyebrow=\"Workflow\"\r\n        title=\"All exchange activity\"\r\n        description=\"Track who requested what, approve in one tap, and keep history for future reference.\"\r\n        align=\"left\"\r\n      />\r\n      <div className=\"mb-4 text-sm text-white/60\">\r\n        {pending.length} pending approval • {exchanges.length - pending.length} completed\r\n      </div>\r\n      <div className=\"space-y-4\">\r\n        {exchanges.map((exchange) => {\r\n          const isOwner = exchange.ownerId === user?.id;\r\n          return (\r\n            <div\r\n              key={exchange.id}\r\n              className=\"rounded-3xl border border-white/10 bg-white/5 p-5 shadow-lg shadow-black/20\"\r\n            >\r\n              <div className=\"flex flex-wrap items-center justify-between gap-4\">\r\n                <div>\r\n                  <p className=\"text-xs uppercase tracking-[0.3em] text-white/40\">\r\n                    Book #{exchange.bookId}\r\n                  </p>\r\n                  <p className=\"text-lg font-semibold text-white\">\r\n                    {exchange.requesterId.slice(0, 6)} ⇄ {exchange.ownerId.slice(0, 6)}\r\n                  </p>\r\n                  <p className=\"text-sm text-white/60\">{exchange.message || 'No message'}</p>\r\n                </div>\r\n                <StatusPill status={exchange.status} />\r\n              </div>\r\n              <div className=\"mt-4 flex flex-wrap items-center gap-3 text-xs text-white/50\">\r\n                <Clock className=\"h-4 w-4\" />\r\n                {new Date(exchange.createdAt).toLocaleString()}\r\n              </div>\r\n              {isOwner && exchange.status === 'requested' && (\r\n                <div className=\"mt-4 flex flex-wrap gap-3\">\r\n                  <button\r\n                    onClick={() => handleAction(exchange.id, 'accept')}\r\n                    className=\"rounded-full bg-emerald-500/90 px-4 py-2 text-sm font-semibold text-slate-900\"\r\n                  >\r\n                    Accept\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleAction(exchange.id, 'decline')}\r\n                    className=\"rounded-full border border-white/20 px-4 py-2 text-sm font-semibold text-white/80\"\r\n                  >\r\n                    Decline\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst StatusPill = ({ status }) => {\r\n  const icons = {\r\n    requested: <Clock className=\"h-4 w-4\" />,\r\n    accepted: <CheckCircle2 className=\"h-4 w-4\" />,\r\n    declined: <XCircle className=\"h-4 w-4\" />,\r\n  };\r\n  const colors = {\r\n    requested: 'bg-amber-500/20 text-amber-200',\r\n    accepted: 'bg-emerald-500/20 text-emerald-200',\r\n    declined: 'bg-rose-500/20 text-rose-200',\r\n  };\r\n  return (\r\n    <span\r\n      className={`inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] ${colors[status]}`}\r\n    >\r\n      {icons[status]}\r\n      {status}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default Exchanges;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}